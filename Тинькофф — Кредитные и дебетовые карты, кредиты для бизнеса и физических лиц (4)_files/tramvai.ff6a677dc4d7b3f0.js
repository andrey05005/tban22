(self.wsp=self.wsp||[]).push([["tramvai"],{19328:function(e){e.exports={crossAppNavigateLoader:"aXQBdD"}},80211:function(e,t,r){"use strict";r.d(t,{e:function(){return u},w:function(){return a}});var n=r(59999),o=r(32431),s=r(16842),i=r(67584);const a=(0,n.V3)("isDiChildContainer");class u extends o.W{constructor(e,t){super(void 0,t),this.root=e,this.register({provide:s.Z,useValue:this,scope:i.s.REQUEST}),this.register({provide:a,useValue:!0})}getRecord(e){return super.getRecord(e)||this.root.getRecord(e)}getValue(e){return this.recordValues.has(e)?this.recordValues.get(e):e.scope!==i.s.SINGLETON&&e.factory?o.L:this.root.getValue(e)}hydrateDeps(e){return e.scope===i.s.REQUEST?super.hydrateDeps(e):super.hydrateDeps.call(this.root,e)}hydrate(e,t,r){return e.scope===i.s.REQUEST?super.hydrate(e,t,r):super.hydrate.call(this.root,e,t,r)}}},32431:function(e,t,r){"use strict";r.d(t,{W:function(){return d},L:function(){return a}});var n=r(67584);const o=(e,t)=>{const r=new Error(e);return Object.assign(r,Object.assign({},t,{stack:t.stack?r.stack+"\n---- caused by: ----\n"+t.stack:r.stack}))};var s=r(16842),i=r(59999);const a="__NOT_YET__MARKER",u="__CIRCULAR__MARKER";function c(e){return e.isModernToken?e.name:Symbol.for(e.toString())}function l(e,t,r,n,o,s){return{factory:e,resolvedDeps:t,scope:r,multi:n?[]:void 0,stack:o,staticValue:s}}class d{constructor(e,t){this.records=new Map,this.recordValues=new Map,e&&e.forEach((e=>this.register(e))),this.fallback=t,this.register({provide:s.Z,useValue:this,scope:n.s.SINGLETON})}get(e){var t,r;let s,a=!1,u=!1;"string"==typeof e?s=e:"token"in e?(s=e.token,a=e.optional,u=(null===(t=s.options)||void 0===t?void 0:t.multi)||!1):s=e,s=c(s);const l=this.getRecord(s);return!l&&(null===(r=this.fallback)||void 0===r?void 0:r.getRecord(s))?this.fallback.get(e):!l&&a?u?[]:null:(function(e,t){if(void 0===e){const e=(0,i.HY)(t);throw o('Token not found "'+e+'"',{type:n.D.NOT_FOUND})}}(l,s),this.hydrate(l,s,a))}getOfDeps(e){const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=this.get(e[r]));return t}getRecord(e){return this.records.get(e)}has(e){return!!this.getRecord(c(e))}borrowToken(e,t){const r=c(t);if(!this.getRecord(r)){const t=e.getRecord(r);if(t){if(t.multi)for(const e of t.multi)this.recordValues.set(e,a);this.records.set(r,t),this.recordValues.set(t,a)}}}getValue(e){return this.recordValues.get(e)}register(e){return function(e){if("string"==typeof e.provide)return;const t=e.provide.options;if(!e.provide.isModernToken&&t&&t.multi&&!e.multi)throw o("Token "+e.provide.toString()+" require multi providers",{type:n.D.REQUIRE_MULTI,stack:e.__stack})}(e),this.processProvider(e)}processProvider(e){var t;const r=c(e.provide),s=function(e){var t;let r,o,s=null!==(t=e.provide.isModernToken&&e.provide.options.scope)&&void 0!==t?t:n.s.REQUEST,i=!1;return"useFactory"in e?(r=t=>e.useFactory(t),"deps"in e&&(o=e.deps),e.scope?s=e.scope:e.provide.isModernToken&&e.provide.options.scope&&(s=e.provide.options.scope)):"useClass"in e?(r=t=>new e.useClass(t),"deps"in e&&(o=e.deps),e.scope?s=e.scope:e.provide.isModernToken&&e.provide.options.scope&&(s=e.provide.options.scope)):(r=()=>e.useValue,i=!0,e.scope?s=e.scope:e.provide.isModernToken&&e.provide.options.scope&&(s=e.provide.options.scope)),l(r,o,s,!1,e.__stack,i)}(e),u=function(e){return"useValue"in e?e.useValue:a}(e);if(e.provide.isModernToken&&(null===(t=e.provide.options)||void 0===t?void 0:t.multi)||e.multi){let t=this.getRecord(r);if(t){if(void 0===t.multi)throw o("Mixed multi-provider for "+(0,i.HY)(r),{type:n.D.MIXED_MULTI,stack:e.__stack})}else t=l(void 0,{},e.scope||e.provide.isModernToken&&e.provide.options.scope||n.s.REQUEST,!0,e.__stack),this.records.set(r,t),this.recordValues.set(t,a);t.multi.push(s)}else this.records.set(r,s);this.recordValues.set(s,u)}hydrateDeps(e){return this.getOfDeps(e.resolvedDeps)}hydrate(e,t,r){let s=this.getValue(e);if(function(e,t,r){if(r===u){const r=(0,i.HY)(t);throw o('Circular dep for "'+r+'"',{type:n.D.CIRCULAR_DEP,stack:e.stack})}}(e,t,s),s!==a)return s;if(e.multi){this.recordValues.set(e,u);try{s=e.multi.map((e=>this.hydrate(e,t,!1)))}catch(t){throw this.recordValues.set(e,a),t}}else{this.recordValues.set(e,u);try{s=e.factory(this.hydrateDeps(e))}catch(o){if(this.recordValues.set(e,a),r&&o.type===n.D.NOT_FOUND)return null;!function(e,t){const r=(0,i.HY)(e);throw t.__extendedWithStack?t.message+=" < "+r:(t.__extendedWithStack=!0,t.message=t.message+' at "'+r+'"'),Object.hasOwnProperty.call(t,"stack")&&"string"==typeof t.stack&&(t.stack=t.stack.replace(/^.+\n/,t.name+": "+t.message+"\n")),t}(t,Object.assign(o,{stack:!e.stack||/---- caused by: ----/g.test(o.stack)?o.stack:o.stack+"\n---- caused by: ----\n"+(e.stack||"")}))}}return this.recordValues.set(e,s),s}}},67584:function(e,t,r){"use strict";r.d(t,{D:function(){return o},s:function(){return n}});const n={REQUEST:"request",SINGLETON:"singleton"},o={NOT_FOUND:"NotFound",CIRCULAR_DEP:"CircularDep",REQUIRE_MULTI:"RequireMulti",MIXED_MULTI:"MixedMulti",WRONG_FORMAT:"WrongFormat"}},40186:function(e,t,r){"use strict";r.d(t,{H:function(){return o}});var n=r(80211);function o(e,t){const r=new n.e(e);return t&&t.forEach((e=>{r.register(e)})),r}},95738:function(e,t,r){"use strict";r.d(t,{f:function(){return o}});var n=r(32431);function o(e){return new n.W(e)}},59999:function(e,t,r){"use strict";function n(e){return e.toString().replace(/^Symbol\((.+)\)$/,"$1")}r.d(t,{HY:function(){return n},V3:function(){return s},jt:function(){return i}});class o{constructor(e,t){void 0===t&&(t={}),this.isToken=!0,this.isModernToken=!0,this.name=e?Symbol.for(e):Symbol("token"),this.options=t}toString(){return n(this.name)}}function s(e,t){return new o(e,t)}function i(e){return{token:e,optional:!0}}},15617:function(e,t,r){"use strict";r.r(t),r.d(t,{ChildContainer:function(){return o.e},Container:function(){return n.W},DI_TOKEN:function(){return g.Z},INVALID_MODULE_ERROR:function(){return c.I},IS_DI_CHILD_CONTAINER_TOKEN:function(){return o.w},MODULE_PARAMETERS:function(){return u.e},Module:function(){return u.Y},Scope:function(){return h.s},createChildContainer:function(){return d.H},createContainer:function(){return s.f},createToken:function(){return p.V3},declareModule:function(){return f.J},getModuleParameters:function(){return i.s},initContainer:function(){return l},isExtendedModule:function(){return a.W},optional:function(){return p.jt},provide:function(){return v.J},walkOfModules:function(){return c.l}});var n=r(32431),o=r(80211),s=r(95738),i=r(54499),a=r(56245),u=r(80283),c=r(50561);const l=function(e){let{modules:t=[],initialProviders:r=[],providers:n=[]}=void 0===e?{}:e;const o=(0,s.f)(),l=new Set,d=e=>{e.forEach((e=>{o.register(e)}))};return d(r),(0,c.l)(t).forEach((e=>{const t=(0,i.s)(e);l.add((0,a.W)(e)?e.mainModule:e),d(t.providers)})),d(n),l.forEach((e=>{new e((e=>{const{deps:t}=e[u.e];if(t)return o.getOfDeps(t)})(e))})),o};var d=r(40186),p=r(59999),h=r(67584),g=r(16842),v=r(97570),f=r(66598)},66598:function(e,t,r){"use strict";r.d(t,{J:function(){return o}});const n="_module_parameters_";function o(e){let{name:t,providers:r=[],imports:o=[],extend:s={}}=e;class i{}const a={};for(const e in s){const t=s[e];a[e]=function(){return{mainModule:i,providers:t(...arguments)}}}return Object.assign(i,{[n]:{name:t,id:t+"-"+Math.random(),providers:r,imports:o}},a),i}},54499:function(e,t,r){"use strict";r.d(t,{s:function(){return s}});var n=r(80283),o=r(56245);const s=e=>{let t;if((0,o.W)(e)){const r=e.mainModule[n.e];t=Object.assign({},r),t.providers=t.providers.concat(e.providers||[]);const o=t.imports||[];t.imports=o.concat(e.imports||[])}else t=e[n.e];return t}},56245:function(e,t,r){"use strict";r.d(t,{W:function(){return n}});const n=e=>!!e.mainModule},80283:function(e,t,r){"use strict";r.d(t,{Y:function(){return o},e:function(){return n}});const n="_module_parameters_";function o(e){let{providers:t,imports:r,deps:o={}}=e;return e=>Object.assign(e,{[n]:{providers:t,deps:o,imports:r,name:e.name,id:e.name+"-"+Math.random()}})}},50561:function(e,t,r){"use strict";r.d(t,{I:function(){return i},l:function(){return a}});var n=r(80283);const o=e=>!1!==Boolean(e)&&(n.e in e||"mainModule"in e&&o(e.mainModule));var s=r(54499);const i="An invalid module was passed in the list of modules",a=e=>{const t=[],r=new Set,n=new Set,a=e=>{if(!o(e))throw new Error(i);const u=(0,s.s)(e);r.has(u.id)||(r.add(u.id),n.add(u.name),u.imports&&u.imports.forEach((e=>{a(e)})),t.push(e))};return e.forEach((e=>{a(e)})),t}},97570:function(e,t,r){"use strict";function n(e){return e}r.d(t,{J:function(){return n}})},16842:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});const n=(0,r(59999).V3)("di")},46478:function(e,t,r){"use strict";r.d(t,{LG:function(){return o},lV:function(){return s}});class n extends Error{constructor(e){super(e),this.isSilent=!0,this.name=n.errorName}}n.errorName="SilentError";const o=e=>!!e.isSilent,s=e=>(e.isSilent=!0,e)},19608:function(e,t,r){"use strict";r.d(t,{W:function(){return s},y:function(){return i}});var n=r(33926);const o=["message"];class s extends Error{constructor(e){let{message:t="Block Error"}=e,r=(0,n.Z)(e,o);super(t),this.name=s.errorName,Object.assign(this,r)}}s.errorName="BlockError";const i=e=>e.name===s.errorName},48945:function(e,t,r){"use strict";r.r(t),r.d(t,{BrowserReporter:function(){return v},LEVELS:function(){return c},LEVEL_NAMES:function(){return l},RemoteReporter:function(){return x},createLoggerFactory:function(){return g},default:function(){return E},formatJson:function(){return M},logger:function(){return E}});var n=r(94905),o=r.n(n),s=r(49103),i=r.n(s),a=r(5103),u=r.n(a);const c={trace:50,debug:40,info:30,warn:20,error:10,fatal:0,silent:-1/0},l={50:"trace",40:"debug",30:"info",20:"warn",10:"error",0:"fatal"},d=e=>new RegExp("^"+e.replace(/\*/g,".*?")+"$");class p{constructor(e){var t=this;if(void 0===e&&(e={name:""}),this.name=o()(e.name),this.key=e.key||this.name,p.instances[this.key])return p.instances[this.key];this.beforeReporters=e.beforeReporters||[],this.reporters=e.reporters||[],this.filters=e.filters||[],this.extensions=e.extensions||[],this.defaults=e.defaults||{},e.level&&this.setLevel(c[e.level]),e.enabled&&this.setLevel(c.trace),this.checkEnabled(),p.instances[this.key]=this,i()(((e,r)=>{this[r]=function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return t.log(e,n)}}),c)}static save(){var e;null===(e=p.onChange)||void 0===e||e.call(p,{level:p.level,enabledName:this.enabledName,enabledLevel:this.enabledLevel})}static load(e){p.level=e.level,p.enabledName=e.enabledName,p.enabledLevel=e.enabledLevel}static setLevel(e){var t;p.level=null!==(t=c[e])&&void 0!==t?t:p.level,p.save()}static setOnChange(e){p.onChange=e}static enable(e,t){const[r,n]=t?[c[e],t]:[c.trace,e];p.enabledName.push(n),p.enabledLevel.push(r),p.save();const o=d(n);i()((e=>{const{name:t}=e;o.test(t)&&e.setLevel(r)}),p.instances)}static disable(e,t){const[r,n]=t?[c[e],t]:[c.silent,e],o=p.enabledName.indexOf(n);o>-1?(p.enabledName.splice(o,1),p.enabledLevel.splice(o,1)):(p.enabledName.push(n),p.enabledLevel.push(r)),p.save();const s=d(n);i()((e=>{const{name:t}=e;s.test(t)&&e.setLevel(r)}),p.instances)}static clear(){p.level=c.silent,p.enabledName=[],p.enabledLevel=[],p.save(),i()((e=>{e.setLevel(void 0)}),p.instances)}static setGlobalReporters(e){const t=u()(e);i()((e=>{e.reporters=t}),p.instances)}child(e){const t="string"==typeof e?{name:e}:e,r=t.key||t.name,n=this.name?this.name+"."+t.name:t.name,o=this.key?this.key+"."+r:r;return new p(Object.assign({beforeReporters:this.beforeReporters,reporters:this.reporters,filters:this.filters,extensions:this.extensions,defaults:this.defaults},t,{name:n,key:o}))}addBeforeReporter(e){this.reporters=this.reporters.concat(e)}setBeforeReporters(e){this.reporters=u()(e)}addReporter(e){this.reporters=this.reporters.concat(e)}setReporters(e){this.reporters=u()(e)}addFilter(e){this.filters=this.filters.concat(e)}setFilters(e){this.filters=u()(e)}addExtension(e){this.extensions=this.extensions.concat(e)}setExtensions(e){this.extensions=u()(e)}setLevel(e){this.level=e}checkEnabled(){for(let e=p.enabledName.length-1;e>=0;e--){const t=p.enabledName[e];if(d(t).test(this.name))return void this.setLevel(p.enabledLevel[e])}}createLogObj(e,t){return Object.assign({date:new Date},this.defaults,{name:this.name,type:l[e],level:e,args:t})}log(e,t){var r;let n;n||(n=this.createLogObj(e,t));for(const e of this.filters)if(!1===e.filter(n))return!1;for(const e of this.extensions)n=e.extend(n);const o=e>(null!==(r=this.level)&&void 0!==r?r:p.level);for(const e of this.reporters)o?e.emitLevels&&e.log(n):e.log(n);return!0}}p.level=c.silent,p.instances={},p.enabledName=[],p.enabledLevel=[];const h=["addBeforeReporter","setBeforeReporters","addReporter","setReporters","addFilter","setFilters","addExtension","setExtensions",...Object.keys(c)],g=e=>{const t=new p(e);return Object.assign((e=>t.child(e)),h.reduce(((e,r)=>(t[r]&&(e[r]=t[r].bind(t)),e)),{}),{setLevel:p.setLevel,setGlobalReporters:p.setGlobalReporters,enable:p.enable,disable:p.disable,clear:p.clear})};class v{constructor(){this.defaultColor="#7f8c8d",this.levelColorMap={0:"#c00046",10:"#c0392b",20:"#f39c12",30:"#00BCD4"}}log(e){const t=e.level<20?console.error:20===e.level?console.warn:console.log,r="\n      background: "+(this.levelColorMap[e.level]||this.defaultColor)+";\n      border-radius: 0.5em;\n      color: white;\n      font-weight: bold;\n      padding: 2px 0.5em;\n    ",n="%c"+[e.name,e.type].filter(Boolean).join(":");"string"==typeof e.args[0]?t.call(console,n+"%c "+e.args[0],r,"",...e.args.slice(1)):t.call(console,n,r,...e.args)}}const f="_t_logger";let m,y;c.error;try{m=window.localStorage,y=JSON.parse(m.getItem(f))}catch(e){}y||(y=(()=>{try{return(e=>{if(!e)return;const t=e.split(",");return{level:c.silent,enabledLevel:Array(t.length).fill(c.trace),enabledName:t}})(window.localStorage.getItem("debug"))}catch(e){}})()),p.setOnChange((e=>{try{m.setItem(f,JSON.stringify(e))}catch(e){}})),y&&p.load(y);const E=g({name:"",reporters:[new v]});window.logger=E;var b=r(64805),R=r.n(b),w=r(67826),S=r.n(w),_=r(4216),N=r.n(_),C=r(34770),k=r.n(C),T=r(42282),O=r.n(T),A=r(7349);const I=e=>(N()(e)&&(e=new Error(e)),Object.defineProperties(e,{message:{configurable:!0,enumerable:!0,writable:!0},stack:{configurable:!0,enumerable:!0},cause:{configurable:!0,enumerable:!0,writable:!0}}),"cause"in e&&"object"==typeof e.cause&&Object.defineProperties(e.cause,{message:{configurable:!0,enumerable:!0,writable:!0},stack:{configurable:!0,enumerable:!0}}),Object.assign({},e,{body:(0,A.K)(e.body),code:"string"==typeof e.code?e.code:(0,A.K)(e.code)})),M=e=>{let t,r,n=null;const{args:o}=e;o[0]instanceof Error?(r=I(o[0]),t=N()(o[1])?o[1]:o[0].message):k()(o[0])&&!O()(o[0])?(n=o[0],r=n.error&&I(n.error),o[0].message?t=o[0].message:N()(o[1])&&(t=o[1])):t=o[0];const s=o.slice(t===o[1]?2:1).map((e=>e instanceof Error?{error:I(e)}:e));return Object.assign({},e,{args:s.length?s:void 0},n,{error:r,message:t})};class x{constructor(e){let{requestCount:t,makeRequest:r,emitLevels:n}=e;this.reqCount=0,this.queue=[],this.requestCount=t||1,this.makeRequest=r,this.emitLevels=n||{fatal:!0}}checkQueue(){this.queue.length&&this.reqCount<this.requestCount&&this.sendRequest()}sendRequest(){const e=this.queue.shift();this.reqCount++,this.makeRequest(M(e)).catch(R()).then((()=>{this.reqCount--,this.checkQueue()}))}remote(e){this.queue.push(e),this.checkQueue()}log(e){const{type:t,remote:r}=e;null==r?this.emitLevels[t]&&this.remote(e):(!0===r||S()(["emitLevels",t],!0,r))&&this.remote(Object.assign({},e,{remote:void 0}))}}},29376:function(e,t,r){"use strict";r.d(t,{$d:function(){return p},C5:function(){return R},Me:function(){return f},QO:function(){return b},TF:function(){return E},kV:function(){return m},lw:function(){return N},mm:function(){return S},o2:function(){return w},t1:function(){return v}});var n=r(63472),o=r.n(n),s=r(38507),i=r.n(s),a=r(8958),u=r.n(a),c=r(67826),l=r.n(c),d=r(31565);const p="CORE",h=["ANONYMOUS","AUTHENTICATED","APPLICANT","CANDIDATE","REGISTERED","CLIENT","EMPLOYEE"],g={0:"ANONYMOUS",5:"AUTHENTICATED",20:"APPLICANT",30:"CANDIDATE",35:"REGISTERED",40:"CLIENT",50:"EMPLOYEE"},v=(0,d.cG)(p,h),f=()=>Object.assign({},(0,d.n5)(v),{[v.ANONYMOUS]:!0}),m=(e,t)=>{if(t===v.ANONYMOUS)return(0,d.ac)(e,p,f());let r=!0;const n=h.reduce(((e,n)=>(e[n]=r,n===t&&(r=!1),e)),{});return(0,d.ac)(e,p,n)},y=i()(p,{}),E=u()([p,v.AUTHENTICATED],o()),b=l()([p,v.REGISTERED],!0),R=l()([p,v.CLIENT],!0),w=e=>{const t=y(e);return!!t[v.REGISTERED]&&!t[v.CLIENT]},S=function(e){return void 0===e&&(e=0),m({[p]:{}},g[e])},_=h.length;function N(e,t){const r=y(e),n=y(t);if(r===n)return!1;for(let e=_-1;e>=0;e--){const t=h[e];if(!r[t]&&n[t])return!0}return!1}},58626:function(e,t,r){"use strict";r.d(t,{HS:function(){return g},MU:function(){return d},ZE:function(){return h}});var n=r(96105),o=r.n(n),s=r(6073),i=r.n(s),a=r(38507),u=r.n(a),c=r(31565),l=r(29376);const d="DYNAMIC",p=u()(d,{}),h=(e,t)=>{const r=(0,c.ac)(e,l.$d,(0,c.n5)(l.t1)),n={[l.t1.CLIENT+"_"+t]:!0},o=p(e);return i()(((e,t)=>e===o[t]),n)?r:Object.assign({},r,{[d]:n})},g=e=>o()(Boolean,p(e))},31565:function(e,t,r){"use strict";r.d(t,{Mr:function(){return h},ac:function(){return d},cG:function(){return l},n5:function(){return g}});var n=r(65165),o=r.n(n),s=r(6073),i=r.n(s),a=r(38507),u=r.n(a),c=r(57801);const l=(e,t)=>t.reduce(((e,t)=>(e[t]=t,e)),Object.create(null)),d=(e,t,r)=>{var n;const o=null!==(n=u()(t,{},e))&&void 0!==n?n:{};return i()(((e,t)=>e===o[t]),r)?e:Object.assign({},e,{[t]:Object.assign({},o,r)})},p=r.n(c)()(o()),h=(e,t)=>{var r;const n=null!==(r=u()(t,{},e))&&void 0!==r?r:{};return i()((e=>!1===e),n)?e:Object.assign({},e,{[t]:p(n)})},g=e=>p(e)},70872:function(e,t,r){"use strict";r.d(t,{Xn:function(){return s},_q:function(){return o},qs:function(){return i}});var n=r(44121);const o=(0,n.createContext)(null),s=(0,n.createContext)(null),i=(0,n.createContext)(null)},54143:function(e,t,r){"use strict";r.d(t,{y:function(){return s}});var n=r(44121),o=r(70872);const s=()=>(0,n.useContext)(o.Xn)},71541:function(e,t,r){"use strict";r.d(t,{t:function(){return s}});var n=r(44121),o=r(70872);const s=()=>(0,n.useContext)(o._q)},81935:function(e,t,r){"use strict";r.d(t,{w:function(){return s}});var n=r(44121),o=r(70872);const s=()=>(0,n.useContext)(o.qs)},26845:function(e,t,r){"use strict";r.d(t,{Rc:function(){return a},aS:function(){return o},q$:function(){return n},xA:function(){return i},xQ:function(){return s}});const n=":",o=/\*/,s=/<history-fallback>/,i=/:.+$/,a=/([^(?]+)(?:\((.+)\))?(\?)?/},5203:function(e,t,r){"use strict";r.d(t,{Qc:function(){return d},am:function(){return a},gY:function(){return p}});var n=r(37093),o=r.n(n),s=r(26845),i=r(12836);const a=e=>e.split("/").slice(e.startsWith("/")?1:0,e.endsWith("/")?-1:1/0),u=e=>s.xQ.test(e),c=e=>s.aS.test(e),l=e=>!!e.match(s.xA),d=e=>u(e)?{type:1}:c(e)?{type:2}:l(e)?(e=>{const[t="",r,n=""]=e.split(s.q$),o=s.Rc.exec(r);if(!o)throw new Error('parameters should satisfy pattern "prefix:paramName(regexp)\\?:postfix"');const[,i,a,u]=o;return{type:3,paramName:i,regexp:t||n||a?new RegExp("^"+t+"("+(a||".+")+")"+(u?"?":"")+n+"$"):void 0,optional:!!u&&!t&&!n}})(e):{type:0,value:e},p=(e,t)=>{const r=a(e),n=o()((r=>{var n;if(u(r)||c(r))throw new Error("Pathname should be only a string with dynamic parameters, not a special string, got "+e);if(l(r)){const[e="",o="",i=""]=r.split(s.q$),a=s.Rc.exec(o);if(!a)throw new Error('parameters should satisfy pattern "prefix:paramName(regexp)\\?:postfix"');const[,u,c,l]=a,d=null===(n=t[u])||void 0===n?void 0:n.toString();if(l&&!d)return"";if(!d)throw new Error("value for parameter for "+u+" should be defined in params");if(c&&!new RegExp(c).test(d))throw new Error("passed parameter for "+u+" should satisfy regxep: "+c+", got: "+d);return e+d+i||r}return r}),r).join("/");return(0,i.RZ)("/"+n,e.endsWith("/"))}},12836:function(e,t,r){"use strict";r.d(t,{EE:function(){return s},RZ:function(){return n},hx:function(){return a},ub:function(){return i},ym:function(){return o}});const n=function(e,t){void 0===t&&(t=!1);const r=e.endsWith("/");return t?r||(e=>/\/.+\.[^/]+$/.test(e))(e)?e:e+"/":e.length>1&&r?e.slice(0,-1):e},o=e=>{const[t,...r]=e.split("?");return[t.replace(/\/+/g,"/").replace(/^(\w+):\//,"$1://"),...r].join("?")},s=e=>!e.host||e.host===window.location.host,i=e=>"string"==typeof e?{url:e}:e,a=(e,t)=>(e.add(t),()=>{e.delete(t)})},78047:function(e,t,r){"use strict";r.d(t,{DB:function(){return v},DI:function(){return y},F_:function(){return p},Hz:function(){return g},Qc:function(){return h},WU:function(){return b},co:function(){return E},n2:function(){return d}});var n=r(14033),o=r.n(n),s=r(49103),i=r.n(s),a=r(15434),u=r.n(a);const c=o()(/^(?:[a-z]+:)?\/\//i),l=e=>e.pathname+e.search+e.hash,d=e=>{const t=Object.create(null);e.searchParams.forEach(((e,r)=>{Object.prototype.hasOwnProperty.call(t,r)?Array.isArray(t[r])?t[r].push(e):t[r]=[t[r],e]:t[r]=e}));const r=e.toString(),n=l(e),o={href:n,origin:e.origin,protocol:e.protocol,username:e.username,password:e.password,port:e.port,pathname:e.pathname,path:n,search:e.search,hash:e.hash,query:t};return"localhost"!==e.host&&Object.assign(o,{href:e.href,host:e.host,hostname:e.hostname}),Object.defineProperty(o,"toString",{value:()=>r,enumerable:!1}),o},p=function(e,t){return void 0===t&&(t=window.location.href),new URL((e=>{if(e.length<2)return!1;for(let t=0;t<e.length;t++)switch(e[t]){case"?":return!0;case"/":break;default:return!1}return!0})(e)?e.replace(/^\/+/,"/"):e,t)},h=e=>d(p(e)),g=(e,t)=>{const r=p(e.toString());return p(t,r)},v=(e,t)=>{const r=p(e),n=p(t,r);return c(e)?n.href:l(n)},f=/^(\/[^?\s]*)(\?[^\s]*)?(#[^s]*)?$/,m=(e,t)=>{i()(((t,r)=>{Array.isArray(t)?(e.delete(r),u()((t=>e.append(r,t)),t)):void 0===t?e.delete(r):e.set(r,t)}),t)},y=(e,t)=>{const r=p(e.toString());return m(r.searchParams,t),d(r)},E=(e,t)=>{const{path:r,query:n,port:o,username:s,password:i}=t,a={hash:t.hash,host:t.host,hostname:t.hostname,pathname:t.pathname,protocol:t.protocol,search:t.search};if(r){const t=(e=>{const t=f.exec(e);if(t){const[e,r,n="",o=""]=t;return{pathname:r,search:n,hash:o}}})(r);t&&Object.assign(e,t)}s&&(e.username=s),i&&(e.password=i);for(const t in a){const r=a[t];void 0!==r&&(e[t]=r)}if(void 0!==o&&(e.port=o,"0"===e.port&&(e.port="http:"===e.protocol?"80":"443")),n){const r=new URLSearchParams(t.search);m(r,n),e.search=r.toString()}return e},b=e=>{const t=p("");return d(E(t,e)).href}},95967:function(e,t,r){"use strict";r.d(t,{H:function(){return E}});var n=r(33926),o=r(38507),s=r.n(o),i=r(63119),a=r.n(i),u=r(94905),c=r.n(u),l=r(56640);const d=function(e){return void 0===e&&(e=""),e.toLowerCase()},p=function(e){return void 0===e&&(e="-1.-1.-1"),e.split(".").map(Number)},h=e=>{try{const t=d(e.browser.name),[r,n,o]=p(e.browser.version),s=d(e.os.name),[i,a]=p(e.os.version),u=d(e.engine.name),[c]=p(e.engine.version);if("ios"===s)return 12!==i;if("safari"===t||"webkit"===t)return!("mac os"===s&&10===i&&14===a);if("ucbrowser"===t){const[e,t,s]=[12,13,2];return r!==e?r>e:n!==t?n>t:o>=s}return"chrome"===t||"chromium"===t?r<51||r>66:"blink"!==u&&"chromium"!==u||c<51||c>66}catch(e){return!0}},g=e=>{switch(e){case"Windows Phone":return"winphone";case"Android":return"android";case"iOS":return"ios";case"BlackBerry":case"RIM Tablet OS":return"blackberry"}},v=(e,t)=>{switch(!0){case"firefox"===e:return"firefox";case"safari"===e||"mobile safari"===e||"webkit"===t:return"safari";case"blink"===t||"chromium"===t:return"chrome"}return"other"},f=["ua"],m=a()(c(),s()("name","")),y=[[/developers\.google\.com\/\+\/web\/snippet/i],[l.UAParser.BROWSER.NAME,l.UAParser.BROWSER.VERSION,["type","bot"]],[/((?:\S+)bot(?:-[imagevdo]{5})?)\/([\w.]+)/i],[l.UAParser.BROWSER.NAME,l.UAParser.BROWSER.VERSION,["type","bot"]],[/[\s;(](adsbot[-\w]*?[\s;)])/i],[l.UAParser.BROWSER.NAME,[l.UAParser.BROWSER.VERSION,"unknown"],["type","bot"]],[/fxios\/([\w\\.-]+)/i],[[l.UAParser.BROWSER.NAME,"Firefox Focus"],l.UAParser.BROWSER.VERSION]],E=e=>{const t=new l.UAParser(e,{browser:y}).getResult(),r=(0,n.Z)(t,f),{browser:o,os:s,engine:i}=r,a=m(o),u=m(i);return"opera mobi"===a&&(r.device.type="mobile"),Object.assign({},r,{mobileOS:g(s.name),sameSiteNoneCompatible:h(r),browser:Object.assign({},o,{browserEngine:v(a,u),name:a})})}},69543:function(e,t,r){"use strict";r.d(t,{X:function(){return y}});var n=r(80476),o=r(67826),s=r.n(o),i=r(63119),a=r.n(i),u=r(80283),c=r(97570),l=r(82571),d=r(10776),p=r(92946),h=r(95926),g=r(26335),v=r(41537),f=r(90191),m=r(83092);let y=class{};y=(0,n.__decorate)([(0,u.Y)({imports:[h.yi],providers:[(0,c.J)({provide:m.h,useFactory:e=>{let{httpClientFactory:t,envManager:r,cookieManager:n,apiOriginService:o}=e;const i=a()((0,g.J)({cookieManager:n,sessionCookieName:"psid"}),(0,v.c)(o));return t({name:"bundles-api",baseUrl:r.get("BUNDLES_API"),method:"GET",requestType:"json",query:{appName:"web",appVersion:r.get("APP_VERSION"),platform:"web"},modifyRequest:i},{isResponseValid:e=>s()(["status"],"Ok",e)})},deps:{httpClientFactory:p.iu,envManager:l.vC,cookieManager:d.T,apiOriginService:p.JS}}),(0,c.J)({provide:l.sQ,multi:!0,useValue:[{key:"BUNDLES_API",validator:f.CB}]})]})],y)},83092:function(e,t,r){"use strict";r.d(t,{h:function(){return n}});const n=(0,r(59999).V3)("BUNDLES_API_SERVICE")},36523:function(e,t,r){"use strict";r.d(t,{n:function(){return i}});var n=r(80283),o=r(97570);const s=(0,r(59999).V3)("_tramvai_error_interceptor_filter"),i=(0,n.Y)({imports:[],providers:[(0,o.J)({provide:s,useValue:e=>"Uncaught ReferenceError: processRandomSelector is not defined"===e.message||"ResizeObserver loop limit exceeded"===e.message||"ResizeObserver loop completed with undelivered notifications."===e.message})]})(class{})},31812:function(e,t,r){"use strict";r.d(t,{L:function(){return g}});var n=r(80283),o=r(97570),s=r(29772),i=r(67584),a=r(48945),u=r(90191),c=r(83062),l=r(82342),d=r(82571),p=r(3566);const h={filter(e){const{remote:t,error:r}=e;return null==t||!r||"ERR_HTTP_ERROR"!==r.code||!/NetworkError when attempting to fetch resource/.test(r.message)}},g=(0,n.Y)({imports:[],providers:[(0,o.J)({provide:l.J0,multi:!0,useFactory:e=>{const t=(e=>{let{appInfo:t,envManager:r,wuid:n}=e;const{appName:o}=t,s=r.get("APP_VERSION"),i=r.get("APP_RELEASE"),a=r.get("FRONT_LOG_SYSTEM");return{extend(e){return Object.assign({},e,{component:"tramvai-"+o+"-"+(e.name||"unknown"),wuid:n,release:i,system:a,appVersion:s,appName:o,appType:"tramvai",from:"browser",userAgent:window.navigator.userAgent,href:window.location.href})}}})(e);return e=>{e.addFilter(h),e.addExtension(t)}},deps:{appInfo:s.Qo,envManager:d.vC,wuid:{token:p.$,optional:!0}}}),(0,o.J)({provide:l.DV,useFactory:e=>{let{envManager:t}=e;const r=t.get("FRONT_LOG_API");return new a.RemoteReporter({requestCount:1/0,emitLevels:{error:!0,fatal:!0},makeRequest(e){return(0,c.g)({logApi:r,payload:e})}})},scope:i.s.SINGLETON,deps:{envManager:d.vC}}),(0,o.J)({provide:d.sQ,useValue:[{key:"FRONT_LOG_API",dehydrate:!0,validator:u.CB},{key:"FRONT_LOG_SYSTEM",dehydrate:!0,value:"client_logs"}],multi:!0})]})(class{})},55205:function(e,t,r){"use strict";r.d(t,{S:function(){return n}});const n=(0,r(66598).J)({name:"TinkoffRetryModule",providers:[]})},48510:function(e,t,r){"use strict";r.d(t,{Jc:function(){return s},v5:function(){return o}});var n=r(59999);const o=(0,n.V3)("RETRY_HOSTNAME_MAP"),s=(0,n.V3)("GET_RETRY_URL")},26215:function(e,t,r){"use strict";r.d(t,{iV:function(){return x}});var n=r(80476),o=r(29772),s=r(97570),i=r(80283),a=r(80772),u=r(16842),c=r(437),l=r(82571),d=r(82342),p=r(49076),h=r(67570),g=r(21789),v=r(86499),f=r(19434),m=r(8751),y=r(24592);const E={trace:!0,debug:!0,info:!0,warn:!0,error:!0,fatal:!0},b=(0,s.J)({provide:h.j5,useFactory:e=>{let{logger:t,analytics:r}=e;const n=t({name:"eventea-logger",defaults:{remote:!0}});let o="hasNotFetchedYet";return r&&(null==r||r.waitFor("personalizedLandingMetrics").then((()=>{const{personalizedLandingMetrics:e}=r.state;if(!e)return void n.error("Unable to resolve personalizedLandingMetrics in analytics module.");const{state:{dcoGeneralId:t=""}}=e;t&&(o=t)})).catch((e=>{n.error({event:"eventea-dco-monitoring-error",error:e})}))),function(e){let{event:t,payload:r,config:s,project:i,handlersData:a}=e;var u;const c=(null==s?void 0:s.level)||s,l=null!==(u=null==s?void 0:s.samplingRate)&&void 0!==u?u:1;var d;if("string"==typeof c&&E[c]&&c in n){if(0===(d=l)||1===d?d:Math.random()<=d){const e=a?Object.assign({},a,{statist:void 0}):a;n[c]({event:t,eventeaProject:i,payload:r,handlersData:e,dcoGeneralId:o})}}else n.error({event:"eventea-wrong-logs-config",originalEvent:t,originalLevel:c})}},deps:{logger:d.Fp,analytics:{token:y.t3,optional:!0}}});var R=r(18422),w=r(83964);const S=(0,s.J)({provide:h.q2,useFactory:e=>{let{analytics:t,logger:r}=e;const n=r({name:"eventea-logger-tracking",defaults:{remote:!0}});if(!t)return void r.warn("There is no analytics module, EVENTEA_TRACKING_HANDLER WILL NOT WORK");const o=t.callUtil("makeEventeaHandler");let s=!1;return e=>{s?(0,R.OR)(t,e):o.then((t=>{t(e)})).catch((e=>{s=!0,n.error({event:"Unable to resolve makeEventeaHandler. Fallback to twt-eventea-handler v"+w.i8,error:e})}))}},deps:{analytics:{token:y.t3,optional:!0},logger:d.Fp}}),_=(0,s.J)({provide:h.g3,useFactory:e=>{let{analytics:t,logger:r}=e;const n=r({name:"eventea-logger-twt-data",defaults:{remote:!0}});if(!t)return void r.warn("There is no analytics module, EVENTEA_TWT_DATA_HANDLER WILL NOT WORK");const o=t.callUtil("makeEventeaDataHandler");let s=!1;return e=>{s?(0,R.x4)(t,e):o.then((t=>{t(e)})).catch((e=>{s=!0,n.error({event:"Unable to resolve makeEventeaDataHandler util. Fallback to twt-eventea-data-handler v"+w.i8,error:e})}))}},deps:{analytics:{token:y.t3,optional:!0},logger:d.Fp}});var N=r(37621),C=r(42353),k=r(58426);const T=(0,C.y)("set routing map"),O=(0,k.L)("eventea",{routingMap:{}}).on(T,((e,t)=>({routingMap:t}))),A=[{provide:N.Ym,multi:!0,useValue:[O]}];var I;const M={routingMap:h.rF,errorHandlers:h.nM,projectHandlersList:{token:h.eW,multi:!0},envManager:l.vC,appInfo:o.Qo,defaultEventHandlers:{token:h.qq,multi:!0},defaultDataHandlers:{token:h.qJ,multi:!0},clientLoaderTimeout:h.lb,selectPreloadProjects:h.X9};let x=I=class{static forRoot(e){let{projects:t}=e;const r=t.map((e=>{let{project:t,fallbackForServer:r}=e;return(0,s.J)({provide:h.eW,multi:!0,useFactory(e){let{logger:n}=e;return r&&n("eventea-logger-module-forRoot").error(["You passed fallbackForServer to the client for project "+t+", this will bloat your client build.","See eventea documentation on how this can be avoided."].join("\n")),{project:t}},deps:{logger:d.Fp}})}));return{mainModule:I,providers:r}}};x=I=(0,n.__decorate)([(0,i.Y)({imports:[],providers:[...A,(0,s.J)({provide:h.X9,useFactory:e=>{let{envManager:t}=e;const r="true"===t.get("TRAMVAI_FORCE_CLIENT_SIDE_RENDERING");return function(e){return r?e:[]}},deps:{envManager:l.vC}}),{provide:h.Bv,useFactory(e){let{routingMap:t,errorHandlers:r,projectHandlersList:n,envManager:o,appInfo:s,defaultEventHandlers:i,defaultDataHandlers:a,clientLoaderTimeout:u,selectPreloadProjects:l}=e;const d=(()=>{const e=Object.create(null);return{useEvent:t=>{let{project:r,event:n}=t;e[r]||(e[r]=Object.create(null)),e[r][n]=!0},getUsedEvents:()=>Object.keys(e).map((t=>({projectName:t,eventList:Object.keys(e[t])})))}})(),p=null==o?void 0:o.get("EVENTEA_PROJECTS"),h=([...n,...(p&&p.match(/[a-zA-Z0-9\-\_]+/g)||[]).map((e=>({project:e})))]||[]).reduce(((e,r)=>(e[r.project]={eventHandlers:r.eventHandlers,dataHandlers:r.dataHandlers,routing:t[r.project]},e)),{}),g=i.reduce(((e,t)=>{let{name:r,handler:n}=t;return Object.assign({},e,{[r]:n})}),{}),v=a.reduce(((e,t)=>{let{name:r,handler:n}=t;return Object.assign({},e,{[r]:n})}),{}),y=l(Object.keys(h)),E=o.get("EVENTEA_BEER_URL")?new m.EventeaBeerClient({baseUrl:o.get("EVENTEA_BEER_URL")}):void 0,b=new f.ClientLoader({preloadProjects:y,handleRequestError:e=>{let{project:t,status:r}=e;E&&E.event({project:"eventea",event:"client-loader-error",payload:{projectName:t,status:r},handlersData:{appName:s.appName}})},baseUrl:null==o?void 0:o.get("EVENTEA_LOADER_URL"),timeout:u}),R=new c.Eventea({projectConfigurationMap:h,errorHandlers:r,beerBaseUrl:o.get("EVENTEA_BEER_URL"),handlersData:{appName:s.appName,appVersion:o.get("APP_VERSION"),appRelease:o.get("APP_RELEASE")},handleAnyEvent:e=>{d.useEvent(e)},defaultEventHandlers:g,defaultDataHandlers:v,routingClientLoader:b,batchingConfig:{batchingEnable:"true"===o.get("EVENTEA_CLIENT_BATCHING_ENABLE"),batchSize:Number(o.get("EVENTEA_CLIENT_BATCH_SIZE")),batchDelay:Number(o.get("EVENTEA_CLIENT_BATCH_DELAY"))},needBoxyBlocksProcessing:"true"===o.get("EVENTEA_CLIENT_BOXY_BLOCKS_PROCESSING_ENABLE"),fetchPriority:o.get("EVENTEA_CLIENT_FETCH_PRIORITY"),compressionEnabled:"true"===o.get("EVENTEA_IS_COMPRESSION_ENABLED")});return window.addEventListener("pagehide",(()=>{const e=d.getUsedEvents();e.length&&e.forEach((e=>{let{projectName:t,eventList:r}=e;R.sendOnce({project:"eventea",event:"usage-stats",payload:{projectName:t,eventList:r}},t)}))})),window.__eventea=R,R},deps:M},{provide:h.rF,useFactory(e){let{context:t}=e;return t.getState(O).routingMap},deps:{context:p.l}},{provide:h.nM,useFactory(e){let{logger:t}=e;const r=t("eventea-error-handlers");return{handleMissedEvent:e=>{let{event:t,project:n}=e;r.error({event:"eventea-missed-event",project:n,eventName:t})},handleMissedEventHandler:e=>{let{event:t,routeHandlerName:n,project:o}=e;r.error({event:"eventea-missed-event-handler",eventName:t,project:o,routeHandlerName:n})},handleMissedProject:e=>{let{event:t,project:n}=e;r.error({event:"eventea-missed-project",project:n,eventName:t})},handleMissedRouting:e=>{let{project:t}=e;r.error({event:"eventea-missed-routing",project:t})},handleMissedDataHandler:e=>{let{project:t,handlerName:n}=e;r.error({event:"eventea-missed-data-handler",project:t,handlerName:n})},handleMissedDataProject:e=>{let{project:t}=e;r.error({event:"eventea-missed-data-project",project:t})},handleMissedRoutes:e=>{let{project:t,event:n}=e;r.error({event:"eventea-missed-routes",project:t,eventName:n})},handleDeprecatedEvent:e=>{let{project:t,event:n}=e;r.info({event:"eventea-deprecated-event",project:t,eventName:n})},handleEventHandlerError:(e,t,n)=>{let{project:o,event:s}=n;r.error({event:"eventea-handler-error",project:o,eventName:s,handlerName:t,error:e})}}},deps:{logger:d.Fp}},S,_,b,{provide:h.lb,useValue:5e3},(0,s.J)({provide:h.eW,multi:!0,useValue:{project:"eventea"}}),(0,s.J)({provide:h.Yw,useFactory:e=>{let{statistClient:t,logger:r}=e;if(t)return(0,v.I)({statistClient:t});r.warn("There is no statist event api client, EVENTEA_STATIST_HANDLER WILL NOT WORK")},deps:{statistClient:{token:g.se,optional:!0},logger:d.Fp}}),(0,s.J)({provide:h.qq,useFactory:e=>{let{statistHandler:t}=e;return{name:"statist",handler:t}},deps:{statistHandler:h.Yw},multi:!0}),(0,s.J)({provide:h.qq,useFactory:e=>{let{logsHandler:t}=e;return{name:"logs",handler:t}},deps:{logsHandler:h.j5},multi:!0}),(0,s.J)({provide:h.qq,useFactory:e=>{let{trackingHandler:t}=e;return{name:"tracking",handler:t}},deps:{trackingHandler:h.q2},multi:!0}),(0,s.J)({provide:h.qJ,useFactory:e=>{let{twtDataHandler:t}=e;return{name:"twt",handler:t}},deps:{twtDataHandler:h.g3},multi:!0}),(0,s.J)({provide:a.Bi.init,useFactory(e){let{di:t}=e;return()=>{t.get(h.Bv)}},deps:{di:u.Z}})]})],x)},99270:function(e,t,r){"use strict";var n=r(15617);n.createToken("microfronts mappings logger"),n.createToken("after mappings loaded",{multi:!0}),n.createToken("microfronts locker mapping loader"),n.createToken("microfronts locker mapping cache");const o=n.createToken("external mappings processor");n.createToken("browserPersistingCacheToken"),n.createToken("browserPermanentCacheName"),t.I5=o},27338:function(e,t,r){"use strict";r.d(t,{r:function(){return X}});var n=r(66598),o=r(97570),s=r(147),i=r.n(s),a=r(99454),u=r.n(a),c=r(82571),l=r(48510);const d=[(0,o.J)({provide:l.v5,useFactory:e=>{let{envManager:t}=e;const r={"www.cdn-tinkoff.ru":"fallback.cdn-tinkoff.ru/www","cdn.tbank.ru":"fallback.cdn-tinkoff.ru/acdn","unic-cdn-prod.cdn-tinkoff.ru":"fallback.cdn-tinkoff.ru/unic-cdn-prod"},n=t.get("RETRY_HOSTNAME_MAP"),o=e=>e.endsWith("/")?e.slice(0,-1):e;return void 0!==n?u()(r,i()(n.split(",").map((e=>e.split("="))).map((e=>e.map(o))))):r},deps:{envManager:c.vC}}),(0,o.J)({provide:l.Jc,useFactory:e=>{let{retryMap:t}=e;return e=>function(e,t){for(const r in t)if(0===e.split("//")[1].indexOf(r))return e.replace(r,t[r]);return e}(e,t)},deps:{retryMap:l.v5}}),(0,o.J)({provide:c.sQ,multi:!0,useValue:[{key:"RETRY_HOSTNAME_MAP",optional:!0}]})],p=(0,n.J)({name:"TinkoffRetryModuleDefaults",providers:[...d]});var h=r(37621),g=r(68400),v=r(82342),f=r(10776),m=r(82912),y=r(6073),E=r.n(y),b=r(23461),R=r(43732),w=r(42353),S=r(58426);(0,w.y)("boxy ssr data set");const _=(0,w.y)("boxy external mappings"),N=(0,S.L)("microfrontsMappings",{mappings:[],overwritingMapping:null}).on(_,((e,t)=>Object.assign({},e,t)));var C=r(59999);const k=(0,C.V3)("microfronts mappings logger"),T=(0,C.V3)("after mappings loaded",{multi:!0}),O=(0,C.V3)("microfronts locker mapping loader"),A=(0,C.V3)("microfronts locker mapping cache"),I=(0,C.V3)("external mappings processor"),M=(0,C.V3)("browserPersistingCacheToken"),x=(0,C.V3)("browserPermanentCacheName"),L="cookieMapping",P="cookieMappingUrl",V=[(0,o.J)({provide:k,useFactory:e=>{let{logger:t}=e;return t("boxy")},deps:{logger:v.Fp}}),(0,o.J)({provide:R.kE,useFactory(e){let{store:t}=e;return()=>t.getState(N).mappings.map((e=>{let{mapping:t}=e;return t}))},deps:{store:h.kR}}),(0,o.J)({provide:R.N3,useFactory(e){let{cookie:t,store:r,logger:n,cookieMappingEnabled:o}=e;var s;if(!o)return{};const i=t.get(L),a=null===(s=r.getState(N).overwritingMapping)||void 0===s?void 0:s.mapping;if(i&&a&&n.warn("Both cookies "+L+" and "+P+" are set. First will be used,\n        but situation is almost certainly undesired. Please use only one at a time."),!i)return a;{const e=JSON.parse(i);if(u=e,E()(E()((e=>"npmVersion"in e||"clientJs"in e&&"serverJs"in e)))(u))return e;n.error('Cookie "'+L+'" is defined, but mapping in value is invalid')}var u},deps:{cookie:f.T,store:h.kR,logger:k,env:c.vC,cookieMappingEnabled:R.Gj}}),(0,o.J)({provide:R.Gj,useFactory(e){let{env:t}=e;const r=t.get("ENABLE_COOKIE_MAPPING");return!!r&&"false"!==r},deps:{env:c.vC}}),(0,o.J)({provide:R.xb,useFactory(e){let{env:t,urlRewrite:r}=e;const n=t.get("BOXY_BASE_URL");return r?r(n):n},deps:{env:c.vC,urlRewrite:R.JM}}),(0,o.J)({provide:R.JM,useFactory(e){let{env:t,requestManager:r}=e;const n=t.get("BOXY_REQUEST_HOSTNAME_MAP");return n?((e,t)=>{let r;e&&(r=e.split(",").reduce(((e,t)=>{const[r,n]=t.split("=");return e.set(r,n),e}),new Map));const n=new URL(t);return e=>{if(r&&e){const t=new URL(e);return t.hostname=r.get(n.hostname)||t.hostname,t.href}return e}})(n,r.getUrl()):null},deps:{env:c.vC,requestManager:m.G}}),{provide:c.sQ,useValue:[{key:"BOXY_BASE_URL",optional:!0},{key:"ENABLE_COOKIE_MAPPING",optional:!0},{key:"BOXY_REQUEST_HOSTNAME_MAP",optional:!0}],multi:!0},(0,o.J)({provide:R.Rq,useFactory:e=>{let t=Object.assign({},((0,g.Z)(e),e));return e=>new b.zN(Object.assign({},t,e))},deps:{fallbackMapping:{token:R.Af,multi:!0,optional:!0},customMapping:{token:R.go,multi:!0,optional:!0},baseMappingExtensions:{token:R.kE,multi:!0,optional:!0},boxyLazy:{token:R.iO,optional:!0},overwritingMappingExtension:{token:R.N3,optional:!0},refreshMappings:{token:R.pX,optional:!0},boxyBaseUrl:R.xb,urlRewrite:{token:R.JM,optional:!0}}})];var D=r(67584),F=r(29772),j=r(80772),U=r(66913),B=r(16011),J=r(42866),H=r(67570),q=r(16842),G=r(62054),W=r(9056),Y=r(16254),K=r(91232);function Q(e){return Boolean(e.code)}function Z(e){return e&&e.payload?"success":"error"}function z(e){if(Q(e)&&"ABORT_ERR"===e.code)return"aborted";if(Q(e)&&"ERR_HTTP_REQUEST_TIMEOUT"===e.code)return"apiTimeout";if(!e)return"empty";const{status:t}=e;return t?200===t?"200":t>=200&&t<300?"2xx":[400,401,403,404].includes(t)?""+t:t>=400&&t<500?"4xx":[500,502,503,504].includes(t)?""+t:t>=500&&t<600?"5xx":"unknown":"empty"}const $=[...[(0,o.J)({provide:Y.Yv,multi:!0,useFactory:e=>{let{di:t,env:r}=e;return async()=>{await t.get(I)({forceRefresh:!1})}},deps:{di:q.Z,env:c.vC}}),(0,o.J)({provide:R.pX,useFactory:e=>{let{externalMappingsProcessorFactory:t,freezeClientMapping:r}=e;return()=>r?Promise.resolve([]):t({forceRefresh:!0})},deps:{externalMappingsProcessorFactory:I,freezeClientMapping:R.HI}}),(0,o.J)({provide:O,useFactory:function(e){const{httpRequest:t,logger:r,mappingLoaderHook:n,mappingLoaderPlugins:o,mappingRequestTimeout:s}=e;return n.tapPromise("loadingMapping",(async(e,n,o)=>{let{url:i}=n;return t.get(i,{},{responseType:"json",timeout:s}).then((e=>e)).catch((e=>(r.warn("Failed to load mapping from "+i+". \n"+e),e)))})),null==o||o.forEach((e=>{e(n)})),async function(e){const t=await n.callPromise(e);if(t&&t.payload)return function(e,t){const{url:r,kind:n}=e,{baseUrl:o,mapping:s}=t;let i,a;return o?i=o:(i=r.split("/").slice(0,-1).join("/"),"cookie"===n&&(a=t.commitSha)),(0,K._q)(s,i,{cacheHash:a})}(e,t.payload)}},deps:{httpRequest:R.BW,logger:k,mappingLoaderHook:R.AA,mappingLoaderPlugins:{token:R.I,multi:!0,optional:!0},mappingRequestTimeout:R.w0}}),(0,o.J)({provide:R.AA,useFactory:e=>{let{hookFactory:t}=e;return t.createAsync("externalMappingLoading")},deps:{hookFactory:G.j}}),(0,o.J)({provide:I,useFactory:e=>t=>{let{forceRefresh:r}=t;return(async e=>{let{afterMappingsLoaded:t,cache:r,cookie:n,cookieMappingEnabled:o,externalMappingUrls:s,forceRefresh:i,forceRefreshThrottleTime:a,getRetryUrl:u,loadMapping:c,logger:l,store:d}=e;const p=o?n.get(P):void 0;if(!(null==s?void 0:s.length)&&!p)return[];const h=[];let g=null;const v=[];async function f(e){var t;const{url:n,kind:o}=e,s=r.get(n);var d;if(s&&(!i||(d=null===(t=s.meta)||void 0===t?void 0:t.lastForceRefreshTime)&&d+a>=Date.now()))return s.mapping;const p=await c(e);if(p)return r.set(n,p,{kind:o,forceRefresh:i}),v.push(p),p;l.warn("Failed to load mapping from "+n+".");const h=r.get(n,{allowStale:!0});if(h)return l.warn("Return cached stale version. "+n),h.mapping;const g=u(n);if(g===n)return null;const f=await c(Object.assign({},e,{url:g}));return f?(r.set(n,f,{kind:o,forceRefresh:i}),v.push(f),f):(l.warn("Fallback cdn mapping load failed: "+g+"."),null)}const m=(s||[]).map((async e=>{const t=await f({url:e,kind:"external",source:"s3"});if(t)return{url:e,mapping:t}})),y=p?[(async e=>{const t=await f({url:e,kind:"cookie",source:"s3"});t&&(g={url:e,mapping:t})})(p)]:[];return await Promise.all([Promise.all([...m]).then((e=>{e.forEach((e=>{e&&h.push(e)}))})),...y]),d.dispatch(_({mappings:h,overwritingMapping:g})),v.length&&t&&await Promise.all(t.map((e=>e({mappingsUpdated:!0})))),v})(Object.assign({},e,{forceRefresh:r}))},deps:{afterMappingsLoaded:{token:T,optional:!0},appInfo:F.Qo,cache:A,cookie:f.T,cookieMappingEnabled:R.Gj,di:q.Z,env:c.vC,externalMappingUrls:R._x,forceRefreshThrottleTime:R.UE,getRetryUrl:l.Jc,httpRequest:R.BW,loadMapping:R.Rp,logger:k,store:h.kR,urlRewrite:R.JM}}),(0,o.J)({provide:A,useClass:class{constructor(e){this.cache=e.cache}set(e,t,r){const{kind:n,forceRefresh:o}=r;"cookie"!==n&&this.cache.set(e,{mapping:t,meta:o?{lastForceRefreshTime:Date.now()}:{}})}get(e,t){if(!(null==t?void 0:t.allowStale))return this.cache.has(e)?this.cache.get(e):void 0;const r=this.cache.get(e);return r?(this.cache.set(e,r,{ttl:6e4}),r):void 0}},deps:{cache:R.o1}}),(0,o.J)({provide:R._x,useFactory(e){const t=e.env.get("BOXY_EXTERNAL_MAPPING_URL");let r=e.externalMappingUrls||[];return t&&(r=r.concat(t.split(",").map((e=>e.trim())))),e.urlRewrite?r.map(e.urlRewrite):r},deps:{externalMappingUrls:{token:R.er,optional:!0},urlRewrite:R.JM,env:c.vC}}),(0,o.J)({provide:c.sQ,useValue:[{key:"BOXY_EXTERNAL_MAPPING_URL",optional:!0},{key:"FREEZE_CLIENT_MAPPING",value:"true",dehydrate:!0},{key:"TRAMVAI_FORCE_CLIENT_SIDE_RENDERING",optional:!0}]}),(0,o.J)({provide:R.HI,useFactory:e=>{let{env:t}=e;return"true"===t.get("FREEZE_CLIENT_MAPPING")},deps:{env:c.vC}}),(0,o.J)({provide:R.UE,useValue:6e4}),(0,o.J)({provide:R.BW,useFactory:e=>{let{factory:t}=e;return t({name:"microfronts-locker",enableCircuitBreaker:!1,cacheTime:3e4,allowStale:!1})},deps:{factory:W.FB}}),(0,o.J)({provide:R.w0,useValue:2e4})],(0,o.J)({provide:R.I,multi:!0,useFactory:e=>{let{eventeaRequestLogger:t}=e;return t?e=>{e.wrap((async(e,r,n)=>{const o=Date.now(),s={url:r.url,slug:"external_mapping"};t.requestStart(s);const i=await n(r);return t.requestEnd(Object.assign({},s,{result:Z(i),statusCode:z(i),duration:Date.now()-o})),i}))}:()=>{}},deps:{eventeaRequestLogger:{token:R.gp,optional:!0}}}),(0,o.J)({provide:R.I,multi:!0,useFactory:e=>{let{eventea:t,appInfo:{appName:r}}=e;return t?e=>{e.wrap((async(e,n,o)=>{const s=Date.now();t.send({project:"boxyCore",event:"boxyCore.mappingLoadingStart",payload:{application:r,mappingType:n.kind,source:n.source}});const i=await o(n);return t.send({project:"boxyCore",event:"boxyCore.mappingLoadingEnd",payload:{application:r,mappingType:n.kind,source:n.source,result:Z(i),statusCode:z(i),duration:Date.now()-s}}),i}))}:()=>{}},deps:{eventea:{token:H.Bv,optional:!0},appInfo:F.Qo}}),(0,o.J)({provide:R.o1,scope:D.s.SINGLETON,useFactory:e=>{let{cacheFactory:t,freezeClientMapping:r}=e;return t("memory",{ttl:r?void 0:12e5,max:100,allowStale:!0})},deps:{cacheFactory:B.xC,freezeClientMapping:R.HI}}),(0,o.J)({provide:j.Bi.init,scope:D.s.SINGLETON,useFactory:e=>{let{cache:t,logger:r,store:n,permanentCache:o,permanentCacheName:s}=e;return async()=>{const e=n.getState(N);if(e.mappings.length||e.overwritingMapping)return e.mappings.forEach((e=>{let{url:r,mapping:n}=e;t.set(r,{mapping:n})})),void(e.overwritingMapping&&t.set(e.overwritingMapping.url,{mapping:e.overwritingMapping.mapping}));const i=await(await o).get(s);if(i&&1===i.version)try{return t.load(i.data.cacheDump)}catch(e){r.warn("Failed to load stored cache from permanentCache.\n"+e.message+"\n"+e.stack)}}},deps:{cache:R.o1,logger:k,store:h.kR,permanentCache:M,appInfo:F.Qo,permanentCacheName:x}}),(0,o.J)({provide:T,useFactory:e=>{let{cache:t,logger:r,permanentCache:n,permanentCacheName:o}=e;return async e=>{let{mappingsUpdated:s}=e;if(s)try{return await(await n).set(o,{version:1,data:{cacheDump:t.dump()}})}catch(e){r.error("Failed to save cache to idb.\n"+e.message+"\n"+e.stack)}return Promise.resolve()}},deps:{cache:R.o1,logger:k,permanentCache:M,permanentCacheName:x}}),(0,o.J)({provide:M,scope:D.s.SINGLETON,useFactory:async e=>{let{freezeClientMapping:t}=e;const r=function(){const e="test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}();if(t)return{get(e){return Promise.resolve(null)},set(e,t){return Promise.resolve()}};if(window.indexedDB&&(!r||!localStorage.__DEV__FORCE_LOCAL_STORAGE)){const e="tinkoff:microfronts-locker",t="keyval",r=()=>(0,U.X3)(e,1,{upgrade(e){e.createObjectStore(t)}});try{let e=r();return await e,window.addEventListener("pagehide",(async()=>{if(e){const t=await e;await t.close(),e=null}})),window.addEventListener("pageshow",(()=>{e=r()})),{get:async r=>(await e).get(t,r),set:async(r,n)=>{const o=await e;await o.put(t,n,r)}}}catch(e){}}return r?{get(e){const t=localStorage.getItem(e);return Promise.resolve(t?(0,J.N)(t):null)},set(e,t){return localStorage.setItem(e,JSON.stringify(t)),Promise.resolve()}}:{get(e){return Promise.resolve(null)},set(e,t){return Promise.resolve()}}},deps:{freezeClientMapping:R.HI}}),(0,o.J)({provide:x,scope:D.s.SINGLETON,useFactory:e=>{let{appInfo:t}=e;return t.appName+"--mappings-locker"},deps:{appInfo:F.Qo}})],X=(0,n.J)({name:"MicrofrontsLocker",imports:[p],providers:[...$,...V,(0,o.J)({provide:h.Ym,useValue:[N],multi:!0})]})},43732:function(e,t,r){"use strict";r.d(t,{AA:function(){return S},Af:function(){return o},BW:function(){return v},Gj:function(){return f},HI:function(){return d},I:function(){return _},JM:function(){return E},N3:function(){return a},Rp:function(){return w},Rq:function(){return b},UE:function(){return h},_x:function(){return c},er:function(){return u},go:function(){return s},gp:function(){return p},iO:function(){return R},kE:function(){return i},o1:function(){return g},pX:function(){return l},w0:function(){return m},xb:function(){return y}});var n=r(59999);const o=(0,n.V3)("boxyFallbackMappingExtension",{multi:!0}),s=(0,n.V3)("boxyCustomMappingExtension",{multi:!0}),i=(0,n.V3)("boxyBaseMappingExtension",{multi:!0}),a=(0,n.V3)("overwriting boxyBaseMappingExtension"),u=(0,n.V3)("boxyExternalMapping",{multi:!0}),c=(0,n.V3)("boxyPreparedExternalMappings"),l=(0,n.V3)("refreshMappingsToken"),d=(0,n.V3)("freezeClientMapping"),p=(0,n.V3)("eventeaRequestLoggerToken"),h=(0,n.V3)("forceRefreshThrottleTimeToken"),g=(0,n.V3)("external mapping cache"),v=(0,n.V3)("microfronts locker http client"),f=(0,n.V3)("enable cookie mapping"),m=(0,n.V3)("MAPPING_REQUEST_TIMEOUT_TOKEN"),y=(0,n.V3)("BOXY_BASE_URL"),E=(0,n.V3)("BOXY_URL_REWRITE"),b=(0,n.V3)("boxyServiceFactory"),R=(0,n.V3)("boxyLazy"),w=(0,n.V3)("microfronts locker mapping loader"),S=(0,n.V3)("microfronts locker mapping loading hook"),_=(0,n.V3)("microfronts locker mapping loading plugins",{multi:!0})},19133:function(e,t,r){"use strict";r.d(t,{Fb:function(){return R}});var n=r(80476),o=r(80283),s=r(97570),i=r(37621),a=r(8479),u=r(93679),c=r(42353),l=r(58426);const d=(0,c.y)("NOTIFICATIONS_CHANGED"),p=(0,l.L)("notifications",[]).on(d,((e,t)=>t));var h=r(33926);const g=["newOnTop"];var v=r(90130),f=r(44121),m=r(42549),y=r(38003);const E=(0,m.Vo)({chunkName(){return"Notifications-es"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>r.e("Notifications-es").then(r.bind(r,72189)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 72189}});var b;let R=b=class{static forRoot(e){return{mainModule:b,providers:[{provide:u.Q,multi:!0,useValue:e}]}}};R=b=(0,n.__decorate)([(0,o.Y)({providers:[(0,s.J)({provide:u.Q,multi:!0,useValue:{selector:e=>e}}),(0,s.J)({provide:i.Ym,multi:!0,useValue:p}),(0,s.J)({provide:u.e,useClass:class{constructor(e){let{store:t}=e;this.store=t}setState(e){const t=d(e);this.store.dispatch(t)}getNotifications(){return this.store.getState(p)}add(e){let{newOnTop:t=!1}=e,r=(0,h.Z)(e,g);const n=Object.assign({},r,{id:r.id||""+(new Date).getTime()});let o=this.getNotifications();return r.id&&(o=o.filter((e=>e.id!==r.id))),o=t?[n,...o]:[...o,n],this.setState(o),n.id}remove(e){let{id:t,type:r}=e,n=this.getNotifications();const o=n.length;if(t)n=n.filter((e=>e.id!==t));else if(r){const e=Array.isArray(r)?r:[r];n=n.filter((t=>-1===e.indexOf(t.type)))}n.length!==o&&this.setState(n)}clear(){this.getNotifications().length&&this.setState([])}},deps:{store:i.kR}}),(0,s.J)({provide:a.LAYOUT_OPTIONS,multi:!0,useValue:{components:{notifications:()=>{const[e,t]=(0,f.useState)(!1);return(0,f.useEffect)((()=>{t(!0)}),[]),e?(0,v.jsx)(y.E,{error:null,fallback:()=>null,children:(0,v.jsx)(E,{})}):null}}}})]})],R)},93679:function(e,t,r){"use strict";r.d(t,{Q:function(){return s},e:function(){return o}});var n=r(59999);const o=(0,n.V3)("notificationManager"),s=(0,n.V3)("notificationOptions",{multi:!0})},22441:function(e,t,r){"use strict";r.d(t,{$y:function(){return s},D0:function(){return i}});var n=r(20745),o=r(75877);const s=(0,n.H)({name:"showGentleBanner",fn(){this.dispatch((0,o.CL)())}}),i=(0,n.H)({name:"hideGentleBanner",fn(){this.dispatch((0,o.rA)())}});(0,n.H)({name:"unmountAndHideGentleBanner",fn(){this.dispatch((0,o.fV)())}})},95044:function(e,t,r){"use strict";r.d(t,{k:function(){return l}});var n=r(82318),o=r(3566),s=r(69736),i=r(82342),a=r(10055),u=r(14122);const c=(0,n.P)({name:"pushSubscribeAction",fn:async function(e,t,r){void 0===t&&(t={});const{pushWeb:n,wuid:o,logger:s,sessionManager:i,remoteLogger:a}=r,c=s(u.QG),l=i.getSessionId();if(l||a.warn({message:"sessionid value is not passed, so an anonymous registration will be created",event:"anonymous-push-web-registration"}),n)try{return n.subscribe(Object.assign({wuid:o,sessionid:l},t.data),t.force)}catch(e){c.error({message:"PushWeb subscribe failed",event:"webpush-subscribe-failed",error:e})}else c.debug("PushWeb instance token is not provided")},deps:{logger:i.Fp,wuid:o.$,pushWeb:a.ai,sessionManager:s.db,remoteLogger:a.c7}}),l=(0,n.P)({name:"pushToggleAction",fn:async(e,t,r)=>{const{pushWeb:n}=r;if(!n)return;const{action:o}=t;return"subscribe"===o?e.executeAction(c,{data:null==t?void 0:t.data,force:null==t?void 0:t.force}):n.unsubscribe()},deps:{pushWeb:a.ai}})},64870:function(e,t,r){"use strict";r.d(t,{fo:function(){return Rt}});var n=r(66598),o=r(97570),s=r(80772),i=r(29772),a=r(33464),u=r(38518),c=r(3566),l=r(65554),d=r(92105),p=r(69736),h=r(80476),g=r(64805),v=r.n(g),f=r(59999),m=r(80283),y=r(17173),E=r(49076),b=r(82342),R=r(10776),w=r(82571),S=r(92946),_=r(60488),N=r(56873),C=r(12327),k=r(8479),T=r(37621),O=r(71533),A=r(54211),I=r(33057),M=r.n(I),x=r(67744),L=r.n(x),P=r(63119),V=r.n(P),D=r(62491),F=r.n(D),j=r(56257),U=r.n(j),B=r(98799),J=r.n(B),H=r(38507),q=r.n(H),G=r(7605),W=r.n(G),Y=r(68989),K=r.n(Y),Q=r(55500),Z=r.n(Q);const z=V()(F()((e=>!!e)),U()(","),M()(["config","requiredRoles"],"")),$=M()(["config","accessLevel"],0),X=M()(["config","authenticateFailureRedirectUrl"],""),ee=M()(["config","failureRedirectWithQueryParams"],!1);function te(e,t){void 0===t&&(t=[]);const r=Z()(e);return J()((t=>J()((r=>{var n;return!!(null===(n=e[r])||void 0===n?void 0:n[t])}),r)),t)}function re(e,t){return 0===function(e,t){const r=[];return e===t||W()(K()(Z()(e),Z()(t))).forEach((n=>{const o=q()(n,{},e),s=q()(n,{},t);W()(K()(Z()(o),Z()(s))).forEach((e=>{(null==o?void 0:o[e])!==(null==s?void 0:s[e])&&r.push(e)}))})),r}(e,t).length}var ne=r(29376),oe=r(58626),se=r(31565),ie=r(78047);const ae=(e,t)=>{const r=z(e),n=(0,ne.mm)($(e));return r.length?!te(t,r):((e,t)=>{const r=(0,oe.HS)(e),n=(0,oe.HS)(t);return!(r||!n)||!(r&&!n)&&(0,ne.lw)(e,t)})(t,n)},ue=e=>{let{route:t,url:r,roles:n,redirectType:o="",accessDeniedRedirectUrl:s}=e;const i=null==s?void 0:s();if(i)return i;if((0,ne.QO)(n))return"/mybank/";const{path:a,query:u}=r;if(L()("/login/",r.pathname))return;const c=ee(t),l=X(t);return l?(0,ie.DI)(l,c?u:{}).path:(0,ie.DI)("/login/",{redirectTo:a,redirectType:M()(["config","loginRedirectType"],o,t)}).path};var ce=r(5881),le=r.n(ce),de=r(30353),pe=r.n(de);class he{constructor(e){let{strategies:t=[],timingCallbacks:r}=e;this.isAuthenticateFinishedPromise=null,this.isAuthenticateFinishedPromiseResolve=null,this.strategies=t,this.timingCallbacks=r}async authenticate(){var e,t,r,n,o,s,i,a,u,c,l;null===(t=null===(e=this.timingCallbacks)||void 0===e?void 0:e.onAuthStart)||void 0===t||t.call(e),this.isAuthenticateFinishedPromise=new Promise((e=>{this.isAuthenticateFinishedPromiseResolve=e}));for(let e=0,t=this.strategies.length;e<t;++e){const t=this.strategies[e],c=null!==(r=t.name)&&void 0!==r?r:"unknown:"+e;null===(o=null===(n=this.timingCallbacks)||void 0===n?void 0:n.onAuthStrategyStart)||void 0===o||o.call(n,c);const{status:l,payload:d}=await this.authenticateBy(t);if(null===(i=null===(s=this.timingCallbacks)||void 0===s?void 0:s.onAuthStrategyResolved)||void 0===i||i.call(s,c,"success"===l),"success"===l)return null===(u=null===(a=this.timingCallbacks)||void 0===a?void 0:a.onAuthResolved)||void 0===u||u.call(a,!0),this.isAuthenticateFinishedPromiseResolve(),d}null===(l=null===(c=this.timingCallbacks)||void 0===c?void 0:c.onAuthResolved)||void 0===l||l.call(c,!1),this.isAuthenticateFinishedPromiseResolve()}async authenticateBy(e){return new Promise((t=>{const r={pass:()=>t({status:"pass"}),success:e=>t({status:"success",payload:e})};e.authenticate(r)}))}}class ge{constructor(e){let{sessionManager:t}=e;this.sessionManager=t}authenticate(e){let{success:t,pass:r}=e;this.sessionManager.authenticate().then(t).catch(r)}get name(){return"SessionStrategy"}}class ve extends he{constructor(e){let{strategies:t,sessionManager:r,timingCallbacks:n}=e;super({strategies:t,timingCallbacks:n}),this.prolongateSession=async e=>this.sessionManager.prolongateSession(e),this.sessionManager=r,this.authenticateDeferred=(()=>{let e,t;return{promise:new Promise(((r,n)=>{e=r,t=n})),resolve:e,reject:t}})()}async logout(){return this.sessionManager.logout()}async runAuthenticateFlow(){return this.sessionManager.runAuthenticateFlow()}}const fe="module:authenticate:auth",me="AUTH_JUNIOR_MOCK_ENABLED",ye=[{provide:T.Ym,useValue:d.p,multi:!0},{provide:T.Ym,useValue:A.p,multi:!0},{provide:N.sU,multi:!0,useFactory:e=>{let{store:t,authenticateDeferred:r,onRouteGuardRedirect:n,accessDeniedRedirectUrl:o}=e;return async e=>{let{to:s,url:i}=e;await r.promise;const{requested:a}=t.getState(d.p),u=t.getState(A.p);if(a&&ae(s,u)){const e=ue({route:s,url:i,roles:u,accessDeniedRedirectUrl:o});return n&&await n(e),e}}},deps:{store:T.kR,authenticator:p.i6,authenticateDeferred:"authenticateDeferred",onRouteGuardRedirect:(0,f.jt)(p.qt),accessDeniedRedirectUrl:(0,f.jt)(p.Ri)}},{provide:O.xW,useFactory:e=>{let{context:t}=e;return{key:"auth",fn:e=>{const{requiredCoreRoles:r,requiredRoles:n=r}=e.conditions;if(n){const r=t.getState(A.p),o=t.getState(d.p);if(!te(r,n))return e.forbid();const s=(e=>{let{guid:t,accessLevel:r,campaign:n}=e;const o={guid:t,accessLevel:r};return n&&(o.campaignId=n.id),o})(o);le()(e.getState(),s)||(e.allow(),e.setState(s))}}}},multi:!0,deps:{context:E.l}},{provide:p.i6,useFactory:function(e){let{strategies:t,sessionManager:r,timingCallbacks:n}=e;const o=pe()(t||[]);return new ve({sessionManager:r,strategies:o.concat(new ge({sessionManager:r})),timingCallbacks:n})},deps:{sessionManager:p.db,strategies:{token:p.sI,optional:!0},timingCallbacks:{token:p.SG,optional:!0}}},{provide:w.sQ,multi:!0,useValue:[{key:me,optional:!0}]}];var Ee=r(33926),be=r(50152);const Re=(0,r(42353).y)("AUTH_STATE_CHANGED"),we=["sessionId"];const Se=e=>{let{authenticator:t,sessionLifetimeController:r,pubsub:n,context:o,pageService:s,logger:i,customRedirectUrl:a,queryClient:u,authenticateDeferred:c,onResolveAuthenticate:l,onAccessDeniedRedirect:p,onLogoutRedirect:h,onHasAccess:g,accessDeniedRedirectUrl:v,isClientAuth:f}=e;const m=e=>{e&&r.startProlongateSessionOnUserActivity(),(0,_.FO)(e)&&r.startPollingAuthorizedSessionStatus()};return n.subscribe(fe,(async e=>{m(e.session),u&&(async(e,t)=>{await e.refetchQueries({predicate:e=>{let{options:r}=e;var n;const o=null===(n=r.tramvaiOptions)||void 0===n?void 0:n.conditions;if(!(null==o?void 0:o.requiredRoles)&&!(null==o?void 0:o.requiredCoreRoles))return!1;const{roles:s,newRoles:i}=t;return!re(s,i)}})})(u,e);const t=await(async e=>{let{customRedirectUrl:t,pageService:r,logger:n,payload:o,context:s,onLogoutRedirect:i}=e;var a;const u=n("auth:pubsub"),{roles:c,newRoles:l,session:d}=o,p=(0,ne.QO)(c)&&!(0,ne.QO)(l)||(0,oe.HS)(c)&&!(0,oe.HS)(l);if(p){const e=!d.sessionId,n=!!d.sessionId,o=(e=>{let{customRedirectUrl:t,pageService:r,sessionExpired:n,context:o}=e;var s,i,a;const u=r.getConfig()||{},{pageComponent:c}=u,l=r.getComponent(c),d=n?"sessionExpired":"himselfLogout";return(null==t?void 0:t())||(null===(s=null==u?void 0:u.redirects)||void 0===s?void 0:s[d])||(null===(a=null===(i=null==l?void 0:l.redirects)||void 0===i?void 0:i[d])||void 0===a?void 0:a.call(i,o,{sessionExpired:n}))})({customRedirectUrl:t,pageService:r,sessionExpired:n,context:s});let p,h=o;if(!o){const t={config:r.getConfig()||{}},o=!ae(t,c)&&ae(t,l);if(e&&o)h="/";else if(o){const e=n?"sessionExpired":"";h=ue({route:r.getCurrentRoute(),url:r.getCurrentUrl(),roles:l,redirectType:e})}else h="./",p=null===(a=r.getCurrentUrl())||void 0===a?void 0:a.query}u.debug("force redirect to "+h+" after "+(e?"user logout":"session expired")),i&&await i(h),await r.navigate({url:h,query:p})}return p})({customRedirectUrl:a,pageService:s,payload:e,logger:i,context:o,onLogoutRedirect:h});t||await(async e=>{let{pageService:t,logger:r,payload:n,onAccessDeniedRedirect:o,accessDeniedRedirectUrl:s}=e;const i=r("auth:access"),a=t.getCurrentRoute(),u=t.getCurrentUrl(),{newRoles:c}=n;if(ae(a,c)){i.debug({event:"page-access-denied"});const e=ue({route:a,url:u,roles:c,accessDeniedRedirectUrl:s});return o&&await o(e),t.navigate({url:e,replace:!0}),!0}return!1})({logger:i,pageService:s,payload:e,onAccessDeniedRedirect:p,accessDeniedRedirectUrl:v})})),function(){return t.authenticate().then((()=>{const e=o.getStore(d.p).getState(),t=o.getStore(A.p).getState();!function(e){let{route:t,logger:r,roles:n,onHasAccess:o}=e;const s=r("auth:check-has-access");!ae(t,n)&&(s.debug({event:"has-access"}),null==o||o())}({route:s.getCurrentRoute(),logger:i,onHasAccess:g,roles:t}),m(e)})).finally((()=>{f()&&c.resolve(),l.resolve()}))}},_e=()=>{let e,t;return{promise:new Promise(((r,n)=>{e=r,t=n})),resolve:e,reject:t}},Ne={authenticator:p.i6,sessionLifetimeController:p.Zh,pubsub:y.k3,context:E.l,pageService:N.Y9,logger:b.Fp,customRedirectUrl:{token:p.hM,optional:!0},queryClient:(0,f.jt)(C.sH),authenticateDeferred:"authenticateDeferred",onResolveAuthenticate:p.TN,onAccessDeniedRedirect:(0,f.jt)(p.JG),onHasAccess:(0,f.jt)(p.WO),onLogoutRedirect:(0,f.jt)(p.QZ),accessDeniedRedirectUrl:(0,f.jt)(p.Ri),isClientAuth:p.C7};let Ce=class{};Ce=(0,h.__decorate)([(0,m.Y)({imports:[l.Gi],providers:[...ye,{provide:p.db,useFactory:e=>{let{apiClient:t,pubsub:r,cookie:n,env:o,context:s,sessionCookieName:i}=e;return function(e){let{apiClient:t,pubsub:r,cookie:n,env:o,context:s,initialState:i,sessionCookieName:a}=e;return new be.ZP({initialState:i,apiClient:t,cookie:n,dispatcher:function(e){let{payload:t}=e;const i=s.getStore("session").getState(),a=function(e){if(!o.get(me))return e;if(!e.hasSsoSession)return e;const t=n.get("auth:junior:mock");return void 0===t?e:Object.assign({},e,{isJunior:"false"!==t})}(function(e){const t=e.session,r=(0,Ee.Z)(t,we),{accessLevel:n,guid:o}=s.getStore("session").getState();return Object.assign(r,{guid:n===r.accessLevel?o:(new Date).getTime()})}(t)),u=s.getStore("roles").getState(),c=((e,t)=>{var r;const n=null===(r=t.campaign)||void 0===r?void 0:r.id;return n?(0,oe.ZE)(e,n):(0,ne.kV)((0,se.Mr)(e,oe.MU),t.accessLevel)})(u,a);return Promise.all([s.dispatch((0,d.C)(a)),s.dispatch((0,A.b)(c))]).then((()=>(re(u,c)&&i.hasSsoSession===t.session.hasSsoSession||s.dispatch(Re({session:i,newSession:a,roles:u,newRoles:c})),r.publish(fe,Object.assign({currentSession:i},t,{roles:u,newRoles:c})))))},sessionCookieName:a})}({apiClient:t,pubsub:r,env:o,cookie:n,context:s,sessionCookieName:i,initialState:{session:s.getStore("session").getState()}})},deps:{cookie:R.T,env:w.vC,apiClient:S.JB,pubsub:y.k3,context:E.l,sessionCookieName:{token:p.sV,optional:!0}}},{provide:p.Zh,useClass:_.ZP,deps:{sessionManager:p.db}},(0,o.J)({provide:p.C7,useFactory:e=>{let{envManager:t,renderModeFactory:r}=e;return()=>{const e="function"==typeof r?r():r;return"true"===t.get("TRAMVAI_FORCE_CLIENT_SIDE_RENDERING")||"client"===e}},deps:{envManager:w.vC,renderModeFactory:k.TRAMVAI_RENDER_MODE}}),(0,o.J)({provide:s.Bi.customerStart,useFactory:e=>e.isClientAuth()?Se(e):v(),deps:Ne,multi:!0}),(0,o.J)({provide:s.Bi.generatePage,useFactory:e=>e.isClientAuth()?v():Se(e),deps:Ne,multi:!0}),{provide:"authenticateDeferred",useFactory:e=>{let{isClientAuth:t}=e;const r=_e();return t()||r.resolve(),r},deps:{isClientAuth:p.C7}},{provide:p.TN,useValue:_e()}]})],Ce);var ke=r(35384),Te=r(16842);let Oe=class{};Oe=(0,h.__decorate)([(0,m.Y)({providers:[(0,o.J)({provide:"serviceWorker",useFactory:e=>{let{serviceWorkerUrl:t,serviceWorkerParams:r}=e;return function(){if("serviceWorker"in navigator){let e="";if(null==r?void 0:r.length){const t=[];for(const e of r){const r="function"==typeof e?e():e;r&&Object.keys(r).forEach((e=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(r[e]))}))}e=t.join("&")}return navigator.serviceWorker.register(t+(e?"?"+e:""))}return Promise.reject(new Error("ServiceWorker not supported"))}},deps:{serviceWorkerUrl:"pwaServiceWorkerUrl",serviceWorkerParams:{token:ke.K0,optional:!0}}}),(0,o.J)({provide:"pwaServiceWorkerUrl",useValue:"/sw.js"}),(0,o.J)({provide:s.Bi.init,multi:!0,useFactory:e=>{let{serviceWorkerCommandLine:t,di:r}=e;return function(){r.register({provide:t?s.Bi[t]:s.Bi.customerStart,useFactory:e=>{let{serviceWorker:t,logger:r}=e;return function(){t().catch((e=>{r.warn({event:"serviceworker-initialise-error",error:e})}))}},deps:{serviceWorker:"serviceWorker",logger:b.Fp}})}},deps:{di:Te.Z,serviceWorkerCommandLine:{token:ke.wl,optional:!0}}})]})],Oe);var Ae=r(10650),Ie=r(39535),Me=r(92877),xe=r.n(Me),Le=r(83351),Pe=r(24679),Ve=r(75877);const De=[(0,o.J)({provide:T.Ym,useValue:[Le.vZ,Ve.N9],multi:!0}),(0,o.J)({provide:w.sQ,useValue:[{key:"TINKOFF_API",optional:!0,dehydrate:!0,validator:Pe.CB},{key:"APP_VERSION",optional:!0,dehydrate:!0},{key:"SAFARI_PUSH_API",optional:!0,dehydrate:!0,validator:Pe.CB},{key:"PUSH_WEB_SW_LOG_API",optional:!0,dehydrate:!0}],multi:!0})];var Fe=r(10055),je=r(14122),Ue=r(90130),Be=r(44121),Je=r(42549),He=r(44488),qe=r(16615),Ge=r(42282),We=r.n(Ge),Ye=r(13311);function Ke(e){const t=(0,qe.x)(),r=(0,Ye.s)(e);return(0,Be.useMemo)((()=>We()(r)?r.map((e=>t.executeAction.bind(t,e))):t.executeAction.bind(t,r)),[r,t])}var Qe,Ze=r(36840),ze=r(97548),$e=r(14908),Xe=r(15434),et=r.n(Xe),tt=r(66824),rt=r(67570);const nt=null===(Qe=window.Notification)||void 0===Qe?void 0:Qe.permission,ot=[{rule:e=>{let{permissionState:t,status:r}=e;return"default"===t&&r===Ie.$q.STARTING_SUBSCRIBE.id},event:()=>({eventName:"pushShow"})},{rule:e=>{let{permissionState:t}=e;return"default"===nt&&"granted"===t},event:()=>({eventName:"pushSubscription"})},{rule:e=>{let{permissionState:t}=e;return"default"===nt&&"denied"===t},event:()=>({eventName:"pushBlocked"})}];var st=r(61e3),it=r(95044),at=r(20745),ut=r(24592);const ct=(0,at.H)({name:"sendEventAction",async fn(e){let{eventName:t}=e;const{analytics:r}=this.deps;if(r)return r.event(t)},deps:{analytics:{token:ut.t3,optional:!0}}});var lt=r(22441);const dt=(0,Je.Vo)({chunkName(){return"components-GentleBanner-GentleBanner-browser"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>Promise.resolve().then(r.bind(r,3560)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 3560}}),pt=function(){const e="test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}(),ht="tcs_n_req_time";function gt(){pt&&(localStorage[ht]=Date.now())}const vt=["mobile safari","tablet safari"];class ft extends Be.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){this.props.log.error(e)}render(){return this.state.hasError?null:this.props.children}}function mt(e,t){if(!(null==e?void 0:e.enableGentleBanner)||"standalone"!=(window.matchMedia("(display-mode: standalone)").matches?"standalone":window.matchMedia("(display-mode: browser)").matches?"browser":"unknown"))return!1;let r=-1!==vt.indexOf(t.browser.name);return(null==e?void 0:e.enableBannerForAndroid)&&(r=r||"Android"===t.os.name),r}const yt=(0,Be.memo)((()=>{const e=(0,qe.x)(),t=(0,He.x)(b.Fp),{gentleBannerComponent:r,gentleBannerContent:n}=(0,He.x)({token:Fe.MA,optional:!0})||{},o=(0,He.x)({token:rt.Bv,optional:!0}),{component:s,content:i}=function(e){let{gentleBannerComponent:t,gentleBannerContent:r}=e;var n,o;const s="Notification"in window?window.Notification.permission:null;return s?{component:null!==(n=null==t?void 0:t[s])&&void 0!==n?n:dt,content:null!==(o=null==r?void 0:r[s])&&void 0!==o?o:null}:{component:null,content:null}}({gentleBannerComponent:r,gentleBannerContent:n}),u=Ke(lt.$y),c=Ke(lt.D0),l=(0,Ze.o)(Ve.N9),{status:d,permissionState:p,subscribed:h,unsubscribed:g,enableAutoSubscription:v,autoSubscriptionDelay:f,authorized:m,enableGentleBanner:y,gentleBannerPeriodicity:E}=(0,ze.v)([Le.vZ,$e.sH,A.p,tt.c],(e=>{let{pushWeb:t,router:r,roles:n,userAgent:o}=e;var s,i,a,u,c,l;return{status:t.status,unsubscribed:t.status===Ie.$q.UNSUBSCRIBED.id,enableAutoSubscription:!(!(null===(s=t.settings)||void 0===s?void 0:s.enablePush)||!(null===(a=null===(i=null==r?void 0:r.currentRoute)||void 0===i?void 0:i.config)||void 0===a?void 0:a.enablePush)),enableGentleBanner:mt(t.settings,o),gentleBannerPeriodicity:null!==(c=null===(u=t.settings)||void 0===u?void 0:u.gentleBannerPeriodicity)&&void 0!==c?c:3,subscribed:t.status===Ie.$q.SUBSCRIBED.id,autoSubscriptionDelay:(null===(l=t.settings)||void 0===l?void 0:l.autoSubscriptionDelay)||st.ki,permissionState:t.permissionState,authorized:(0,ne.QO)(n)}})),R=l.isPushWebGentleBannerRendered&&Boolean(s),w=(0,He.x)({token:a.N,optional:!0}),S=(0,He.x)({token:Fe.SN,optional:!0}),_=(0,He.x)({token:Fe.Ji,optional:!0}),N=(0,Be.useCallback)((t=>e.executeAction(it.k,{action:"subscribe",force:t})),[e]),C=(0,Be.useCallback)((t=>e.executeAction(ct,{eventName:t})),[e]),k=(0,Be.useRef)({trackedEvents:{},currentEvent:Promise.resolve(),firstSubscription:!1,sessionUpdated:!1,log:t(je.QG)}),T=(0,Be.useCallback)((e=>{et()((t=>{t.rule(e)&&(k.current.currentEvent=k.current.currentEvent.then((()=>t.event())).then((e=>{let{eventName:t}=e;if(!k.current.trackedEvents[t])return k.current.log.debug("sent event "+t),k.current.trackedEvents[t]=!0,C(t);k.current.log.debug("event "+t+" already sent")})))}),ot)}),[C]);(0,Be.useEffect)((()=>{var e;T({status:d,permissionState:p}),v?(h&&(k.current.firstSubscription=!0),g&&"granted"===(null===Notification||void 0===Notification?void 0:Notification.permission)&&!k.current.firstSubscription?(k.current.firstSubscription=!0,N(!1)):"default"!==(null===(e=window.Notification)||void 0===e?void 0:e.permission)||k.current.firstSubscription?!k.current.sessionUpdated&&m&&h&&(k.current.sessionUpdated=!0,k.current.log.debug("force update authorized subscription info"),N(!0)):(k.current.firstSubscription=!0,y?function(e){if(pt){const t=localStorage[ht];if(t)try{return Number(t)+60*e*60*24*1e3<Date.now()}catch(e){return!0}return!0}return!1}(E)&&(null==o||o.send({project:"push-web",event:"banner_webpushShow"}),null==S||S(),u()):"mobile"!==w.device.type&&(k.current.log.debug("show subscription window"),setTimeout((()=>N(!1)),f)))):k.current.log.debug("auto subscription is not enabled by route settings")}),[d,p,h,g,v,N,f,m,T,y,E,o,w,u]);const O=(0,Be.useCallback)((e=>{_&&_(e)}),[_]),I=(0,Be.useCallback)((()=>(null==o||o.send({project:"push-web",event:"banner_webpushTurnOn"}),O("accept"),gt(),c(),null===Notification||void 0===Notification?void 0:Notification.requestPermission((()=>{N(!1)})))),[o,O,N,c]),M=(0,Be.useCallback)((()=>{null==o||o.send({project:"push-web",event:"banner_webpushRemindLater"}),O("decline"),gt(),c()}),[o,O,c]),x=(0,Be.useCallback)((()=>{null==o||o.send({project:"push-web",event:"banner_webpushClose"}),O("dismiss"),c()}),[o,O,c]);return R?(0,Ue.jsx)(ft,{log:k.current.log,children:(0,Ue.jsx)(s,{opened:l.isPushWebGentleBannerVisible,onAccept:I,onDecline:M,onClose:x,bannerTitle:null==i?void 0:i.bannerTitle,bannerDescription:null==i?void 0:i.bannerDescription,iconUrl:null==i?void 0:i.iconUrl,primaryButton:null==i?void 0:i.primaryButton,secondaryButton:null==i?void 0:i.secondaryButton})}):null}));var Et=r(3560);const bt=(0,f.V3)("push app key"),Rt=(0,n.J)({name:"BasePushWebModule",imports:[],providers:[...De,(0,o.J)({provide:Fe.MA,useFactory:e=>{let{webPushBannerContent:t}=e;var r,n,o;return{gentleBannerComponent:{default:Et.default},gentleBannerContent:{default:{bannerDescription:null!==(r=null==t?void 0:t.bannerDescription)&&void 0!==r?r:st.qs,bannerTitle:null!==(n=null==t?void 0:t.bannerTitle)&&void 0!==n?n:st.Pq,iconUrl:null!==(o=null==t?void 0:t.iconUrl)&&void 0!==o?o:st.J8,primaryButton:null==t?void 0:t.primaryButton,secondaryButton:null==t?void 0:t.secondaryButton}}}},deps:{webPushBannerContent:{token:Fe.QF,optional:!0}}}),(0,o.J)({provide:s.Bi.resolveUserDeps,useFactory:e=>function(){return Promise.resolve(e.webPush)},deps:{webPush:Fe.ai},multi:!0}),(0,o.J)({provide:Fe.c7,useFactory:e=>{let{logger:t}=e;return t({name:je.SG,defaults:{remote:!0}})},deps:{logger:b.Fp}}),(0,o.J)({provide:Fe.ai,useFactory:function(e){let{userAgent:t,wuid:r,envManager:n,context:o,sessionManager:s,pushAppKey:i,webPushLogger:a,logger:u,userSettings:c}=e;var l,p;const h=u(je.QG);if(!Ie.ZP.checkSupport())return h.debug("Notifications are not supported by @push-web/tinkoff-push-web"),null;const g=o.getState(Le.vZ);if(xe()(g.settings))return h.debug("Failed to load settings, skipping @push-web/tinkoff-push-web instantiating"),null;const v=o.getState(d.p),f=Object.assign({wuid:r,sessionid:s.getSessionId(),osName:t.os.name+" "+t.os.version,browser:t.browser.name||"",appVersion:n.get("APP_VERSION"),applicationServerKey:new Uint8Array(null!==(l=g.settings.applicationServerKey)&&void 0!==l?l:[]),safari:{webServiceURL:n.get("SAFARI_PUSH_API")||je.xn.webServiceURL,webSitePushId:je.xn.webSitePushId,firmware:je.xn.firmware,clientId:null!==(p=null==v?void 0:v.userId)&&void 0!==p?p:"",deviceStringId:r}},null!=c?c:{});return g.settings.applicationFullName&&(f.applicationFullName=g.settings.applicationFullName),new Ie.ZP({api:{host:n.get("TINKOFF_API")||Ie.Yk.host,swLog:n.get("PUSH_WEB_SW_LOG_API")},appKey:i,settings:f,stateChangeCb:e=>{let{id:t,interactive:r,subscribed:n,permissionState:s}=e;return o.dispatch((0,Le.Rr)({status:t,interactive:r,subscribed:n,permissionState:s}))},subscriptionUpdateCb:e=>o.dispatch((0,Le.Pt)({subscription:e})),logCb:e=>{e.level&&a[e.level](e)}})},deps:{userSettings:{token:Fe.ev,optional:!0},userAgent:a.N,wuid:c.$,envManager:w.vC,context:E.l,logger:b.Fp,sessionManager:p.db,pushAppKey:bt,webPushLogger:Fe.c7}}),(0,o.J)({provide:ke.K0,useFactory:e=>{let{webPushAppKey:t}=e;return t?{webPushAppKey:t}:null},deps:{context:E.l,webPushAppKey:bt}}),(0,o.J)({provide:Ae.sn,useFactory:e=>{let{webPushAppKey:t}=e;return t?{webPushAppKey:t}:null},deps:{context:E.l,webPushAppKey:bt}}),(0,o.J)({provide:bt,useFactory:e=>{let{context:t}=e;var r;return null===(r=t.getState(Le.vZ).settings)||void 0===r?void 0:r.applicationFullName},deps:{context:E.l,appInfo:i.Qo}}),(0,o.J)({provide:k.LAYOUT_OPTIONS,useValue:[{components:{pushWeb:yt}}],multi:!0})]});u.pY,l.Gi},3560:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var n=r(90130),o=r(56691),s=r(54322),i=r(44488),a=r(44121),u=r(61e3),c=r(10055),l=r(33926),d=r(23286);const p=["onClick"],h=e=>{let{onClick:t}=e,r=(0,l.Z)(e,p);return(0,n.jsx)(d.Z,Object.assign({theme:"primary",onClick:t,size:"m",round:!0,dataQaType:"pushweb-accept-button",children:"Включить"},r))},g=["onClick"],v=e=>{let{onClick:t}=e,r=(0,l.Z)(e,g);return(0,n.jsx)(d.Z,Object.assign({theme:"flat",onClick:t,size:"m",dataQaType:"pushweb-decline-button",children:"Напомнить позже"},r))};function f(e){var t,r,l,d,p;const g=(0,i.x)({token:c.WH,optional:!0}),f=(0,i.x)({token:c.Ji,optional:!0});return(0,a.useEffect)((()=>{if(e.opened&&g)return g(),f}),[g,f,e.opened]),(0,n.jsx)(o.ZP,{opened:e.opened,closeable:!1,onClose:e.onClose,children:(0,n.jsx)(s.N,{title:null!==(t=e.bannerTitle)&&void 0!==t?t:u.Pq,description:null!==(r=e.bannerDescription)&&void 0!==r?r:u.qs,image:(0,n.jsx)("img",{src:""+(null!==(l=e.iconUrl)&&void 0!==l?l:"https://cdn.tbank.ru/static/pages/files/1aea01d6-042d-4786-88a1-f6131c169f50.svg"),alt:""}),primaryButton:null===(null==e?void 0:e.primaryButton)?null:(0,n.jsx)(h,Object.assign({},null!==(d=null==e?void 0:e.primaryButton)&&void 0!==d?d:{},{onClick:t=>{var r,n,o;null===(r=null==e?void 0:e.onAccept)||void 0===r||r.call(e),null===(o=null===(n=null==e?void 0:e.primaryButton)||void 0===n?void 0:n.onClick)||void 0===o||o.call(n,t)}})),secondaryButton:null===(null==e?void 0:e.secondaryButton)?null:(0,n.jsx)(v,Object.assign({},null!==(p=null==e?void 0:e.secondaryButton)&&void 0!==p?p:{},{onClick:t=>{var r,n,o;null===(r=null==e?void 0:e.onDecline)||void 0===r||r.call(e),null===(o=null===(n=null==e?void 0:e.secondaryButton)||void 0===n?void 0:n.onClick)||void 0===o||o.call(n,t)}})),variant:"fullscreen"})})}},61e3:function(e,t,r){"use strict";r.d(t,{J8:function(){return i},Pq:function(){return o},ki:function(){return n},qs:function(){return s}});const n=1e4,o="Советуем включить пуш‑уведомления",s="Они будут приходить как обычно и помогут не пропустить важное о ваших финансах",i="https://cdn.tbank.ru/static/pages/files/1aea01d6-042d-4786-88a1-f6131c169f50.svg"},14122:function(e,t,r){"use strict";r.d(t,{QG:function(){return o},SG:function(){return s},xn:function(){return n}});const n={webServiceURL:"https://safaripush.tcsbank.ru",webSitePushId:"web.www.push.tinkoff.ru",firmware:"safari"},o="webpush",s="webpush-remote"},75877:function(e,t,r){"use strict";r.d(t,{CL:function(){return s},N9:function(){return u},fV:function(){return a},rA:function(){return i}});var n=r(42353),o=r(58426);const s=(0,n.y)("PUSH_WEB_SHOW_GENTLE_BANNER"),i=(0,n.y)("PUSH_WEB_HIDE_GENTLE_BANNER"),a=(0,n.y)("PUSH_WEB_UNMOUNT_AND_HIDE_GENTLE_BANNER"),u=(0,o.L)("gentleBanner",{isPushWebGentleBannerRendered:!1,isPushWebGentleBannerVisible:!1}).on(s,(e=>Object.assign({},e,{isPushWebGentleBannerRendered:!0,isPushWebGentleBannerVisible:!0}))).on(i,(e=>Object.assign({},e,{isPushWebGentleBannerRendered:!0,isPushWebGentleBannerVisible:!1}))).on(a,(e=>Object.assign({},e,{isPushWebGentleBannerRendered:!1,isPushWebGentleBannerVisible:!1})))},83351:function(e,t,r){"use strict";r.d(t,{Pt:function(){return u},Rr:function(){return a},vZ:function(){return l}});var n=r(42353),o=r(58426),s=r(39535);const i=(0,n.y)("PUSH_WEB_SETTINGS_LOADED"),a=(0,n.y)("PUSH_WEB_STATE_UPDATE"),u=(0,n.y)("PUSH_WEB_SUBSCRIPTION_UPDATE"),c=Object.assign({},s.$q.INIT,{subscription:null,status:s.$q.INIT.id,settings:{}}),l=(0,o.L)("pushWeb",c).on(i,((e,t)=>Object.assign({},e,{settings:t.settings}))).on(a,((e,t)=>Object.assign({},e,t))).on(u,((e,t)=>Object.assign({},e,{subscription:t.subscription})))},10055:function(e,t,r){"use strict";r.d(t,{Ji:function(){return p},MA:function(){return u},QF:function(){return c},SN:function(){return l},WH:function(){return d},ai:function(){return o},c7:function(){return a},ev:function(){return s},nd:function(){return i}});var n=r(59999);const o=(0,n.V3)("PUSH_WEB_INSTANCE_TOKEN"),s=(0,n.V3)("PUSH_WEB_USER_SETTINGS"),i=(0,n.V3)("PUSH_NOTIFICATIONS_SETTINGS"),a=(0,n.V3)("WEB_PUSH_LOGGER"),u=(0,n.V3)("webPushCustomGentleBannerConfig"),c=(0,n.V3)("webPushGentleBannerConfig"),l=(0,n.V3)("webPushGentleBannerOnShowRequest"),d=(0,n.V3)("webPushOnAppear"),p=(0,n.V3)("webPushOnClose")},71890:function(e,t,r){"use strict";r.d(t,{J:function(){return Ee}});var n=r(80476),o=r(80283),s=r(97570),i=r(67584),a=r(82571),u=r(82342),c=r(82912),l=r(49076),d=r(37621),p=r(10776),h=r(24592),g=r(20076),v=r(33926),f=r(78047),m=r(92877),y=r.n(m),E=r(60028),b=r.n(E),R=r(57801),w=r.n(R);const S=/[&<>"']/,_={38:"&amp;",60:"&lt;",62:"&gt;",34:"&quot;",39:"&#039;"};function N(e){return void 0===e&&(e=""),function(e,t,r){if(0===e.length||!1===t.test(e))return e;let n=0,o=0,s="",i="";for(;o<e.length;o++){const t=e.charCodeAt(o);t in r&&(i=r[t],o!==n&&(s+=e.slice(n,o)),s+=i,n=o+1)}return o!==n&&(s+=e.slice(n,o)),s}(e,S,_)}var C=r(2012),k=r.n(C);const T="x-service",O="dcoData",A="dcoTrackingData",I="beforeRedirectPageUrl",M={"<":"\\u003C","\u2028":"\\u2028","\u2029":"\\u2029"},x=new RegExp("["+Object.keys(M).join("")+"]","g");function L(e){let t;try{r=e,void 0===(n=JSON.stringify(r))&&(n=""),t=n.replace(x,(e=>M[e]))}catch(e){}var r,n;return t||""}var P=r(57471),V=r.n(P),D=r(60411),F=r.n(D);const j=["utm_source","utm_content","utm_campaign","utm_medium","utm_term","sid","wm"],U=(e,t)=>"dco.id"===e?new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(t):void 0!==e&&void 0!==t,B=j.reduce(((e,t)=>Object.assign({},e,{[t]:!0})),{}),J="utm_source",H=/; */,q=/, */,G=e=>V()(((e,t)=>!B[t]),e),W=(e,t)=>Object.keys(e).sort().map((r=>{const n=t[r]||e[r];return U(r,n)?r+"="+e[r]:null})).filter(Boolean).join("; "),Y=(e,t,r,n)=>{const o=(e=>{if(!e)return e;const t={};return Object.keys(e).forEach((r=>{if(Object.prototype.hasOwnProperty.call(e,r))try{t[encodeURIComponent(r)]=encodeURIComponent(e[r])}catch(e){}})),t})((e=>!!e.utm_source&&F()(j,e))(e));return o?W(Object.assign({},G(r),o),t):t[J]?W(r,t):W(Object.assign({},G(r),{[J]:n||""}),t)};var K=r(15434),Q=r.n(K),Z=r(33057),z=r.n(Z),$=r(42282),X=r.n($),ee=r(7605),te=r.n(ee);const re=["protocol","host","pathname","query"];function ne(e,t,r){let n=Object.assign({},e);var o;return void 0!==r&&(n.query=Object.assign({},n.query,{dco_ic:r})),n=Object.assign({},n,{query:(o=Object.assign({},n.query,t.query),w()((e=>{if(X()(e)){const t=te()(e);return 1===t.length?t[0]:t}return e}),o))}),n=F()(re,n),"/"!==n.pathname.slice(-1)&&(n.pathname+="/"),(0,f.WU)(n)}var oe=r(52158),se=r.n(oe);const ie=[{dcoAppliedStatus:"not_match",dcoAppliedEntity:"pageContent"}];function ae(e){return y()(e)||se()(ie)}const ue=["logger"];class ce{constructor(e){let{logger:t}=e,r=(0,v.Z)(e,ue);this.parseUrl=k()(3,f.Qc),this.sanitizeReferrer=k()(3,N),this.parseCookie=k()(3,(e=>{const t=(void 0===(r=e)&&(r=""),r.split(H).reduce(((e,t)=>{const r=t.indexOf("="),n=t.slice(0,r).replace(/^\s+/,""),o=t.slice(r+1);return Object.assign({},e,{[n]:o})}),{}));var r;return{rawUserCookie:t,decodedUserCookie:w()((e=>function(e){try{return decodeURIComponent(e)}catch(t){return e}}(e)),t)}})),this.logger=t({name:"dco-client"}),this.getClientParameters="clientParametersFactory"in r?r.clientParametersFactory:()=>r}getParsedClientParameters(){const{pageUrl:e,userHeaders:t}=this.getClientParameters(),r=w()((e=>Array.isArray(e)?e.join(","):e),t);return Object.assign({pageUrl:this.parseUrl(e),pageReferrer:this.sanitizeReferrer(r.referer),userHeaders:r},this.parseCookie(r.cookie))}getDcoRequestParams(e){let{appId:t,service:r}=e;const{pageUrl:n,decodedUserCookie:o,rawUserCookie:s,pageReferrer:i,userHeaders:a}=this.getParsedClientParameters(),{query:u}=n,c={"x-app-id":t,"x-dco-user-data":Y(u,o,s,i)};return r?c[T]=r:a[T]&&(c[T]=a[T]),{headers:c,payload:Object.assign({},u,{trackingState:L({dco:{referrer:i,beforeRedirectPageUrl:o[I]}})})}}getUserResponseParams(e){const{pageUrl:t,decodedUserCookie:r,pageReferrer:n}=this.getParsedClientParameters();this.latestResponse=e;const{dcoResponse:o,dcoResponseHeaders:s}=e;var i;const a=(e=>{const t=[];return Q()((r=>{const n=e[r];U(r,n)&&t.push({name:r,value:n,expires:31536e3,noSubdomains:!0})}),Object.keys(e).sort()),t})((void 0===(i=s["x-dco-set-context"])&&(i=""),i.split(q).reduce(((e,t)=>{const[r,n]=t.split("=");return Object.assign({},e,{[r]:n})}),{}))),{dcoTracking:u,dco:c}=o,l=!y()(c)&&!y()(c.state),d=ae(u);if(l&&o.redirectUrl)return a.push({name:I,value:t.pathname,expires:60},{name:O,value:L(c),expires:60},{name:A,value:L(u),expires:60}),{redirectUrl:ne((0,f.Qc)(o.redirectUrl),t,b()(["state","ic"],c)),redirectCode:o.redirectCode,cookieSet:a};const{dco:p,dcoTracking:h}=((e,t)=>{const r=e[O],n=e[A],o={};if(r)try{o.dco=JSON.parse(r)}catch(e){t.error(e,"error occurred while parsing dco cookie "+O)}if(n)try{o.dcoTracking=JSON.parse(n)}catch(e){t.error(e,"error occurred while parsing dco cookie "+A)}return o})(r,this.logger);p&&a.push({name:O,value:"",expires:new Date(0)}),h&&a.push({name:A,value:"",expires:new Date(0)});const g=l||!p?c:p,v=d||ae(h)?u:h,m=function(e){let{dcoData:t,dcoTrackingData:r,query:n,dcoResponseHeaders:o,decodedUserCookie:s,referrer:i}=e;const a=z()(["dco_ic"],"",n),u=b()(["x-dco-ic"],o),c={dcoTracking:r,personalizedLandingMetrics:t,dco:{referrer:i,ic:b()(["state","ic"],t)||u||a}};return s.beforeRedirectPageUrl&&(c.dco.beforeRedirectPageUrl=s.beforeRedirectPageUrl),c}({referrer:n,query:t.query,dcoData:g,dcoTrackingData:v,dcoResponseHeaders:s,decodedUserCookie:r});return{cookieSet:a,dcoData:g,trackingData:m}}getDcoResponseStatus(){var e,t,r,n;return null===(n=null===(r=null===(t=null===(e=this.latestResponse)||void 0===e?void 0:e.dcoResponse)||void 0===t?void 0:t.dco)||void 0===r?void 0:r.techInfo)||void 0===n?void 0:n["response-status"]}}var le=r(34770),de=r.n(le),pe=r(63609),he=r.n(pe),ge=r(42353),ve=r(58426);const fe=(0,ge.y)("Set DCO tracking data"),me=(0,ve.L)("dcoTracking",{}).on(fe,((e,t)=>{let{path:r,data:n}=t;return Object.assign({},e,{[r]:n})})),ye=[{provide:d.Ym,multi:!0,useValue:[me]}];let Ee=class{};Ee=(0,n.__decorate)([(0,o.Y)({providers:[...ye,(0,s.J)({provide:a.sQ,multi:!0,scope:i.s.REQUEST,useValue:[{key:"DCO_SERVICE",optional:!0,dehydrate:!0}]}),(0,s.J)({provide:"dcoClient",scope:i.s.REQUEST,useFactory:e=>{let{logger:t,requestManager:r}=e;return new ce({logger:t,clientParametersFactory:()=>({pageUrl:r.getUrl(),userHeaders:r.getHeaders()})})},deps:{logger:u.Fp,requestManager:c.G}}),(0,s.J)({provide:g.eZ,multi:!0,scope:i.s.REQUEST,useFactory:e=>{let{cookieManager:t,context:r,dcoClient:n,routesFallback:o,envManager:s,domainResolve:i,requestManager:a}=e;return e=>async u=>{if(a.getHeader("x-tramvai-static-page-revalidate"))return e(u);o&&e(u).then((e=>{let{route:t,payload:r}=e;t&&("string"!=typeof r&&"page"in r&&r.page.matchedUrlParams?o.set(Object.assign({},t,{alias:u.url.pathname}),{appId:u.appId}):o.set(t,{appId:u.appId}))})).catch((()=>{}));const c=n.getDcoRequestParams({appId:u.appId,service:s.get("DCO_SERVICE")}),[l,d]=await Promise.all([e(Object.assign({},u,{shouldSetFallback:!1,requestOptions:Object.assign({},u.requestOptions,{headers:c.headers,query:c.payload,cache:!1})})),i()]);if(!de()(l.payload))return l;const p=n.getUserResponseParams({dcoResponseHeaders:l.headers,dcoResponse:l.payload});if(p.cookieSet.forEach((e=>t.set(e))),"trackingData"in p&&r.dispatch(fe({path:u.url.pathname,data:p.trackingData})),"redirectUrl"in p){const e=he()(new RegExp("^https://(?:"+d+"|"+d.replace(/^www\./,"")+")"),"",p.redirectUrl);return Object.assign({},l,{payload:Object.assign({},l.payload,{redirectUrl:e}),route:Object.assign({},l.route,{name:"dco-redirect",redirect:{url:e,code:+p.redirectCode,preserveQuery:!1}})})}return l}},deps:{cookieManager:p.T,context:l.l,routesFallback:{token:g.c3,optional:!0},envManager:a.vC,domainResolve:g.xO,requestManager:c.G,dcoClient:"dcoClient"}}),(0,s.J)({provide:"router afterNavigateHooks",multi:!0,useFactory:e=>{let{store:t,tracking:r}=e;return async e=>{let{to:n,url:o}=e;const s=(null==n?void 0:n.actualPath)||(null==n?void 0:n.path)||(null==o?void 0:o.pathname);if(!s)return;const i=t.getState(me);i[s]&&(null==r||r.extend(i[s]))}},deps:{tracking:{token:h.t3,optional:!0},store:d.kR}})]})],Ee)},14062:function(e,t,r){"use strict";r.d(t,{t2:function(){return ht}});var n=r(66598),o=r(97570),s=r(78047),i=r(4216),a=r.n(i),u=r(34770),c=r.n(u),l=r(5203),d=r(64805),p=r.n(d);let h={trace:p(),debug:p(),info:p(),warn:p(),error:p()};const g=e=>{h=e};var v=r(12836);class f{constructor(e){let{trailingSlash:t,mergeSlashes:r,enableViewTransitions:n,beforeResolve:o=[],beforeNavigate:s=[],afterNavigate:i=[],beforeUpdateCurrent:a=[],afterUpdateCurrent:u=[],guards:c=[],onChange:l=[],onRedirect:d,onNotFound:p,onBlock:h}=e;this.started=!1,this.trailingSlash=!1,this.strictTrailingSlash=!0,this.viewTransitionsEnabled=!1,this.mergeSlashes=!1,this.trailingSlash=null!=t&&t,this.strictTrailingSlash=void 0===t,this.mergeSlashes=null!=r&&r,this.viewTransitionsEnabled=null!=n&&n,this.hooks=new Map([["beforeResolve",new Set(o)],["beforeNavigate",new Set(s)],["afterNavigate",new Set(i)],["beforeUpdateCurrent",new Set(a)],["afterUpdateCurrent",new Set(u)]]),this.guards=new Set(c),this.syncHooks=new Map([["change",new Set(l)]]),this.onRedirect=d,this.onNotFound=p,this.onBlock=h,this.currentUuid=0}async start(){h.debug({event:"start"}),this.started=!0}getCurrentRoute(){var e,t,r;return null!==(t=null===(e=this.currentNavigation)||void 0===e?void 0:e.to)&&void 0!==t?t:null===(r=this.lastNavigation)||void 0===r?void 0:r.to}getCurrentUrl(){var e,t,r;return null!==(t=null===(e=this.currentNavigation)||void 0===e?void 0:e.url)&&void 0!==t?t:null===(r=this.lastNavigation)||void 0===r?void 0:r.url}getLastRoute(){var e;return null===(e=this.lastNavigation)||void 0===e?void 0:e.to}getLastUrl(){var e;return null===(e=this.lastNavigation)||void 0===e?void 0:e.url}commitNavigation(e){h.debug({event:"commit-navigation",navigation:e}),e.history||this.history.save(e),this.lastNavigation=e,this.currentNavigation=null,this.runSyncHooks("change",e)}async updateCurrentRoute(e){return this.internalUpdateCurrentRoute(e,{})}async internalUpdateCurrentRoute(e,t){let{history:r}=t;var n;const o=null!==(n=this.currentNavigation)&&void 0!==n?n:this.lastNavigation;if(!o)throw new Error("updateCurrentRoute should only be called after navigate to some route");const{replace:s,params:i,navigateState:a}=e,{to:u,url:c}=o,l={type:"updateCurrentRoute",from:u,to:this.resolveRoute({params:i,navigateState:a},{wildcard:!0}),url:this.resolveUrl(e),fromUrl:c,replace:s,history:r,navigateState:a,code:e.code,key:this.uuid()};h.debug({event:"update-current-route",updateRouteOptions:e,navigation:l}),await this.run(l)}async runUpdateCurrentRoute(e){await this.runHooks("beforeUpdateCurrent",e),this.commitNavigation(e),await this.runHooks("afterUpdateCurrent",e)}async navigate(e){return this.internalNavigate((0,v.ub)(e),{})}async internalNavigate(e,t){let{history:r,redirect:n}=t;var o;const{url:s,replace:i,params:a,navigateState:u,code:c,viewTransition:l}=e,d=n?this.lastNavigation:null!==(o=this.currentNavigation)&&void 0!==o?o:this.lastNavigation;if(!s&&!d)throw new Error("Navigate url should be specified and cannot be omitted for first navigation");const p=this.resolveUrl(e),{to:g,url:v}=null!=d?d:{};let f={type:"navigate",from:g,url:p,fromUrl:v,replace:i,history:r,navigateState:u,code:c,redirect:n,redirectFrom:n?this.currentNavigation.to:void 0,key:this.uuid()};this.viewTransitionsEnabled&&void 0!==l&&(f.viewTransition=l),await this.runHooks("beforeResolve",f);const m=this.resolveRoute({url:p,params:a,navigateState:u},{wildcard:!0});if(m&&(f=Object.assign({},f,{to:m})),h.debug({event:"navigation",navigation:f}),!f.to)return this.notfound(f);await this.run(f)}async runNavigate(e){if(e.to.redirect)return this.redirect(e,(0,v.ub)(e.to.redirect));await this.runGuards(e),await this.runHooks("beforeNavigate",e),this.commitNavigation(e),await this.runHooks("afterNavigate",e)}async run(e){this.currentNavigation=e,"navigate"===e.type&&await this.runNavigate(e),"updateCurrentRoute"===e.type&&await this.runUpdateCurrentRoute(e)}resolve(e,t){const r=(0,v.ub)(e);return this.resolveRoute(Object.assign({},r,{url:(0,s.Qc)(r.url)}),t)}back(e){return this.go(-1,e)}forward(){return this.go(1)}async go(e,t){return h.debug({event:"history.go",to:e}),this.history.go(e,t)}isNavigating(){return!!this.currentNavigation}async dehydrate(){throw new Error("Not implemented")}async rehydrate(e){throw new Error("Not implemented")}addRoute(e){var t;null===(t=this.tree)||void 0===t||t.addRoute(e)}async redirect(e,t){var r;return h.debug({event:"redirect",navigation:e,target:t}),null===(r=this.onRedirect)||void 0===r?void 0:r.call(this,Object.assign({},e,{from:e.to,fromUrl:e.url,to:null,url:this.resolveUrl(t)}))}async notfound(e){var t;return h.debug({event:"not-found",navigation:e}),null===(t=this.onNotFound)||void 0===t?void 0:t.call(this,e)}async block(e){if(h.debug({event:"blocked",navigation:e}),this.currentNavigation=null,this.onBlock)return this.onBlock(e);throw new Error("Navigation blocked")}cancel(){}normalizePathname(e){let t=e;return this.mergeSlashes&&(t=(0,v.ym)(t)),this.strictTrailingSlash||(t=(0,v.RZ)(t,this.trailingSlash)),t}resolveUrl(e){let{url:t,query:r={},params:n,preserveQuery:o,hash:i}=e;var a;const u=this.getCurrentRoute(),c=this.getCurrentUrl(),d=t?(0,s.Hz)(null!==(a=null==c?void 0:c.href)&&void 0!==a?a:"",t):(0,s.F_)(c.href);let{pathname:p}=d;return n&&(t?p=(0,l.gY)(d.pathname,n):u&&(p=(0,l.gY)(u.path,Object.assign({},u.params,n)))),(0,v.EE)(d)&&(p=this.normalizePathname(p)),(0,s.n2)((0,s.co)(d,{pathname:p,search:t?d.search:"",query:Object.assign({},o?this.getCurrentUrl().query:{},r),hash:null!=i?i:d.hash}))}resolveRoute(e,t){let{url:r,params:n,navigateState:o}=e,{wildcard:s}=void 0===t?{}:t;var i,a;let u=r?null===(i=this.tree)||void 0===i?void 0:i.getRoute(r.pathname):this.getCurrentRoute();if(s&&!u&&r&&(u=null===(a=this.tree)||void 0===a?void 0:a.getWildcard(r.pathname)),u)return n||o!==u.navigateState?Object.assign({},u,{params:Object.assign({},u.params,n),navigateState:o}):u}async runGuards(e){if(h.debug({event:"guards.run",navigation:e}),!this.guards)return void h.debug({event:"guards.empty",navigation:e});const t=await Promise.all(Array.from(this.guards).map((t=>Promise.resolve(t(e)).catch((e=>{h.warn({event:"guard.error",error:e})})))));h.debug({event:"guards.done",navigation:e,results:t});for(const r of t){if(!1===r)return this.block(e);if(a()(r)||c()(r))return this.redirect(e,(0,v.ub)(r))}}registerGuard(e){return(0,v.hx)(this.guards,e)}runSyncHooks(e,t){h.debug({event:"sync-hooks.run",hookName:e,navigation:t});const r=this.syncHooks.get(e);if(r){for(const e of r)try{e(t)}catch(e){h.warn({event:"sync-hooks.error",error:e})}h.debug({event:"sync-hooks.done",hookName:e,navigation:t})}else h.debug({event:"sync-hooks.empty",hookName:e,navigation:t})}registerSyncHook(e,t){return(0,v.hx)(this.syncHooks.get(e),t)}async runHooks(e,t){h.debug({event:"hooks.run",hookName:e,navigation:t});const r=this.hooks.get(e);r?(await Promise.all(Array.from(r).map((r=>Promise.resolve(r(t)).catch((t=>{if(h.warn({event:"hook.error",error:t}),"beforeResolve"===e)throw t}))))),h.debug({event:"hooks.done",hookName:e,navigation:t})):h.debug({event:"hooks.empty",hookName:e,navigation:t})}registerHook(e,t){return(0,v.hx)(this.hooks.get(e),t)}uuid(){return this.currentUuid++}}class m{init(e){}listen(e){this.listener=e}setTree(e){this.tree=e}}const y=window.history&&window.history.pushState,E=e=>e&&"string"==typeof e.key,b=function(e,t,r){void 0===r&&(r=0);const n=(e=>{const{to:t}=e;if(t)return t.name+"_"+t.path})(e),o=((e,t)=>{const r={};if(e.replace){const e=null==t?void 0:t.navigateState.previousRoute,n=null==t?void 0:t.navigateState.previousUrl;return e&&(r.previousRoute=e),n&&(r.previousUrl=n),r}return e.from&&(r.previousRoute=e.from),e.fromUrl&&(r.previousUrl=e.fromUrl),r})(e,t);let{type:s}=e;return e.replace&&t&&(s=t.type===s?s:"navigate"),{key:n,type:s,navigateState:Object.assign({},o,e.navigateState),index:r}};class R extends m{constructor(){super(),this.currentIndex=0,this.historyWrapper=(e=>{let{onNavigate:t}=e;if(!y){const e=(e,t,r)=>{window.location.href=r.toString()};return window.history.pushState=e,window.history.replaceState=e,{navigate:t=>{let{path:r}=t;return e({},"",r)},history:()=>{throw new Error("Method not implemented")},init:p(),subscribe:p()}}let r=window.history;"__originalHistory"in window.history?r=window.history.__originalHistory:window.history.__originalHistory={pushState:r.pushState.bind(window.history),replaceState:r.replaceState.bind(window.history),go:r.go.bind(window.history)};const n=r.pushState.bind(window.history),o=r.replaceState.bind(window.history),s=r.go.bind(window.history),i=e=>{s(e)},a=function(e){return void 0===e&&(e=!1),(r,n,o)=>{t({url:o.toString(),replace:e,navigateState:r})}};return window.history.pushState=a(!1),window.history.replaceState=a(!0),window.history.go=i,window.history.back=()=>i(-1),window.history.forward=()=>i(1),{navigate:e=>{let{path:t,replace:r,state:s}=e;r?o(s,"",t):n(s,"",t)},history:i,init:e=>{o(e,"")},subscribe:e=>{window.addEventListener("popstate",(t=>{let{state:r}=t;e({path:window.location.pathname+window.location.search+window.location.hash,state:r})}))}}})({onNavigate:e=>{let{url:t,replace:r,navigateState:n}=e;this.listener({url:t,replace:r,navigateState:n})}})}init(e){var t;this.currentState=E(null===(t=window.history)||void 0===t?void 0:t.state)?window.history.state:b(e),this.currentIndex=this.currentState.index,this.historyWrapper.init(this.currentState),this.historyWrapper.subscribe((async e=>{let{path:t,state:r}=e;var n,o;try{let e,o;if(E(r)){const{key:t,type:n}=this.currentState,{key:s,type:i}=r;this.currentState=r,o=r.navigateState,e=s!==t||"updateCurrentRoute"!==i&&"updateCurrentRoute"!==n?"navigate":"updateCurrentRoute"}else this.currentIndex=0;await this.listener({type:e,history:!0,url:t,navigateState:o}),null===(n=this.goPromiseResolve)||void 0===n||n.call(this)}catch(e){null===(o=this.goPromiseReject)||void 0===o||o.call(this,e)}}))}save(e){const{replace:t,url:r}=e;t||this.currentIndex++,this.currentState=b(e,this.currentState,this.currentIndex),this.historyWrapper.navigate({path:r.path,replace:t,state:this.currentState})}go(e,t){var r;if(this.currentIndex<1){if(null==t?void 0:t.historyFallback)return this.listener({url:t.historyFallback,type:"navigate",history:!1,replace:t.replace});const e=null===(r=this.tree)||void 0===r?void 0:r.getHistoryFallback(window.location.pathname);if(e)return this.listener({url:e.actualPath,type:"navigate",history:!1})}this.currentIndex+=e;const n=new Promise(((e,t)=>{this.goPromiseResolve=e,this.goPromiseReject=t}));return this.historyWrapper.history(e),n}}class w extends f{constructor(e){super(e),this.fullRehydrationInProcess=null,this.history=new R,this.history.listen((async e=>{let{type:t,url:r,navigateState:n,replace:o,history:s}=e;var i;const a=this.getCurrentUrl(),{pathname:u,query:c,hash:l}=this.resolveUrl({url:r}),d=(a?a.pathname:window.location.pathname)===u;if("updateCurrentRoute"!==t&&(t||!d)||a)if("updateCurrentRoute"===t||!t&&d){const e=null===(i=this.tree)||void 0===i?void 0:i.getRoute(u);await this.internalUpdateCurrentRoute({params:null==e?void 0:e.params,query:c,hash:l,replace:o,navigateState:n},{history:s})}else await this.internalNavigate({url:r,replace:o,navigateState:n},{history:s});else o?window.history.__originalHistory.replaceState(n,"",r):window.history.__originalHistory.pushState(n,"",r)}))}async rehydrate(e){this.fullRehydrationInProcess=!e.to,h.debug({event:"rehydrate",navigation:e});const t=(0,s.Qc)(window.location.href);if(this.currentNavigation=Object.assign({},e,{type:"navigate",url:t}),this.lastNavigation=this.currentNavigation,this.fullRehydrationInProcess){await this.runHooks("beforeResolve",this.currentNavigation);const e=this.resolveRoute({url:t},{wildcard:!0}),r=null==e?void 0:e.redirect;if(this.currentNavigation.to=e,r)return this.redirect(this.currentNavigation,(0,v.ub)(r))}await this.runGuards(this.currentNavigation),this.history.init(this.currentNavigation),this.fullRehydrationInProcess&&this.runSyncHooks("change",this.currentNavigation),this.currentNavigation=null,this.fullRehydrationInProcess||this.addRoute({name:e.to.name,path:e.to.path,config:e.to.config,alias:t.pathname}),this.fullRehydrationInProcess=null}resolveRoute(){const{url:e}=arguments.length<=0?void 0:arguments[0];if(!e||(0,v.EE)(e))return super.resolveRoute(...arguments)}async notfound(e){var t,r;await super.notfound(e);const n=null!==(r=null===(t=e.fromUrl)||void 0===t?void 0:t.href)&&void 0!==r?r:window.location.href,o=e.url.href;if(e.from&&!e.to||n!==o)e.replace?window.location.replace(o):window.location.assign(o);else if(this.onBlock)return this.onBlock(e);return new Promise((()=>{}))}async block(e){return this.notfound(e)}async redirect(e,t){return await super.redirect(e,t),this.fullRehydrationInProcess?(window.location.replace(t.url),new Promise((()=>{}))):this.internalNavigate(Object.assign({},t,{replace:t.replace||e.replace}),{redirect:!0})}}var S=r(15434),_=r.n(S),N=r(44831),C=r.n(N),k=r(97939),T=r.n(k),O=r(26845);const A=e=>({route:e,children:Object.create(null),parameters:[]}),I=(e,t,r)=>Object.assign({},e,{actualPath:t,params:null!=r?r:{}});class M{constructor(e){this.tree=A(),_()((e=>this.addRoute(e)),e)}addRoute(e){const t=(0,l.am)(e.path);let r=this.tree;for(let n=0;n<t.length;n++){const o=t[n],s=(0,l.Qc)(o);if(1===s.type)return void(r.historyFallbackRoute=e);if(2===s.type)return void(r.wildcardRoute=e);if(3===s.type){const{paramName:e,regexp:t,optional:n}=s,i=C()((e=>e.key===o),r.parameters);if(i)r=i.tree;else{const s={key:o,paramName:e,regexp:t,optional:n,tree:A()};if(t&&!n){const e=T()((e=>!e.regexp),r.parameters);r.parameters.splice(e,0,s)}else r.parameters.push(s);r=s.tree}}else r.children[o]||(r.children[o]=A()),r=r.children[o]}r.route=e}getRoute(e){return this.findRoute(e,"route")}getWildcard(e){return this.findRoute(e,"wildcardRoute")}getHistoryFallback(e){const t=this.findRoute(e,"historyFallbackRoute");return t&&Object.assign({},t,{actualPath:t.path.replace(O.xQ,"")||"/"})}findRoute(e,t){const r="route"===t,n=(0,l.am)(e),o=[[this.tree,0]];for(;o.length;){const[s,i,a]=o.pop(),{children:u,parameters:c}=s;let l=!1;if(i>=n.length){if(s[t])return I(s[t],e,a);l=!0}!r&&s[t]&&o.push([s,n.length,a]);const d=n[i],p=u[d];for(const e of c){const{optional:t,tree:r}=e;t&&o.push([r,i,a])}if(!l){for(let e=c.length-1;e>=0;e--){const t=c[e],{paramName:r,tree:n,regexp:s}=t,u=null==s?void 0:s.exec(d),l=s?null==u?void 0:u[1]:d;l&&o.push([n,i+1,Object.assign({},a,{[r]:l})])}p&&o.push([p,i+1,a])}}}}const x="_t_view_transitions";var L=r(56873),P=r(80772),V=r(37621),D=r(82571),F=r(71533),j=r(14908),U=r(30353),B=r.n(U),J=r(82342),H=r(16254),q=r(83005),G=r(80858);const W=[(0,o.J)({provide:L.sU,multi:!0,useFactory:e=>{let{bundleManager:t,logger:r,responseManager:n,pageRegistry:o}=e;const s=r("route:load-bundles");return async e=>{let{to:r}=e;s.debug({event:"load-bundle",route:r});const{bundle:i,pageComponent:a}=r.config;if(!t.has(i,a))return s.info({event:"load-bundle-not-found",bundle:i,pageComponent:a}),n.setStatus(404),!1;try{await o.resolve(r)}catch(e){return s.error({event:"load-bundle-failed",error:e}),!1}}},deps:{logger:J.Fp,bundleManager:q.g,responseManager:G.r,pageRegistry:L._Q}}),(0,o.J)({provide:L.sU,multi:!0,useFactory:e=>{let{responseManager:t,logger:r}=e;const n=r("route:guard-check-error");return async()=>{if(t.getStatus()>=500)return n.error({event:"status-is-error",status:t.getStatus()}),!1}},deps:{logger:J.Fp,responseManager:G.r}})];var Y=r(49076);const K=[{provide:H.p$,multi:!0,useFactory:e=>{let{context:t}=e;return e=>{t.dispatch((0,j.L$)(e))}},deps:{context:Y.l}}];var Q=r(8479),Z=r(56003),z=r(79436),$=r.n(z),X=r(63119),ee=r.n(X),te=r(63609),re=r.n(te),ne=r(90130),oe=r(44121),se=r(86949),ie=r(70872);const ae=e=>{let{router:t,children:r,serverState:n}=e;const o=(0,oe.useMemo)((()=>t.getCurrentRoute()),[t]),s=(0,oe.useMemo)((()=>t.getCurrentUrl()),[t]),i=(0,oe.useCallback)((e=>t.registerSyncHook("change",e)),[t]),a=(0,se.useSyncExternalStore)(i,(()=>{var e,r;return null!==(r=null===(e=t.getLastRoute)||void 0===e?void 0:e.call(t))&&void 0!==r?r:o}),n?()=>n.route:()=>{var e,r;return null!==(r=null===(e=t.getLastRoute)||void 0===e?void 0:e.call(t))&&void 0!==r?r:o}),u=(0,se.useSyncExternalStore)(i,(()=>{var e,r;return null!==(r=null===(e=t.getLastUrl)||void 0===e?void 0:e.call(t))&&void 0!==r?r:s}),n?()=>n.url:()=>{var e,r;return null!==(r=null===(e=t.getLastUrl)||void 0===e?void 0:e.call(t))&&void 0!==r?r:s});return(0,ne.jsx)(ie._q.Provider,{value:t,children:(0,ne.jsx)(ie.Xn.Provider,{value:a,children:(0,ne.jsx)(ie.qs.Provider,{value:u,children:r})})})};ae.displayName="TinkoffRouterProvider";const ue=ae;var ce=r(30988),le=r(42282),de=r.n(le),pe=r(49103),he=r.n(pe),ge=r(42549);const ve=[(0,o.J)({provide:H.Ct,useFactory:e=>{let{transformers:t}=e;return t&&0!==t.length?ee()(...B()(t)):$()},deps:{transformers:{token:L.S3,optional:!0}}}),(0,o.J)({provide:L.S3,multi:!0,useValue:e=>{const t=Object.assign({bundle:"mainDefault",pageComponent:"pageDefault"},e.config);return Object.assign({},e,{config:t})}}),(0,o.J)({provide:L.S3,multi:!0,useValue:e=>Object.assign({},e,{path:re()(/\/?$/,"/",e.path)})}),(0,o.J)({provide:Q.EXTEND_RENDER,multi:!0,useFactory:e=>{let{router:t}=e;const r={route:t.getCurrentRoute(),url:t.getCurrentUrl()};return e=>(0,ne.jsx)(ue,{router:t,serverState:r,children:e})},deps:{router:L.l1}}),(0,o.J)({provide:L.Y9,useClass:class{constructor(e){let{router:t,componentRegistry:r}=e;this.router=t,this.componentRegistry=r}getCurrentRoute(){return this.router.getCurrentRoute()}getCurrentUrl(){return this.router.getCurrentUrl()}getConfig(e){var t;return void 0===e&&(e=this.getCurrentRoute()),null!==(t=null==e?void 0:e.config)&&void 0!==t?t:{}}getContent(e){var t;return null!==(t=this.getConfig(e).content)&&void 0!==t?t:{}}getMeta(e){var t;return null!==(t=this.getConfig(e).meta)&&void 0!==t?t:{}}navigate(e){return this.router.navigate(e)}updateCurrentRoute(e){return this.router.updateCurrentRoute(e)}back(e){return this.router.back(e)}forward(){return this.router.forward()}go(e,t){return this.router.go(e,t)}addComponent(e,t,r){const n=this.getComponentsGroupName(r);return this.componentRegistry.add(e,t,n)}getComponent(e,t){const r=this.getComponentsGroupName(t);return this.componentRegistry.get(e,r)}resolveComponentFromConfig(e,t){var r;const n=e+"Component",o=e+"Default",s=null!==(r=this.getConfig(t)[n])&&void 0!==r?r:o;return this.getComponent(s,t)||this.getComponent(o,t)}getComponentsGroupName(e){const{bundle:t,pageComponent:r}=this.getConfig(e);return(0,ce.lN)(r)?r:t}},deps:{router:L.l1,componentRegistry:Z.K}}),(0,o.J)({provide:L._Q,useClass:class{constructor(e){let{bundleManager:t,pageService:r,componentRegistry:n,actionRegistry:o,dispatcher:s,dispatcherContext:i}=e;this.bundleManager=t,this.pageService=r,this.componentRegistry=n,this.actionRegistry=o,this.dispatcher=s,this.dispatcherContext=i}async resolve(e){var t;const{bundle:r,pageComponent:n}=this.pageService.getConfig(e),o=this.pageService.resolveComponentFromConfig("nestedLayout",e),s=await this.bundleManager.get(r,n);await this.registerComponent(r,s);const i=null===(t=s.components)||void 0===t?void 0:t[n],a=[];i&&a.push(this.registerComponent(n,i)),o&&a.push(this.registerComponent(n,this.pageService.resolveComponentFromConfig("nestedLayout"))),await Promise.all(a)}async registerComponent(e,t){"load"in t&&await(0,ge.BU)(t),"components"in t&&c()(t.components)&&he()(((t,r)=>{this.componentRegistry.add(r,t,e)}),t.components),"actions"in t&&de()(t.actions)&&this.actionRegistry.add(e,t.actions),"reducers"in t&&de()(t.reducers)&&t.reducers.forEach((e=>{this.dispatcher.registerStore(e),this.dispatcherContext.getStore(e)}))}},deps:{bundleManager:q.g,pageService:L.Y9,componentRegistry:Z.K,actionRegistry:F.R9,dispatcher:V.qb,dispatcherContext:V.jm}})],fe=[(0,ce.oJ)()&&(0,o.J)({provide:L.Dk,multi:!0,useFactory:e=>{let{logger:t}=e;const r=t("file-system-pages:route"),n=Object.keys((0,ce.d3)()).map(ce.nW),o=(0,ce.kC)();return r.debug({event:"create static routes from file-system pages",routes:n}),o.concat(n)},deps:{logger:J.Fp}})].filter(Boolean),me=[...W,...K,...ve,...fe,(0,o.J)({provide:L.l1,useFactory:e=>{let{RouterClass:t,routes:r,routeTransform:n,routeResolve:o,additionalParameters:s}=e;const i=new t(Object.assign({},s,{trailingSlash:!0,mergeSlashes:!0,enableViewTransitions:!1,routes:B()(null!=r?r:[]).map(n)}));return o&&i.registerHook("beforeResolve",(async e=>{var t;const r=i.resolve(e.url.href);if(!r||(null===(t=r.config)||void 0===t?void 0:t.forceRouteResolve)){const t=await o(e);t&&i.addRoute(n(t))}})),i},deps:{RouterClass:H.U5,additionalParameters:{token:H.FZ,optional:!0},routes:{token:L.Dk,optional:!0},routeTransform:H.Ct,routeResolve:{token:L.TL,optional:!0}}}),(0,o.J)({provide:P.Bi.customerStart,multi:!0,useFactory:e=>{let{router:t,guards:r,onChange:n,beforeResolve:o,beforeNavigate:s,afterNavigate:i,beforeUpdateCurrent:a,afterUpdateCurrent:u}=e;return function(){B()(null!=r?r:[]).forEach((e=>t.registerGuard(e))),B()(null!=n?n:[]).forEach((e=>t.registerSyncHook("change",e))),B()(null!=o?o:[]).forEach((e=>t.registerHook("beforeResolve",e))),B()(null!=s?s:[]).forEach((e=>t.registerHook("beforeNavigate",e))),B()(null!=i?i:[]).forEach((e=>t.registerHook("afterNavigate",e))),B()(null!=a?a:[]).forEach((e=>t.registerHook("beforeUpdateCurrent",e))),B()(null!=u?u:[]).forEach((e=>t.registerHook("afterUpdateCurrent",e)))}},deps:{router:L.l1,guards:{token:L.sU,optional:!0},onChange:{token:H.p$,optional:!0},beforeResolve:{token:H.Yv,optional:!0},beforeNavigate:{token:H.rZ,optional:!0},afterNavigate:{token:H.jB,optional:!0},beforeUpdateCurrent:{token:H.vR,optional:!0},afterUpdateCurrent:{token:H.P$,optional:!0}}}),(0,o.J)({provide:P.Bi.init,multi:!0,useFactory:e=>{let{logger:t}=e;return function(){g(t("route:router"))}},deps:{logger:J.Fp}}),(0,o.J)({provide:L.$d,useValue:"after"}),(0,o.J)({provide:V.Ym,multi:!0,useValue:j.sH})];var ye=r(19608),Ee=r(46478),be=r(57038),Re=r(59999),we=r(75633);const Se=(0,Re.V3)(),_e=(0,Re.V3)(),Ne=[(0,o.J)({provide:Se,useValue:new Set}),(0,o.J)({provide:_e,useFactory:()=>{const e=(0,we.R)();let t=Promise.resolve();return{add(r){return t=t.then((()=>new Promise(((t,n)=>{e((()=>{r().then(t).catch(n)}))})))),t}}}}),(0,o.J)({provide:L.fw,useFactory:e=>{let{router:t,routeTransform:r,routeResolve:n,logger:o,prefetchedLinksCache:i,prefetchedLinksQueue:a,pageRegistry:u,prefetchHandlers:c}=e;const l=o("link-prefetch-manager");return{prefetch:e=>a.add((()=>(async e=>{if(i.has(e))return;i.add(e),l.info({event:"prefetch-route-init",url:e});let o=t.resolve(e);if(!o&&n){const i=(0,s.Qc)(e);o=await n({url:i,type:"navigate"}),o&&(o=r(o),t.addRoute(o))}if(o)try{await u.resolve(o),await Promise.all(c.map((e=>e(o)))),l.info({event:"prefetch-route-success",url:e})}catch(t){l.warn({event:"prefetch-fail",url:e,error:t})}else l.info({event:"prefetch-route-not-found",url:e})})(e)))}},deps:{router:L.l1,routeTransform:H.Ct,routeResolve:(0,Re.jt)(L.TL),logger:J.Fp,prefetchedLinksCache:Se,prefetchedLinksQueue:_e,pageRegistry:L._Q,prefetchHandlers:(0,Re.jt)(L.Dv)}})],Ce=[...Ne,{provide:H.FZ,useFactory:e=>{let{store:t}=e;return{onBlock:async e=>{var r,n,o;let s=new ye.W({message:"Url "+(null===(r=e.to)||void 0===r?void 0:r.actualPath)+" is blocked",prevUrl:null!==(o=null===(n=e.fromUrl)||void 0===n?void 0:n.href)&&void 0!==o?o:window.location.href,nextUrl:e.url.href});s=(0,Ee.lV)(s),t.dispatch((0,be.IL)(s))}}},deps:{store:V.kR}}];var ke=r(7605),Te=r.n(ke),Oe=r(33926);const Ae=["message","httpStatus"];class Ie extends Error{constructor(e){let{message:t="Http Error",httpStatus:r}=e,n=(0,Oe.Z)(e,Ae);super(t),this.name=Ie.errorName,this.httpStatus=r,Object.assign(this,n)}}Ie.errorName="HttpError";const Me=["message"];class xe extends Ie{constructor(e){let t=void 0===e?{}:e,{message:r="Not Found"}=t,n=(0,Oe.Z)(t,Me);super({message:r,httpStatus:404}),this.name=xe.errorName,Object.assign(this,n)}}xe.errorName="NotFoundError";const Le=["message","nextUrl","httpStatus"];class Pe extends Ie{constructor(e){let{message:t="Redirect Found",nextUrl:r,httpStatus:n=307}=e,o=(0,Oe.Z)(e,Le);super({message:t,httpStatus:n}),this.name=Pe.errorName,this.nextUrl=r,this.httpStatus=n,Object.assign(this,o)}}Pe.errorName="RedirectFoundError";const Ve=e=>e.name===Pe.errorName;var De=r(59576);const Fe=e=>{if(e.name===xe.errorName||Ve(e))return!0},je=e=>{let{store:t,router:r,actionRegistry:n,actionPageRunner:o}=e;const s=r.getCurrentRoute(),{config:{bundle:i,pageComponent:a}={}}=s;if(!i||!a)throw new Error("bundle and pageComponent should be defined, but got "+s);return Te()([...n.getGlobal()||[],...n.get(i)||[],...n.get(a)||[]])},Ue=e=>function(){const t=je(e);return e.actionPageRunner.runActions(t,Fe).catch((t=>{if(Ve(t))return e.router.navigate({url:t.nextUrl,replace:!0,code:t.httpStatus});throw t.error||t}))},Be=[...Ce,...me,(0,o.J)({provide:P.Bi.customerStart,multi:!0,useFactory:e=>{let{router:t,store:r,envManager:n}=e;return async function(){if("true"===n.get("TRAMVAI_FORCE_CLIENT_SIDE_RENDERING"))return t.rehydrate({});const e=r.getState(j.sH).currentRoute;return t.rehydrate({to:e})}},deps:{router:L.l1,store:V.kR,envManager:D.vC}}),(0,o.J)({provide:P.Bi.clear,multi:!0,useFactory:e=>{let{router:t,store:r}=e;return function(){return r.getState().router.currentUrl.href!==window.location.href&&r.dispatch((0,j.Qk)(t.getCurrentUrl())),t.start()}},deps:{router:L.l1,store:V.kR}}),(0,o.J)({provide:P.Bi.clear,multi:!0,useFactory:e=>Ue(e),deps:{store:V.kR,router:L.l1,actionRegistry:F.R9,actionPageRunner:F.FM}})];var Je=r(16842);const He=["spaMode"],qe=["spaMode"],Ge=[{provide:H.rZ,multi:!0,useFactory:e=>{let{commandLineRunner:t,di:r}=e;return async e=>{let{key:n}=e;await t.run("client","spa",[],r,n)}},deps:{di:Je.Z,commandLineRunner:P.S9}},{provide:H.jB,multi:!0,useFactory:e=>{let{commandLineRunner:t,di:r}=e;return async e=>{let{key:n}=e;await t.run("client","afterSpa",[],r,n)}},deps:{di:Je.Z,commandLineRunner:P.S9}},{provide:P.Bi.spaTransition,multi:!0,useFactory:e=>{let{spaMode:t}=e,r=(0,Oe.Z)(e,He);return()=>{if((e=>{je(e).forEach((t=>{const r=t[De.d],n=null==r?void 0:r.deferred,o=e.deferredActionsMap.get(null==r?void 0:r.name);n&&o&&e.actionExecution.canExecute(t)&&o.reset()}))})(r),"after"!==t)return Ue(r)()}},deps:{store:V.kR,router:L.l1,actionRegistry:F.R9,actionPageRunner:F.FM,spaMode:L.$d,deferredActionsMap:F.m1,actionExecution:F.R$}},{provide:P.Bi.afterSpaTransition,multi:!0,useFactory:e=>{let{spaMode:t}=e,r=(0,Oe.Z)(e,qe);return"after"===t?Ue(r):p()},deps:{store:V.kR,router:L.l1,actionRegistry:F.R9,actionPageRunner:F.FM,spaMode:L.$d}}],We=function(e,t){return void 0===t&&(t={}),[{provide:L.Dk,multi:!0,useValue:e},t.spaActionsMode&&{provide:L.$d,useValue:t.spaActionsMode}].filter(Boolean)},Ye=(0,n.J)({name:"SpaRouterModule",providers:[...Be,...Ge,(0,o.J)({provide:H.U5,useValue:class extends w{constructor(e){super(e),this.tree=new M(e.routes),this.history.setTree(this.tree),this.viewTransitionsEnabled&&(this.restoreAppliedViewTransitions(),window.addEventListener("pagehide",(()=>{this.saveAppliedViewTransitions()})))}async rehydrate(e){return this.resolveIfDelayFound(super.rehydrate(e))}async start(){if(await super.start(),this.delayedNavigation){const{delayedNavigation:e}=this;return this.delayedNavigation=null,this.flattenDelayedNavigation(e)}}async run(e){const t=Object.assign({},e);if(this.viewTransitionsEnabled&&(t.viewTransition=this.shouldApplyViewTransition(e)),this.started)return this.currentNavigation?this.delayNavigation(t):(this.delayedNavigation&&(h.info({event:"delay-navigation-drop",delayedNavigation:this.delayedNavigation,navigation:t}),this.delayedNavigation=null),this.flattenDelayedNavigation(t));this.delayNavigation(t)}delayNavigation(e){return this.delayedNavigation=e,h.info({event:"delay-navigation",navigation:e}),this.delayedPromise||(this.delayedPromise=new Promise(((e,t)=>{this.delayedResolve=e,this.delayedReject=t}))),this.delayedPromise}commitNavigation(e){if(!e.cancelled&&!e.skipped)return super.commitNavigation(e);h.debug({event:"delay-ignore-commit",navigation:e})}async runGuards(e){if(!e.cancelled)return super.runGuards(e);h.debug({event:"delay-ignore-guards",navigation:e})}async runHooks(e,t){if(t.cancelled&&this.lastNavigation!==t)h.debug({event:"delay-ignore-hooks",navigation:t});else try{await super.runHooks(e,t)}catch(e){return this.notfound(t)}}async resolveIfDelayFound(e){let t;const r=setInterval((()=>{var e;this.delayedNavigation&&("navigate"===this.delayedNavigation.type||this.delayedNavigation.type===(null===(e=this.currentNavigation)||void 0===e?void 0:e.type)?(h.info({event:"delay-navigation-found",navigation:this.delayedNavigation}),this.currentNavigation&&(this.currentNavigation.cancelled=!0,this.currentNavigation=null),t()):this.delayedResolve())}),50);await Promise.race([e,new Promise((e=>{t=e}))]),clearInterval(r),t()}async flattenDelayedNavigation(e){const t=async e=>{if(await this.resolveIfDelayFound(super.run(e)),this.delayedNavigation){const{delayedNavigation:e}=this;return h.info({event:"delay-navigation-run",navigation:e}),this.delayedNavigation=null,t(e)}};return t(e).then((()=>{var e;null===(e=this.delayedResolve)||void 0===e||e.call(this)}),(e=>{var t;null===(t=this.delayedReject)||void 0===t||t.call(this,e)})).finally((()=>{this.delayedPromise=null,this.delayedResolve=null,this.delayedReject=null}))}shouldApplyViewTransition(e){var t,r;const n=e.from.actualPath,o=void 0!==e.to.redirect?null===(t=this.resolve(e.to.redirect))||void 0===t?void 0:t.actualPath:null===(r=e.to)||void 0===r?void 0:r.actualPath;if(e.viewTransition){const e=this.appliedViewTransitions.get(n);return this.appliedViewTransitions.get(n)?e.add(o):this.appliedViewTransitions.set(n,new Set([o])),!0}const s=this.appliedViewTransitions.get(n);return!(void 0===s||!s.has(o))||this.appliedViewTransitions.has(o)}restoreAppliedViewTransitions(){try{const e=sessionStorage.getItem(x);if(null!==e){const t=JSON.parse(e);return void(this.appliedViewTransitions=new Map(Object.entries(t).map((e=>{let[t,r]=e;return[t,new Set(r)]}))))}this.appliedViewTransitions=new Map}catch(e){this.appliedViewTransitions=new Map}}saveAppliedViewTransitions(){if(this.appliedViewTransitions.size>0)try{const e={};for(const[t,r]of this.appliedViewTransitions)e[t]=[...r];sessionStorage.setItem(x,JSON.stringify(e))}catch(e){}}cancel(){if(!this.isNavigating())return;h.debug({event:"cancelled",navigation:this.currentNavigation});const e=this.currentNavigation;return this.currentNavigation.skipped=!0,this.currentNavigation=null,e}}}),(0,o.J)({provide:L.aP,useValue:"spa"})],extend:{forRoot:We}});var Ke=r(29772),Qe=r(82912),Ze=r(20076),ze=r(92946),$e=r(33464),Xe=r(60028),et=r.n(Xe);const tt={mobile:!0,wearable:!0};var rt=r(65165),nt=r.n(rt),ot=r(147),st=r.n(ot);let it=nt();try{it=r(60531).XH}catch(e){}const at=(e,t,r)=>{let{url:n,domain:o,appId:s}=e;if(!c()(t))return null;if("redirectUrl"in t)return{name:"page-enrichment-redirect",path:n.pathname,redirect:{url:re()(new RegExp("^https://"+o),"",t.redirectUrl),code:+t.redirectCode,preserveQuery:!0}};if("page"in t){const{id:e,pageId:n,appId:o,name:i,properties:a,url:u,meta:c,content:l}=t.page;return r.inBrowser&&o&&(r.strictAppId||"platform"!==o)&&o!==s&&"m"+o!==s?null:{name:i,path:u,config:Object.assign({id:e,pageId:n},a,{meta:c,content:l})}}return null},ut={timeout:5e3,deduplicateCache:!0};var ct=r(6073),lt=r.n(ct);const dt=(0,Re.V3)("__tinkoffRouterDeprecatedToken",{multi:!0}),pt=[(0,o.J)({provide:Ze.DG,useFactory:e=>{let{appInfo:t,userAgent:r}=e;return()=>{const{appName:e}=t;return r&&(n=r,tt[et()(["device","type"],n)])?"m"+e:e;var n}},deps:{appInfo:Ke.Qo,userAgent:{token:$e.N,optional:!0}}}),(0,o.J)({provide:Ze.Q6,useFactory:e=>{let{appInfo:t}=e;return()=>[t.appName,"m"+t.appName]},deps:{appInfo:Ke.Qo}}),(0,o.J)({provide:Ze.xO,useFactory:e=>{let{requestManager:t,responseManager:r,envManager:n,enableAutoDomainResolve:o,store:s}=e;return async()=>{var e,i;const a=n.get("DOMAIN_ALIAS");if(a)return a;const u=null!==(e=s.getState().featureToggle)&&void 0!==e?e:{},c=it("admin/default_domain_www",u)?"www.tinkoff.ru":"tinkoff.ru",l=t.getHost(),d=/^localhost(?::\d+)$/.test(l);var p;const h=null!==(i=(p=n.get("EXTERNAL_HOSTNAME_MAP")||"",st()(p.split(",").map((e=>e.split("=")))))[l])&&void 0!==i?i:d||!o?c:l;return r.setHeader("x-tramvai-resolved-external-host",l+"="+h),h}},deps:{requestManager:Qe.G,responseManager:G.r,envManager:D.vC,enableAutoDomainResolve:Ze.vi,store:V.kR}}),(0,o.J)({provide:Ze.vi,useValue:!1}),(0,o.J)({provide:L.TL,useFactory:e=>{let{logger:t,responseManager:r,pageEnrichment:n,domainResolve:o,appIdResolve:s,routeResolveExtend:i,routesFallback:a,deprecatedTokens:u,envManager:c,criticalRoutes:l}=e;if(!n)throw new Error("pageEnrichment is not defined, have you forgot to add @tramvai/module-api-clients?");const d=t("route:admin:route-resolve");return async e=>{let{url:t}=e;var r,u;let p;d.debug({event:"load",url:t});let h=async e=>{p=e;const{domain:t,appId:r,url:{pathname:o},requestOptions:s}=e,{payload:i,headers:a,status:u}=await n.getResponse({appId:r,url:"https://"+t+o},Object.assign({silent:!0},s));return{status:u,headers:a,payload:i,route:at(p,i,{inBrowser:!0,strictAppId:"true"===c.get("TRAMVAI_ROUTE_STRICT_APP_ID")})}};i&&i.length&&(h=ee()(...i)(h));const[g,v]=await Promise.all([o(),s()]);try{const{route:e,status:n}=await h({domain:g,appId:v,url:t,shouldSetFallback:!0,requestOptions:ut});d.debug({event:"loaded",route:e});const o=a&&p&&a.get(p.url.pathname,{appId:null==p?void 0:p.appId});if(!e&&(404===n||400===n)&&o&&(B()(l).includes(t.pathname)||(null===(r=o.config)||void 0===r?void 0:r.useFallbackCacheIfNotFound)))throw new Error("404 Not Found для критичного роута - "+t+", возможны проблемы на стороне web-gateway.\nЕсли это ожидаемое поведение и страница действительно удалена, необходимо убрать роут из списка критичных.");return a&&e&&(null==p?void 0:p.shouldSetFallback)&&(d.debug({event:"fallback-set",request:p}),a.set(e,{appId:null!==(u=null==p?void 0:p.appId)&&void 0!==u?u:v})),e}catch(e){const t=!!a,r=a&&p&&a.has(p.url.pathname,{appId:null==p?void 0:p.appId});if(d.error({event:"load-failed",message:"Ошибка загрузки роута "+p.url+" с web-gateway"+(r?", будет использован fallback кэш":"")+'.\nПричина ошибки будет указана в параметре "error", основные кейсы:\n- 500 ответы при падениях сервиса web-gateway\n- таймауты при проблемах с сетью\n- 404 ответы для критичных роутов',error:e,request:p,hasFallback:r}),r)return d.debug({event:"fallback-get",request:p}),a.get(p.url.pathname,{appId:null==p?void 0:p.appId});throw t&&d.error({event:"load-error",message:"Не найден fallback кэш после ошибки загрузки роута"+(p?" "+p.url:"")+" с web-gateway, нет возможности отрисовать страницу",error:e}),e}}},deps:{logger:J.Fp,responseManager:G.r,pageEnrichment:{token:ze.xs,optional:!0},domainResolve:Ze.xO,appIdResolve:Ze.DG,envManager:D.vC,routeResolveExtend:{token:Ze.eZ,optional:!0},routesFallback:{token:Ze.c3,optional:!0},deprecatedTokens:{token:dt,optional:!0},criticalRoutes:{token:Ze.LM,optional:!0}}}),(0,o.J)({provide:Ze.eZ,multi:!0,useFactory:e=>{let{pageEnrichment:t,envManager:r}=e;return e=>async n=>{const{url:o,domain:s,appId:i}=n;if(o.query.previewToken){const e=await t.getPreview({url:"https://"+s+o.pathname,appId:i,previewToken:o.query.previewToken},{cache:!1});return Object.assign({},e,{route:at(n,e.payload,{inBrowser:!0,strictAppId:"true"===r.get("TRAMVAI_ROUTE_STRICT_APP_ID")})})}return e(n)}},deps:{pageEnrichment:{token:ze.xs,optional:!0},envManager:D.vC}}),(0,o.J)({provide:L.S3,multi:!0,useFactory:e=>{let{logger:t}=e;const r=t("file-system-pages:route:admin");return e=>{var t;if((0,ce.oJ)()&&e&&e.path&&e.config&&(e.config.migrateToFileSystemPageComponent||!e.config.pageComponent&&!e.config.bundle)){const n=(0,ce.nF)(e.path),o=(0,ce.rI)(n),s=null!==(t=e.config.pageComponent)&&void 0!==t?t:"pageDefault",i=o?n:s;return!o&&e.config.migrateToFileSystemPageComponent?r.error({event:"failed to resolve file-system page component",pageComponent:{expected:n,resolved:i},route:e}):r.debug({event:"resolve file-system page component",pageComponent:{expected:n,resolved:i},route:e}),Object.assign({},e,{config:Object.assign({},e.config,{pageComponent:i})})}return e}},deps:{logger:J.Fp}}),(0,o.J)({provide:L.S3,multi:!0,useFactory:e=>{let{routeMigrations:t}=e;const r=B()(null!=t?t:[]);return e=>{const{config:t}=e;if(!t)return e;for(const{from:n,to:o}of r)if(lt()(((e,r)=>t[r]===e),n))return Object.assign({},e,{config:Object.assign({},t,o)});return e}},deps:{routeMigrations:{token:Ze.de,optional:!0}}})],ht=(0,n.J)({name:"TinkoffSpaRouterModule",imports:[Ye],providers:pt,extend:{forRoot:We}})},34059:function(e,t,r){"use strict";r.d(t,{WA:function(){return g}});var n=r(80283),o=r(97570),s=r(29772),i=r(59999),a=r(80772),u=r(82571),c=r(37621),l=r(82342),d=r(32951),p=r(21789),h=r(92105);const g=(0,n.Y)({providers:[(0,o.J)({provide:u.sQ,multi:!0,useValue:[{key:"APP_VERSION",optional:!0,dehydrate:!0},{key:"STATIST_CLIENT_URL",optional:!0,dehydrate:!0}]}),(0,o.J)({provide:p.E,useFactory:e=>{let{appInfo:t,logger:r,envManager:n,enrich:o}=e;const s=((e,t)=>{var r;return{clientParameters:{client:e.appName,clientVersion:null!==(r=t.get("APP_VERSION"))&&void 0!==r?r:"1.0.0",ssoId:null},transportOptions:{endpointUrl:t.get("STATIST_CLIENT_URL")}}})(t,n),i=r({name:"statist:event",defaults:{remote:!0}});let a=new d.pM(s);return o&&(a=a.fork({enrich:o})),a.on("error",(e=>{0!==e.status&&i.error({event:"send-failed",error:e,status:e.status,response:e.response})})),a},deps:{appInfo:s.Qo,store:c.kR,logger:l.Fp,envManager:u.vC,enrich:(0,i.jt)(p.MS)}}),(0,o.J)({provide:p.se,useFactory:e=>{let{statistClient:t}=e;return t},deps:{statistClient:p.E}}),(0,o.J)({provide:p.Kf,useFactory:e=>{let{statistClient:t}=e;return t},deps:{statistClient:p.E}}),(0,o.J)({provide:p.nN,useValue:!0}),(0,o.J)({provide:a.Bi.init,useFactory:e=>{let{store:t,statistClient:r,trackAndUpdateSsoIdFlag:n}=e;return()=>{if(!n)return;const e=e=>{r.updateClientParameters({ssoId:e.ssoId||null})};t.subscribe(h.p,e),e(t.getState(h.p))}},deps:{store:c.kR,statistClient:p.E,trackAndUpdateSsoIdFlag:p.nN}})]})(class e{static forRoot(t){let{trackAndUpdateSsoId:r=!0,enrich:n}=t;const s=[];return s.push((0,o.J)({provide:p.nN,useValue:r})),n&&s.push((0,o.J)({provide:p.MS,useValue:n})),{mainModule:e,providers:s}}})},21789:function(e,t,r){"use strict";r.d(t,{E:function(){return o},Kf:function(){return i},MS:function(){return u},nN:function(){return a},se:function(){return s}});var n=r(59999);const o=(0,n.V3)("STATIST_API_CLIENT"),s=(0,n.V3)("STATIST_EVENT_API_CLIENT"),i=(0,n.V3)("STATIST_METRIC_API_CLIENT"),a=(0,n.V3)("TRACK_AND_UPDATE_SSO_ID_FLAG"),u=(0,n.V3)("STATIST_ENRICH")},8254:function(e,t,r){"use strict";r.d(t,{n0:function(){return s}});var n=r(87300),o=r.n(n);const s=e=>{const[t,r=""]=e.split(".");return t.slice(0,12)+o()(t.slice(12).length,"*")+"."+r}},23070:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(90130),o=r(30873),s=r(44121),i=r(12052),a=r(71358),u=r(19328),c=r(66629);function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var d=l(o),p=l(u);t.CrossAppNavigateLoaderWrapper=()=>e=>t=>((e,t)=>{const r=a.useDi(i.PUBSUB_TOKEN),[o,u]=s.useState(!1);return s.useEffect((()=>{const e=()=>u(!1);window.addEventListener("pageshow",e);const t=r.subscribe(c.NAVIGATE_WITH_HARD_RELOAD,(()=>{u(!0)}));return()=>{window.removeEventListener("pageshow",e),t()}}),[r]),n.jsx("div",{children:o?n.jsx("div",{className:""+p.default.crossAppNavigateLoader,children:n.jsx(d.default,{overlay:!0,semiTransparentBg:!1,fadeAnimation:"false",size:"xxl"})}):n.jsx(e,Object.assign({},t))})})(e,t)},66629:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NAVIGATE_WITH_HARD_RELOAD="NAVIGATE_WITH_HARD_RELOAD"},95221:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(80476),o=r(21526),s=r(8479),i=r(23070);t.SupCrossAppNavigateLoaderModule=class{},t.SupCrossAppNavigateLoaderModule=n.__decorate([o.Module({providers:[o.provide({provide:s.LAYOUT_OPTIONS,multi:!0,useFactory:()=>({wrappers:{layout:i.CrossAppNavigateLoaderWrapper()}})})]})],t.SupCrossAppNavigateLoaderModule)},20719:function(e,t,r){"use strict";r(95221);var n=r(66629);t.$l=n.NAVIGATE_WITH_HARD_RELOAD},67570:function(e,t,r){"use strict";r.d(t,{Bv:function(){return o},X9:function(){return v},Yw:function(){return c},eW:function(){return s},g3:function(){return d},j5:function(){return u},lb:function(){return g},nM:function(){return a},q2:function(){return l},qJ:function(){return h},qq:function(){return p},rF:function(){return i}});var n=r(59999);const o=(0,n.V3)("EVENTEA_TOKEN"),s=(0,n.V3)("EVENTEA_PROJECT_HANDLERS",{multi:!0}),i=(0,n.V3)("EVENTEA_ROUTING"),a=(0,n.V3)("EVENTEA_ERROR_HANDLERS"),u=(0,n.V3)("EVENTEA_DEFAULT_LOG_HANDLER"),c=(0,n.V3)("EVENTEA_STATIST_HANDLER"),l=(0,n.V3)("EVENTEA_DEFAULT_TRACKING_HANDLER"),d=(0,n.V3)("EVENTEA_TWT_DATA_HANDLER"),p=(0,n.V3)("EVENTEA_DEFAULT_EVENT_HANDLER",{multi:!0}),h=(0,n.V3)("EVENTEA_DEFAULT_DATA_HANDLER",{multi:!0}),g=(0,n.V3)("EVENTEA_CLIENT_LOADER_TIMEOUT"),v=(0,n.V3)("EVENTEA_PRELOAD_PROJECTS_SELECTOR")},20076:function(e,t,r){"use strict";r.d(t,{DG:function(){return o},LM:function(){return d},Q6:function(){return s},c3:function(){return c},de:function(){return u},eZ:function(){return a},vi:function(){return l},xO:function(){return i}});var n=r(59999);const o=(0,n.V3)("router appIdResolve"),s=(0,n.V3)("router allAppsIdsResolve"),i=(0,n.V3)("router domainResolve"),a=(0,n.V3)("router routeResolveExtend",{multi:!0}),u=(0,n.V3)("router configMigration",{multi:!0}),c=(0,n.V3)("router fallback"),l=(0,n.V3)("router enableAutoDomainResolve"),d=(0,n.V3)("router criticalRoutesList",{multi:!0})},82318:function(e,t,r){"use strict";r.d(t,{P:function(){return o}});var n=r(59576);function o(e){const t=Object.assign(e.fn,{[n.d]:e});return e.conditions||(e.conditions={}),t}},20745:function(e,t,r){"use strict";r.d(t,{H:function(){return o},J:function(){return s}});var n=r(59576);function o(e){var t;const r=(t,r,n)=>{const o=new AbortController;return e.fn.apply({executeAction:t.executeAction,dispatch:t.dispatch,getState:t.getState,actionType:"standalone",abortController:o,abortSignal:o.signal,deps:n},r)};return Object.defineProperty(r,"name",{value:e.name,writable:!0,enumerable:!0,configurable:!0}),Object.assign(r,Object.assign({},e,{name:e.name,tramvaiActionVersion:2,[n.d]:Object.assign({},e,{conditions:null!==(t=e.conditions)&&void 0!==t?t:{}})}))}function s(e){return"tramvaiActionVersion"in e&&2===e.tramvaiActionVersion}},71341:function(e,t,r){"use strict";r.d(t,{Z:function(){return p}});var n=r(68989),o=r.n(n),s=r(56274),i=r.n(s),a=r(52141),u=r.n(a);const c=(e,t)=>Array.isArray(e)&&Array.isArray(t)?o()(e,t):"object"==typeof e&&"object"==typeof t?i()(c,e,t):t,l=i()(c),d=e=>{if(!e||!e.length)return{};const t=e.map((e=>l(d(e.presets),u()(["presets"],e))));return 1===t.length?t[0]:l(...t)};function p(e){let t={};return e.presets&&(t=d(e.presets)),l(t,e)}},21533:function(e,t,r){"use strict";r.d(t,{g:function(){return p},r:function(){return h}});var n=r(67584),o=r(95738),s=r(50561),i=r(54499),a=r(56245),u=r(80283),c=r(29772),l=r(80772),d=r(82342);class p{constructor(e){let{name:t,modules:r=[],bundles:u={},actions:l=[],providers:d}=e;this.di=(0,o.f)(),this.modulesToResolve=new Set,this.walkOfProviders(function(e,t,r,o){return[{provide:c.Qo,scope:n.s.SINGLETON,useValue:{appName:e}},{provide:c.om,scope:n.s.SINGLETON,useValue:t},{provide:c.I7,scope:n.s.SINGLETON,useValue:r,multi:!0},{provide:c.mJ,scope:n.s.SINGLETON,useValue:o}]}(t,u,l,r)),(0,s.l)(r).forEach((e=>{const t=(0,i.s)(e);this.modulesToResolve.add((0,a.W)(e)?e.mainModule:e),this.walkOfProviders(t.providers)})),d&&this.walkOfProviders(d)}async initialization(e,t){void 0===t&&(t="init"),!window.__TRAMVAI_HTML_READY__&&window.__TRAMVAI_HTML_READY_PROMISE__&&await Promise.race([window.__TRAMVAI_HTML_READY_PROMISE__,new Promise((e=>{"complete"===document.readyState?e():document.addEventListener("readystatechange",(()=>{"complete"===document.readyState&&e()}))}))]);const r=this.di.get({token:d.Fp,optional:!0}),n=null==r?void 0:r("tramvai-core"),o=this.di.get({token:l.S9,optional:!0});if(!o)throw new Error("`COMMAND_LINE_RUNNER_TOKEN` is not defined, have you added `@tramvai/module-common` to your dependency list?");null==n||n.warn({event:"tramvai-app-init",message:"Initializing. Run CommandLineRunner."});const s=await o.run(e,t);return null==n||n.warn({event:"tramvai-app-init",message:"CommandLineRunner executed successfully. Resolving modules."}),this.resolveModules(),null==n||n.warn({event:"tramvai-app-init",message:"Modules resolved successfully. Tramvai App initialized"}),s}walkOfProviders(e){e.forEach((e=>{this.di.register(e)}))}resolveModules(){this.modulesToResolve.forEach((e=>{new e(this.resolveModuleDeps(e))}))}resolveModuleDeps(e){const{deps:t}=e[u.e];if(t)return this.di.getOfDeps(t)}}function h(e){let t;try{t=new p(e)}catch(e){throw e.appCreationError=!0,e}return t.initialization("client").then((()=>t)).catch((e=>{throw e instanceof Error&&(e.appCreationError=!0),e}))}},21526:function(e,t,r){"use strict";r.r(t),r.d(t,{ACTIONS_LIST_TOKEN:function(){return a.I7},ACTION_PARAMETERS:function(){return a.dV},APP_INFO_TOKEN:function(){return a.Qo},App:function(){return n.g},BUNDLE_LIST_TOKEN:function(){return a.om},COMMAND_LINES_TOKEN:function(){return a.PR},COMMAND_LINE_RUNNER_TOKEN:function(){return a.S9},DI_TOKEN:function(){return u.Z},Deferred:function(){return b},IS_DI_CHILD_CONTAINER_TOKEN:function(){return c.w},MODULES_LIST_TOKEN:function(){return a.mJ},MODULE_PARAMETERS:function(){return l.e},Module:function(){return l.Y},Scope:function(){return d.s},TAPABLE_HOOK_FACTORY_TOKEN:function(){return a.jk},commandLineListTokens:function(){return a.Bi},createAction:function(){return s.P},createApp:function(){return n.r},createBundle:function(){return o.Z},createToken:function(){return p.V3},declareAction:function(){return i.H},declareModule:function(){return h.J},getModuleParameters:function(){return g.s},isExtendedModule:function(){return v.W},isTramvaiAction:function(){return i.J},optional:function(){return p.jt},provide:function(){return f.J},walkOfModules:function(){return m.l}});var n=r(21533),o=r(71341),s=r(82318),i=r(20745),a=r(29772),u=r(16842),c=r(80211),l=r(80283),d=r(67584),p=r(59999),h=r(66598),g=r(54499),v=r(56245),f=r(97570),m=r(50561),y=r(64805),E=r.n(y);class b{constructor(){this.status="pending",this.resolve=E(),this.reject=E(),this.promise=new Promise(((e,t)=>{this.resolve=t=>{"pending"===this.status&&(this.status="resolved",e(t))},this.reject=e=>{"pending"===this.status&&(this.status="rejected",t(e))}}))}}},30988:function(e,t,r){"use strict";r.d(t,{rI:function(){return E},A6:function(){return f},IC:function(){return v},nW:function(){return y},oJ:function(){return i},CN:function(){return l},g2:function(){return c},il:function(){return u},Wr:function(){return d},kC:function(){return b},d3:function(){return a},lN:function(){return p},nF:function(){return g}});var n=r(5203),o=r(42549);const s={routes:{},pages:{"@/pages/AuthPage":(0,o.Vo)({chunkName(){return"@_pages_AuthPage"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>r.e("@_pages_AuthPage").then(r.bind(r,70277)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 70277}}),"@/pages/ContextAuthDebug":(0,o.Vo)({chunkName(){return"@_pages_ContextAuthDebug"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>r.e("@_pages_ContextAuthDebug").then(r.bind(r,43920)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 43920}}),"@/pages/MFPage":(0,o.Vo)({chunkName(){return"@_pages_MFPage"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>Promise.resolve().then(r.bind(r,38549)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 38549}}),"@/pages/NotFound":(0,o.Vo)({chunkName(){return"@_pages_NotFound"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>Promise.resolve().then(r.bind(r,24015)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 24015}}),"@/pages/WebPushDebug":(0,o.Vo)({chunkName(){return"@_pages_WebPushDebug"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>r.e("@_pages_WebPushDebug").then(r.bind(r,94176)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 94176}}),"@/pages/auth/ErrorMessages/message":(0,o.Vo)({chunkName(){return"@_pages_auth_ErrorMessages_message"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>r.e("@_pages_auth_ErrorMessages_message").then(r.bind(r,65739)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 65739}}),"@/pages/auth/authPage":(0,o.Vo)({chunkName(){return"@_pages_auth_authPage"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>r.e("@_pages_auth_authPage").then(r.bind(r,68212)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 68212}}),"@/pages/webviewDebug/WebviewDebug":(0,o.Vo)({chunkName(){return"@_pages_webviewDebug_WebviewDebug"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>Promise.resolve().then(r.bind(r,18175)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 18175}}),"@/pages/webviewDebug/components/SimpleButton":(0,o.Vo)({chunkName(){return"@_pages_webviewDebug_components_SimpleButton"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>r.e("@_pages_webviewDebug_components_SimpleButton").then(r.bind(r,53903)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 53903}}),"@/pages/webviewDebug/components/TextareaWithButton":(0,o.Vo)({chunkName(){return"@_pages_webviewDebug_components_TextareaWithButton"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>r.e("@_pages_webviewDebug_components_TextareaWithButton").then(r.bind(r,37828)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 37828}}),"@/pages/webviewDebug/components/WebviewDebugComponent":(0,o.Vo)({chunkName(){return"@_pages_webviewDebug_components_WebviewDebugComponent"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>r.e("components-WebviewDebugComponent").then(r.bind(r,13475)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 13475}}),"@/pages/webviewDebug/components/WebviewLink":(0,o.Vo)({chunkName(){return"@_pages_webviewDebug_components_WebviewLink"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>r.e("@_pages_webviewDebug_components_WebviewLink").then(r.bind(r,67150)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 67150}}),"@/pages/webviewPreload/WebviewPreload":(0,o.Vo)({chunkName(){return"@_pages_webviewPreload_WebviewPreload"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>Promise.resolve().then(r.bind(r,21476)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 21476}}),"@/pages/webviewRedirect/WebviewRedirect":(0,o.Vo)({chunkName(){return"@_pages_webviewRedirect_WebviewRedirect"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>Promise.resolve().then(r.bind(r,69297)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 69297}}),"@/pages/webviewRedirect/config":(0,o.Vo)({chunkName(){return"@_pages_webviewRedirect_config"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>Promise.resolve().then(r.bind(r,76765)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 76765}}),"@/pages/webviewRedirect/utils/isTrustedUrl":(0,o.Vo)({chunkName(){return"@_pages_webviewRedirect_utils_isTrustedUrl"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>Promise.resolve().then(r.bind(r,83173)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 83173}}),"@/pages/webviewSingletonEntry/WebviewSingletonEntry":(0,o.Vo)({chunkName(){return"@_pages_webviewSingletonEntry_WebviewSingletonEntry"},requireSync(e){return r(this.resolve(e))},isReady(e){const t=this.resolve(e);return!!r.m[t]},importAsync:()=>Promise.resolve().then(r.bind(r,97606)),requireAsync(e){return this.resolve(e),this.importAsync(e).then((e=>e))},resolve(){return 97606}})},layouts:{},errorBoundaries:{},wildcards:{}},i=()=>!0,a=()=>s.routes,u=()=>Object.assign({},s.routes,s.pages),c=()=>s.layouts,l=()=>s.errorBoundaries,d=()=>s.wildcards,p=e=>i()&&!!e&&0===e.indexOf("@/"),h=e=>"/"+e.replace("@/false/","").replace(/\[(.+?)\]/g,":$1").replace(/index$/g,""),g=e=>["@/pages",...(0,n.am)(e).map((e=>e.startsWith(":")?"["+e.replace(":","")+"]":e)),"index"].filter(Boolean).join("/"),v=e=>e+"__layout",f=e=>e+"__errorBoundary",m=e=>{const t=e.replace(/__wildcard$/g,"");return h(t)+"*"},y=e=>{const t=e,r=h(e),n=c(),o=l(),s={name:t,path:r,config:{pageComponent:e}};return e in n&&(s.config.nestedLayoutComponent=v(e)),e in o&&(s.config.errorBoundaryComponent=f(e)),s},E=e=>!(!a()[e]&&!s.pages[e]),b=()=>{const e=d();return Object.keys(e).map((e=>({name:e,path:m(e),config:{pageComponent:e}})))}},72784:function(e,t,r){"use strict";r.d(t,{s:function(){return o}});var n=r(23302);class o extends n.I{constructor(e){super(),this.httpClient=e}request(e){return this.httpClient.request(e)}}},23302:function(e,t,r){"use strict";r.d(t,{I:function(){return n}});class n{get(e,t,r){return this.request(Object.assign({path:e},t,r,{method:"GET"}))}post(e,t,r){return this.request(Object.assign({path:e,requestType:"json"},t,r,{method:"POST"}))}put(e,t,r){return this.request(Object.assign({path:e,requestType:"json"},t,r,{method:"PUT"}))}delete(e,t,r){return this.request(Object.assign({path:e},t,r,{method:"DELETE"}))}}},97706:function(e,t,r){"use strict";r.d(t,{Ip:function(){return H}});var n=r(80476),o=r(80283),s=r(97570),i=r(59999),a=r(29772),u=r(80772),c=r(82571),l=r(82342),d=r(37621),p=r(82912);var h=r(83964),g=r(72478),v=r(10950),f=r(24679),m=r(92946),y=r(21789),E=r(24592),b=r(56873),R=r(38507),w=r.n(R),S=r(42353),_=r(58426);const N=(0,S.y)("Set analytics config"),C=(0,_.L)("analytics",{}).on(N,((e,t)=>Object.assign({},e,{config:t}))),k=[{provide:d.Ym,multi:!0,useValue:[C]},(0,s.J)({provide:u.Bi.resolvePageDeps,multi:!0,useFactory:e=>{let{tracking:t,pageService:r}=e;return function(){t.extend(w()("analytics",{},r.getMeta()))}},deps:{tracking:E.t3,pageService:b.Y9}}),(0,s.J)({provide:E.ZY,useFactory:e=>{let{store:t}=e;const{config:r={}}=t.getState(C);return r},deps:{store:d.kR}})],T=(0,i.V3)("DPP_SERVICE");var O=r(10776),A=r(29376),I=r(54211);const M="userType",x={Visitor:0,"Client-Light":10,Applicant:20,"Client-Heavy":30},L=e=>x[e]||0;let P=!1;const V=(e,t)=>{const{tracking:r,logger:n,cookies:o}=t,s=n("analytics:tracking:user-type"),i=o.get(M)||"Visitor",a=L(i),u=(e=>{let t;switch(!0){case(0,A.o2)(e):t="Client-Light";break;case(0,A.C5)(e):t="Client-Heavy";break;default:t="Visitor"}return t})(e),c=L(u);let l=i;c>=a&&(l=u,((e,t,r)=>{t.debug({message:"New user level",userType:r}),e.set({name:M,value:r,expires:63072e3,noSubdomains:!0})})(o,s,u)),r.extend({userType:l,userStatus:(0,A.QO)(e)?"Logged In":"Not Logged In"}),!P&&c>a&&(0,A.QO)(e)&&(P=!0,r.event("ibSuccess"))};var D=r(92105);const F=(e,t)=>{e.requested&&t.extend({userId:e.userId||"1111",ssoId:e.ssoId||null})},j={essentials:"Essential",functional:"Functionality",analytics:"Statistics",marketing:"Marketing"},U=[(0,s.J)({provide:u.Bi.init,useFactory:e=>{let{store:t,tracking:r,cookies:n,logger:o}=e;return()=>{const e=t.getState(I.p);e&&(V(e,{tracking:r,cookies:n,logger:o}),t.subscribe(I.p,(e=>V(e,{tracking:r,cookies:n,logger:o}))))}},deps:{store:d.kR,tracking:E.t3,logger:l.Fp,cookies:O.T}}),(0,s.J)({provide:u.Bi.init,useFactory:e=>{let{tracking:t,store:r}=e;return()=>{const e=r.getState(D.p);e&&(F(e,t),r.subscribe(D.p,(e=>F(e,t))))}},deps:{store:d.kR,tracking:E.t3}}),(0,s.J)({provide:u.Bi.customerStart,deps:{dppService:{token:T,optional:!0},tracking:E.t3},useFactory(e){let{dppService:t,tracking:r}=e;return async()=>{if(!t)return;const e=await r.callUtil("getConsentVault");if(!e)return;let n=()=>{};n=t.subscribeToAccept((async t=>{e.update(((e,t)=>Object.entries(e).reduce(((e,r)=>{let[n,o]=r;return e[t[j[n]]]=o,e}),{}))(t,e.categories),"keep"),n()}))}}})],B={prefix:"platform/stable",integrity:{client:"",express:"",tramvai:""}};var J;let H=J=class{static forRoot(e){let{atmContainer:t,ttm:r,twtBundle:n,mode:o}=e;const s=[];return t&&s.push({provide:E.cY,useValue:t}),r&&s.push({provide:E.Te,useValue:r}),n&&s.push({provide:E.SG,useValue:n}),o&&s.push({provide:E.ty,useValue:o}),{mainModule:J,providers:s}}};H=J=(0,n.__decorate)([(0,o.Y)({providers:[(0,s.J)({provide:c.sQ,multi:!0,useValue:[{key:"CONFIG_API",dehydrate:!1,validator:(0,f.v7)([f.CB,(0,f.pn)("/")])},{key:"APP_VERSION",optional:!0,dehydrate:!0}]}),(0,s.J)({provide:E.t3,useFactory:e=>{let{logger:t,store:r,eventeaReady:n,appInfo:o,envManager:s,statistClient:i}=e;const{config:a={}}=r.getState(C),u=window.twtConfig=window.twtConfig||{};u.logger=t("analytics:tracking"),u.disableUserInfo=!0;const{atmContainer:c,containers:l}=(null==a?void 0:a.atm)||{};c&&(u.atmContainerName=c),l&&(u.atmContainers=l);const d=null==a?void 0:a.ttm;d&&(u.ttm=d),i&&(u.statistClient=i);const p=new g.Z;p.resolve((0,v.A)());const f={appName:o.appName,appVersion:s.get("APP_VERSION"),proxyVersion:h.i8,tramvaiVersion:"4.41.103",eventeaReady:n};p.event=(e,t)=>(p.callUtil("tramSendEvent",e,t,f),p);const m=p.extend;return p.extend=e=>{const t=m.call(p,e);return p.callUtil("tramPostData",e,f),t},p},deps:{logger:l.Fp,store:d.kR,eventeaReady:(0,i.jt)(E.dZ),envManager:c.vC,appInfo:a.Qo,statistClient:(0,i.jt)(y.E)}}),(0,s.J)({provide:"router afterNavigateHooks",multi:!0,useFactory:e=>{let{tracking:t}=e;return()=>{t.updateLocation()}},deps:{tracking:E.t3}}),{provide:u.Bi.init,useFactory:function(e){const{resourceLoader:t,logger:r,envManager:n,twtBundle:o,atmContainer:s,ttm:i,requestManager:a,statistClient:u}=e,c=r("analytics:twt-loader");if("server"===(e=>{const{envManager:t,mode:r}=e;switch(!0){case"client"===r:case"server"!==r&&"true"===t.get("TRAMVAI_FORCE_CLIENT_SIDE_RENDERING"):return"client";default:return"server"}})(e)||"true"===a.getParsedUrl().query.disableAnalytics)return()=>Promise.resolve();return function(){(async function(){var e;let a;try{a=await t.getResources("analytics_config")}catch(e){a={},c.error(e,"Failed to load analytics_config")}const l=window.twtConfig=window.twtConfig||{};s&&(l.atmContainerName=s);const d=null===(e=null==a?void 0:a.atm)||void 0===e?void 0:e.containers;d&&(l.atmContainers=d),i&&(l.ttm=i),u&&(l.statistClient=u),function(e,t,r,n){var o,s;const i=t||"platform",a=(null===(s=null===(o=null==r?void 0:r.twt)||void 0===o?void 0:o.bundles)||void 0===s?void 0:s[i])||B,u=n.get("TWA_CDN_URL")||(null==a?void 0:a.baseUrl)||"https://cdn.tbank.ru/twa/";if(!u)return void e.error("twt cdn url is not provided");const c={id:"twtScriptClient",onload:"this.setAttribute('loaded', 'true');",onerror:"this.setAttribute('loaded', 'error');",crossorigin:"anonymous"};a.integrity&&a.integrity.client&&(c.integrity=a.integrity.client);const l=document.createElement("script");l.src=""+u+a.prefix+"/client.js";for(const e of Object.keys(c))l.setAttribute(e,c[e]);document.head.appendChild(l)}(r,o,a,n)})().catch((e=>{c.error(e,"Something wrong happened in analytics:registerScripts method")}))}},multi:!0,deps:{resourceLoader:m.l4,logger:l.Fp,envManager:c.vC,requestManager:p.G,atmContainer:(0,i.jt)(E.cY),ttm:(0,i.jt)(E.Te),twtBundle:(0,i.jt)(E.SG),mode:(0,i.jt)(E.ty),statistClient:(0,i.jt)(y.E)}},...k,...U]})],H)},24592:function(e,t,r){"use strict";r.d(t,{SG:function(){return u},Te:function(){return a},ZY:function(){return s},cY:function(){return i},dZ:function(){return c},t3:function(){return o},ty:function(){return l}});var n=r(59999);const o=(0,n.V3)("analytics"),s=(0,n.V3)("analyticsConfig"),i=(0,n.V3)("analyticsTagManagerContainer"),a=(0,n.V3)("analyticsTTM"),u=(0,n.V3)("analyticsTwtBundle"),c=(0,n.V3)("analyticsEventeaReady"),l=(0,n.V3)("ANALYTICS_MODE")},24679:function(e,t,r){"use strict";r.d(t,{CB:function(){return s},pn:function(){return i},v7:function(){return a}});var n=r(4216),o=r.n(n);const s=e=>{if(!e)return"value should not be empty";let t;try{t=e.startsWith("/")?new URL(e,"http://localhost:3000"):new URL(e)}catch(e){return"URL is not valid"}return"http:"!==t.protocol&&"https:"!==t.protocol&&"Invalid protocol "+t.protocol},i=e=>t=>t?!!t.endsWith(e)||"value should ends with "+e:"value should not be empty",a=e=>t=>e.reduce(((e,r)=>{const n=r(t);return o()(n)?o()(e)?e+"; "+n:n:o()(e)?e:e&&n}),!0)},59372:function(e,t,r){"use strict";r.d(t,{B:function(){return S}});var n=r(80283),o=r(97570),s=r(67584),i=r(82571),a=r(92946),u=r(9056),c=r(55505),l=r(86707),d=r(60200),p=r(24679),h=r(38507),g=r.n(h),v=r(34770),f=r.n(v),m=r(60028),y=r.n(m);const E={cacheTime:6e5,defaultTimeout:3e4},b=e=>Object.assign({},e,{payload:e.payload.response||e.payload.result||y()(["error","message"],e.payload)}),R=e=>Object.assign({},e,{payload:g()("value",{},b(e).payload)}),w=e=>{let{request:t}=e;var r,n;return null!==(n=null===(r=t.path)||void 0===r?void 0:r.split("/")[0])&&void 0!==n?n:""},S=(0,n.Y)({providers:[(0,o.J)({provide:i.sQ,scope:s.s.SINGLETON,useFactory(e){let{dehydrateConfigApi:t,dehydrateResourcesApi:r}=e;return[{key:"CONFIG_API",validator:(0,p.v7)([p.CB,(0,p.pn)("/")]),dehydrate:null===t||t},{key:"RESOURCES_API",validator:(0,p.v7)([p.CB,(0,p.pn)("/")]),dehydrate:null===r||r},{key:"INTEGRATION_CONFIG_API",dehydrate:!1,validator:(0,p.v7)([p.CB,(0,p.pn)("/")])}]},deps:{dehydrateConfigApi:{token:"dehydrateConfigApi",optional:!0},dehydrateResourcesApi:{token:"dehydrateResourcesApi",optional:!0}},multi:!0}),(0,o.J)({provide:a.fg,useFactory:e=>{let{factory:t,envManager:r}=e;return t({baseUrl:r.get("CONFIG_API"),circuitBreakerOptions:{failureThreshold:75,minimumFailureCount:10,isSystemError:()=>!0,getKey:w}})},deps:{factory:a.O7,envManager:i.vC}}),(0,o.J)({provide:a.l4,useFactory:e=>{let{factory:t,envManager:r}=e;const n=t({name:"admin-resources-api",baseUrl:r.get("RESOURCES_API"),modifyResponse:R});return new c.X({httpClient:n})},deps:{factory:a.O7,envManager:i.vC}}),(0,o.J)({provide:a.w1,useFactory:e=>{let{factory:t,envManager:r}=e;const n=t({name:"admin-integration-api",baseUrl:r.get("INTEGRATION_CONFIG_API")});return new l.t({httpClient:n})},deps:{factory:a.O7,envManager:i.vC}}),(0,o.J)({provide:a.O7,useFactory:e=>{let{factory:t,optionsFactory:r}=e;return e=>t(Object.assign({},r(e),e))},deps:{factory:u.FB,optionsFactory:a.DL}}),(0,o.J)({provide:a.DL,useValue:e=>Object.assign({},E,{name:"admin-api",validator:e=>{let{request:t,response:r}=e;if(!r||!r.response&&!r.result)return f()(r)?Object.assign(new Error,f()(r.error)?r.error:{path:t.path,response:r||null}):new Error(JSON.stringify(r))},errorValidator:e=>{let{request:t,response:r,error:n}=e;return(404===n.status||400===n.status)&&!(!r||!r.error)},errorModificator:e=>{let{error:t}=e;return Object.assign(t,{errorId:"CONFIG_REQUEST_ERROR"})},modifyResponse:b,enableCircuitBreaker:!0,circuitBreakerOptions:{failureThreshold:75,minimumFailureCount:10,isSystemError:()=>!0}})}),{provide:a.xs,useFactory:e=>{let{httpClient:t}=e;return new d.P({httpClient:t})},deps:{httpClient:{token:a.fg,optional:!0}}}]})(class{})},95926:function(e,t,r){"use strict";r.d(t,{yi:function(){return re}});var n=r(80283),o=r(65554),s=r(21377),i=r(59372),a=r(97570),u=r(29772),c=r(82571),l=r(49076),d=r(45838),p=r(82912),h=r(92946),g=r(9056),v=r(10776),f=r(3566),m=r(69736),y=r(24679),E=r(67826),b=r.n(E);const R=b()(["resultCode"],"SESSION_IS_ABSENT"),w=b()(["resultCode"],"INSUFFICIENT_PRIVILEGES");var S=r(84762),_=r.n(S),N=r(77125),C=r.n(N);const k={expired:R,notAllowed:w,confirmation:_()([b()(["resultCode"],"WAITING_CONFIRMATION"),C()("confirmations"),C()("confirmationData")])};var T=r(33926),O=r(34770),A=r.n(O);const I=["query","method","serverGetSession","roles"],M=b()(["resultCode"],"OK"),x={defaultTimeout:6e4},L=e=>Object.assign({},e,{payload:e.payload.payload});var P=r(63119),V=r.n(P),D=r(64805),F=r.n(D),j=r(23629),U=r.n(j),B=r(72784),J=r(41537),H=r(26335);class q extends B.s{constructor(e){let{httpClient:t,context:r,hooks:n,apiOriginService:o,cookieManager:s,wuid:i,sessionCookieName:a}=e;super(t),this.context=r,this.hooks=n,this.customizeParams=V()((e=>e),(0,J.c)(o),(0,H.J)({cookieManager:s,sessionCookieName:a}),(e=>t=>t.withoutSession||t.withoutWuid?t:Object.assign({},t,{query:Object.assign({wuid:e},t.query)}))(i))}request(e){const{path:t,confirmHide:r,confirmSSR:n=!1,confirmViewType:o=null,onConfirm:s=F()}=e;return this.httpClient.request(this.customizeParams(e)).then((e=>k.confirmation(e.payload)?this.hooks.runPromiseHooks("confirm",this.context)({viewType:o,onConfirmShowed:s,confirmHide:r,confirmSSR:n,data:e.payload}).then(U()("payload")):e)).catch((r=>{switch(!0){case"session_status"!==t&&k.expired(r.response):return this.hooks.runPromiseHooks("sessionAbsent",this.context)({sessionExpired:!0,useCache:!1});case k.notAllowed(r.response):return this.hooks.runPromiseHooks("notAllowed",this.context)(void 0).then((()=>{throw new Error("Not Allowed")}));default:return this.hooks.runPromiseHooks("unknown",this.context,e)(r).then((()=>{throw r}))}}))}}var G=r(60028),W=r.n(G),Y=r(28296),K=r.n(Y);const Q=e=>K()("tinkoffApiOrigin",e)||W()(["properties","tinkoffApiOrigin"],e),Z=V()(Q,W()(["currentRoute","config"]),("router",e=>e.getState().router));class z{constructor(e){let{context:t,defaultOrigin:r,decorators:n}=e;this.getRawOrigin=e=>Z(this.context)||e||this.defaultOrigin,this.getOrigin=e=>{const t=this.getRawOrigin(e);return this.decorators.reduce(((e,t)=>t(e)),t)},this.context=t,this.defaultOrigin=r,this.decorators=null!=n?n:[]}get(){return this.getOrigin()}getWhen(e){let{requestOrigin:t}=e;return this.getOrigin(t)}}const $=(0,n.Y)({providers:[(0,a.J)({provide:c.sQ,useValue:[{key:"TINKOFF_API",validator:(0,y.v7)([y.CB,(0,y.pn)("/")])}],multi:!0}),(0,a.J)({provide:"defaultOrigin",useValue:"web,ib5,platform"}),(0,a.J)({provide:h.JS,useFactory:e=>{let{context:t,defaultOrigin:r,decorators:n}=e;return new z({context:t,defaultOrigin:r,decorators:n})},deps:{context:l.l,defaultOrigin:"defaultOrigin",decorators:{optional:!0,token:h.Tx}}}),(0,a.J)({provide:h.JB,useFactory:e=>{let{factory:t,envManager:r,appInfo:n,context:o,hooks:s,apiOriginService:i,cookieManager:a,wuid:u,sessionCookieName:c}=e;const l=t({name:"tinkoff-api",baseUrl:r.get("TINKOFF_API"),disableCache:!0,query:{appName:n.appName,appVersion:r.get("APP_VERSION")},modifyResponse:e=>k.confirmation(e.payload)?e:Object.assign({},e,{payload:e.payload.payload})},{isResponseValid:e=>M(e)||k.confirmation(e)});return new q({httpClient:l,context:o,hooks:s,apiOriginService:i,cookieManager:a,wuid:u,sessionCookieName:c})},deps:{factory:h.iu,envManager:c.vC,appInfo:u.Qo,hooks:d.v,requestManager:p.G,context:l.l,apiOriginService:h.JS,cookieManager:v.T,wuid:f.$,sessionCookieName:{token:m.sV,optional:!0},headersList:{token:g.s,optional:!0}}}),(0,a.J)({provide:h.iu,useFactory:e=>{let{factory:t,optionsFactory:r}=e;return(e,n)=>t(Object.assign({},r(e,n),e))},deps:{factory:g.FB,optionsFactory:h.Z1}}),(0,a.J)({provide:h.Z1,useValue:function(e,t){let{modifyResponse:r=L,disableCache:n}=e,{isResponseValid:o=M}=void 0===t?{}:t;return Object.assign({name:"common-api",validator:e=>{let{request:t,response:r}=e;if(!o(r))return A()(r)?Object.assign(new Error,A()(r.error)?r.error:{path:t.path,response:r||null}):new Error(JSON.stringify(r))},errorModificator:e=>{let{error:t}=e;return Object.assign(t,{errorId:"COMMON_API_REQUEST_ERROR"})},modifyRequest:e=>{const{query:t={},method:r="GET",serverGetSession:o=!1,roles:s}=e,i=(0,T.Z)(e,I),a=t.sessionid+JSON.stringify(s),u=Object.assign({method:r},i,{query:t,additionalCacheKey:a});if(!n){const{cache:e="POST"!==r,cacheForce:t}=u,n=!0;u.cache=n&&e,u.cacheForce=n&&t}return u},modifyResponse:r,enableCircuitBreaker:!0},x)}}),(0,a.J)({provide:h.Tx,multi:!0,useFactory:e=>{let{context:t}=e;return e=>{var r,n;if(!(null===(n=null===(r=t.getState())||void 0===r?void 0:r.session)||void 0===n?void 0:n.isJunior))return e;const o=e.split(",");return o.push("junior"),o.filter(Boolean).join(",")}},deps:{context:l.l}})]})(class{}),X=(0,n.Y)({imports:[o.Gi],providers:[{provide:g.s,multi:!0,useValue:["x-b3-traceid","x-b3-spanid","x-b3-parentspanid","x-b3-sampled","x-b3-flags","x-ot-span-context"]}]})(class{});var ee=r(67584);const te=(0,n.Y)({imports:[],providers:[(0,a.J)({provide:g.FF,scope:ee.s.SINGLETON,useValue:{modifyError:e=>{if(e.originalMessage)return e;const t=e.message,r=(e=>!0===(/network timeout at/i.test(e)||/request timed out/i.test(e))?"Время истекло. Обновите страницу и повторите попытку.":"Что-то пошло не так. Мы уже решаем проблему. Попробуйте снова через несколько минут.")(t);return Object.assign(e,{message:r,originalMessage:t})}}})]})(class{}),re=(0,n.Y)({imports:[o.Gi,X,s.J,te,i.B,$],providers:[]})(class{})},41537:function(e,t,r){"use strict";r.d(t,{c:function(){return n}});const n=e=>t=>{const r=e.getWhen({requestOrigin:t.origin});return Object.assign({},t,{query:Object.assign({origin:r},t.query)})}},26335:function(e,t,r){"use strict";r.d(t,{J:function(){return n}});const n=e=>{let{cookieManager:t,sessionCookieName:r}=e;return e=>e.withoutSession?e:Object.assign({},e,{query:Object.assign({sessionid:t.get(r||"psid")},e.query)})}},54211:function(e,t,r){"use strict";r.d(t,{b:function(){return i},p:function(){return u}});var n=r(42353),o=r(58426),s=r(29376);const i=(0,n.y)("UPDATE_ROLES"),a={[s.$d]:(0,s.Me)()},u=(0,o.L)("roles",a).on(i,((e,t)=>t))},92105:function(e,t,r){"use strict";r.d(t,{C:function(){return s},p:function(){return i}});var n=r(42353),o=r(58426);const s=(0,n.y)("UPDATE_SESSION"),i=(0,o.L)("session",{}).on(s,((e,t)=>t))},64479:function(e,t,r){"use strict";r.d(t,{sC:function(){return h}});var n=r(80476),o=r(80283),s=r(8479),i=r(44121),a=r(54143),u=r(81935),c=r(59999),l=r(44488),d=r(31536);const p=e=>{var t;return!(null===(t=e.navigateState)||void 0===t?void 0:t.disableAutoscroll)};let h=class{};h=(0,n.__decorate)([(0,o.Y)({providers:[{provide:s.LAYOUT_OPTIONS,useValue:{components:{autoscroll:function(){var e;const t=(0,l.x)((0,c.jt)(d.y))||"smooth",r=null!==(e=(0,l.x)((0,c.jt)(d.M)))&&void 0!==e?e:0,n=(0,a.y)(),o=(0,u.w)(),s=(0,i.useRef)(o),h=(0,i.useRef)(!!s.current.hash&&p(n));return(0,i.useEffect)((()=>{var e;if(o.pathname===s.current.pathname&&o.hash===s.current.hash||(s.current=o,h.current=p(n)),!h.current)return;const i=(null===(e=null==n?void 0:n.navigateState)||void 0===e?void 0:e.autoscrollBehavior)||t;o.hash?h.current=!((e,t)=>{var r;try{return null===(r=document.querySelector(e))||void 0===r||r.scrollIntoView({behavior:t}),!0}catch(e){return!1}})(o.hash,i):(((e,t)=>{try{window.scrollTo({top:t,left:0,behavior:e})}catch(e){window.scrollTo(0,t)}})(i,r),h.current=!1)})),null}}},multi:!0}]})],h)},31536:function(e,t,r){"use strict";r.d(t,{M:function(){return s},y:function(){return o}});var n=r(59999);const o=(0,n.V3)("autoscroll behavior"),s=(0,n.V3)("autoscroll scroll top")},36252:function(e,t,r){"use strict";r.d(t,{pc:function(){return s}});var n=r(80476),o=r(80283);let s=class{};s=(0,n.__decorate)([(0,o.Y)({providers:[]})],s)},48482:function(e,t,r){"use strict";r.d(t,{j:function(){return n}});const n=(0,r(59999).V3)("noJsWarning")},38518:function(e,t,r){"use strict";r.d(t,{pY:function(){return w}});var n=r(66598),o=r(97570),s=r(80772),i=r(49076),a=r(37621),u=r(10776),c=r(27714),l=r.n(c),d=r(42353),p=r(58426);const h=(0,d.y)("setMedia"),g=(0,p.L)("media",{height:0,width:0,isTouch:!1,retina:!1,synchronized:!1,displayMode:"unknown"}).on(h,((e,t)=>Object.assign({},e,t))),v=window.requestIdleCallback||function(e){return window.setTimeout(e,1)},f=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),m=window.matchMedia("(display-mode: standalone)").matches?"standalone":window.matchMedia("(display-mode: browser)").matches?"browser":"unknown";var y=r(33464),E=r(66824),b=r(82571);const R=[(0,o.J)({provide:a.Ym,multi:!0,useValue:[E.c,g]}),(0,o.J)({provide:b.sQ,useValue:[{key:"TRAMVAI_FORCE_CLIENT_SIDE_RENDERING",optional:!0}]}),(0,o.J)({provide:s.Bi.clear,multi:!0,useFactory:e=>{let{context:t,cookieManager:r}=e;return function(){const e=()=>{const e={width:window.innerWidth,height:window.innerHeight,isTouch:f,displayMode:m,retina:window.matchMedia("(-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)").matches};return r.set({name:"mediaInfo",value:JSON.stringify(e)}),v((()=>t.dispatch(h(Object.assign({},e,{supposed:!1})))))},n=l()(300,e);return window.addEventListener("orientationchange",n),window.addEventListener("resize",n),e()}},deps:{context:i.l,cookieManager:u.T}}),(0,o.J)({provide:y.N,useFactory:e=>{let{store:t}=e;return t.getState(E.c)},deps:{store:a.kR}})],w=(0,n.J)({name:"ClientHintsModule",providers:R})},86927:function(e,t){"use strict";t.S="mediaInfo"},66824:function(e,t,r){"use strict";r.d(t,{X:function(){return s},c:function(){return i}});var n=r(42353),o=r(58426);const s=(0,n.y)("setUserAgent"),i=(0,o.L)("userAgent",null).on(s,((e,t)=>t))},33464:function(e,t,r){"use strict";r.d(t,{N:function(){return n}});const n=(0,r(59999).V3)("userAgent")},7795:function(e,t,r){"use strict";r.d(t,{e:function(){return It}});var n=r(33926),o=r(80476),s=r(49103),i=r.n(s),a=r(80283),u=r(97570),c=r(67584),l=r(29772),d=r(16842),p=r(82571),h=r(37621);class g{constructor(){this.parameters={}}get(e){return this.parameters[e]}getInt(e,t){const r=Number(e in this.parameters?this.parameters[e]:t);return Number.isFinite(r)?r:t}getAll(){return this.parameters}update(e){this.parameters=Object.assign(this.parameters,e)}clientUsed(){return this.getAll()}updateClientUsed(e){this.update(e)}}var v=r(58426);const f=(0,v.L)("environment",{});let m=class{};m=(0,o.__decorate)([(0,a.Y)({providers:[{provide:p.vC,useFactory:e=>{let{store:t}=e;const r=new g;return r.update(t.getState(f)),r},scope:c.s.SINGLETON,deps:{store:h.kR}},{provide:h.Ym,useValue:f,multi:!0}]})],m);var y=r(38518),E=r(33464);class b{constructor(e){void 0===e&&(e={}),this.defaults=e}get(e){const t=document.cookie.split(";");for(let r=0;r<t.length;r++){const n=t[r];if(!n)break;let o=n.indexOf("=");o=o<0?n.length:o;const s=n.slice(0,o).replace(/^\s+/,""),i=n.slice(o+1);let a;try{a=decodeURIComponent(s)}catch(e){console.warn("Decode cookie name error",e)}if(a===e||s===e)try{return decodeURIComponent(i)}catch(e){return console.warn("Decode cookie value error",e),i}}}set(e,t,r){if(!e)return;const{domain:n,path:o,expires:s,secure:i,httpOnly:a,sameSite:u}=function(e,t){var r,n,o,s,i;return void 0===e&&(e={}),void 0===t&&(t={}),{expires:e.expires||t.expires,domain:e.domain||t.domain,path:null!==(n=null!==(r=e.path)&&void 0!==r?r:t.path)&&void 0!==n?n:"/",secure:null!==(o=e.secure)&&void 0!==o?o:t.secure,httpOnly:null!==(s=e.httpOnly)&&void 0!==s?s:t.httpOnly,sameSite:null!==(i=e.sameSite)&&void 0!==i?i:t.sameSite}}(r,this.defaults),c=function(e){return e?new Date("number"==typeof e?(new Date).getTime()+864e5*e:e):null}(s),l=e.replace(/[^+#$&^`|]/g,encodeURIComponent).replace("(","%28").replace(")","%29"),d=("string"==typeof t?t:"").replace(/[^+#$&/:<-\[\]-}]/g,encodeURIComponent),p=c&&c.getTime()>=0?";expires="+c.toUTCString():"",h=n?";domain="+n:"",g=o?";path="+o:"",v=i?";secure":"",f=a?";httponly":"",m=u?";samesite="+u:"";document.cookie=l+"="+d+p+h+g+v+f+m}erase(e,t){void 0===t&&(t={}),this.set(e,"",{expires:-1,domain:t.domain,path:t.path,secure:!1,httpOnly:!1})}all(){const e={},t=document.cookie.split(";");for(;t.length;){const r=t.pop();if(!r)break;let n=r.indexOf("=");n=n<0?r.length:n;const o=r.slice(0,n).replace(/^\s+/,""),s=r.slice(n+1);let i,a;try{i=decodeURIComponent(o)}catch(e){console.warn("Decode cookie name error",e)}try{a=decodeURIComponent(s)}catch(e){console.warn("Decode cookie value error",e)}e[null!=i?i:o]=null!=a?a:s}return e}}const R=["sameSite","noSubdomains"],w=/^(?:::(?:ffff:(0:)?)?)?(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/,S=/^([0-9a-fA-F]{1,4}:){1,4}:(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/,_=e=>{if(e)return new Date("number"==typeof e?+new Date+1e3*e:e)},N=["name","value"];class C{constructor(){this.cache=Object.create(null)}get(e){return this.cache[e]||void 0}set(e,t){this.cache[e]=t}erase(e){delete this.cache[e]}all(){return this.cache}}var k=r(10776);let T=class{};T=(0,o.__decorate)([(0,a.Y)({imports:[y.pY],providers:[(0,u.J)({provide:k.T,useClass:class{constructor(e){let{cookieOptions:t={},userAgent:r}=e;const n="https:"===window.location.protocol,o=Object.assign({sameSite:r.sameSiteNoneCompatible&&n?"none":"lax",secure:n},t);this.cookies=function(e){void 0===e&&(e=!1);const t="testcookiesenabled=",r=e?t+"; SameSite=None; Secure":t;return document.cookie=r,document.cookie.indexOf(t)>-1&&(document.cookie=r+"; expires=Thu, 01 Jan 1970 00:00:01 GMT",!0)}("none"===o.sameSite)?new b(o):new C,this.userAgent=r}get(e){return this.cookies.get(e)||void 0}set(e){let{name:t,value:r}=e,o=(0,n.Z)(e,N);this.cookies.set(t,r,((e,t)=>{let{userAgent:{sameSiteNoneCompatible:r},defaultHost:o,secureProtocol:s}=e,{sameSite:i,noSubdomains:a}=t,u=(0,n.Z)(t,R);return Object.assign({},u,"none"!==i||r&&s?{sameSite:i}:{},s&&"none"===i&&r?{secure:!0}:{},{expires:_(u.expires),domain:a?(c=u.domain||o,(e=>w.test(e)||S.test(e))(c)?c:(e=>e.replace(/:\d+$/,""))(c.indexOf("localhost")>=0?c:"."+c.split(".").slice(-2).join("."))):u.domain});var c})({userAgent:this.userAgent,defaultHost:window.location.hostname,secureProtocol:"https:"===window.location.protocol},o))}all(){return this.cookies.all()}remove(e,t){return this.cookies.erase(e,t)}},scope:c.s.SINGLETON,deps:{cookieOptions:{token:"temporary cookieOptions",optional:!0},userAgent:E.N}})]})],T);var O=r(48945),A=r(59999),I=r(82342);const M=(0,O.createLoggerFactory)({name:"",key:"tramvai",reporters:[new O.BrowserReporter]});let x=class{};x=(0,o.__decorate)([(0,a.Y)({providers:[(0,u.J)({provide:I.Fp,useFactory(e){let{loggerInitHooks:t}=e;if(t)for(const e of t)e(M);return M},deps:{loggerInitHooks:{token:I.J0,multi:!0,optional:!0}}}),(0,u.J)({provide:I.yV,scope:c.s.SINGLETON,useValue:new Map}),(0,u.J)({provide:I.J0,multi:!0,useFactory(e){let{remoteReporter:t}=e;return e=>{t&&e.addReporter(t)}},deps:{remoteReporter:(0,A.jt)(I.DV)}})]})],x);var L=r(56003),P=r(83005),V=r(49076),D=r(17173),F=r(10112),j=r(79436),U=r.n(j),B=r(71341),J=r(42549),H=r(30988);const q="__default";class G{constructor(e){let{bundleList:t,componentRegistry:r,logger:n}=e;if(this.bundles=t,this.componentRegistry=r,(0,H.oJ)()){const e=n("file-system-pages:bundle-manager"),t=(0,H.il)(),r=(0,H.g2)(),o=(0,H.CN)(),s=(0,H.Wr)(),i=(e,t)=>Object.keys(e).reduce(((r,n)=>(r[t(n)]=e[n],r)),{}),a=(0,B.Z)({name:q,components:Object.assign({},i(r,H.IC),i(o,H.A6),i(s,U()),t)});this.bundles[q]=()=>Promise.resolve({default:a});for(const e in a.components)this.componentRegistry.add(e,a.components[e],q);e.debug({event:"create default bundle with file-system pages",components:Object.keys(t)})}else this.bundles[q]=()=>Promise.resolve({default:(0,B.Z)({name:q,components:{}})})}get(e,t){return(0,H.lN)(t)&&(e=q),this.loadBundle(e,t).then((e=>e.default))}has(e,t){return(0,H.lN)(t)&&(e=q),!!this.bundles[e]}loadBundle(e,t){return this.has(e,t)?this.bundles[e]().catch((t=>(0,J.gm)(t,this.bundles[e]))):Promise.reject(new Error('Bundle "'+e+'" not found'))}}var W=r(33057),Y=r.n(W),K=r(30353),Q=r.n(K);const Z="__default",z=(0,A.V3)("fastify request"),$=(0,A.V3)("fastify response"),X=(0,A.V3)("tramvai server response stream"),ee=(0,A.V3)("tramvai server response task manager");c.s.SINGLETON,c.s.SINGLETON,c.s.SINGLETON,c.s.SINGLETON,c.s.SINGLETON,c.s.SINGLETON,c.s.SINGLETON;var te=r(42353);const re=(0,te.y)("setRequest"),ne=(0,v.L)("requestManager",{}).on(re,((e,t)=>t));var oe=r(82912),se=r(78047);const ie=[(0,u.J)({provide:oe.G,scope:c.s.REQUEST,useClass:class{constructor(e){let{request:t}=e;this.request=t||{},this.url=window.location.href}getBody(){return this.request.body}getUrl(){return this.url}getParsedUrl(){return this.parsedUrl||(this.parsedUrl=(0,se.Qc)(this.url)),this.parsedUrl}getMethod(){return this.request.method}getHeader(e){var t;return null===(t=this.request.headers)||void 0===t?void 0:t[e]}getHeaders(){return this.request.headers}getCookie(e){return this.request.cookies[e]}getCookies(){return this.request.cookies}getClientIp(){var e,t;return this.getHeader("x-real-ip")||(null===(t=null===(e=this.request)||void 0===e?void 0:e.socket)||void 0===t?void 0:t.remoteAddress)||""}getHost(){return window.location.host}},deps:{request:z}}),(0,u.J)({provide:h.Ym,multi:!0,useValue:ne})];let ae=class{};ae=(0,o.__decorate)([(0,a.Y)({providers:[...ie,(0,u.J)({provide:z,useFactory:e=>{let{store:t}=e;const r=t.getState(ne);return Object.assign({},r,{headers:Object.assign({},null==r?void 0:r.headers,{"user-agent":navigator.userAgent,cookie:document.cookie})})},deps:{store:h.kR}})]})],ae);var ue=r(80858),ce=r(92877),le=r.n(ce),de=r(53170),pe=r.n(de);const he=[(0,u.J)({provide:ue.r,scope:c.s.REQUEST,useClass:class{constructor(){this.body="",this.headers={},this.cookies={},this.status=200}getBody(){return this.body}setBody(e){this.body=e}getHeader(e){return"set-cookie"===e?pe()(this.cookies):this.headers[e]}getHeaders(){return le()(this.cookies)?this.headers:Object.assign({},this.headers,{"Set-Cookie":pe()(this.cookies)})}setHeader(e,t){this.headers[e]=t}getCookie(e){return this.cookies[e]}getCookies(){return this.cookies}setCookie(e,t){this.cookies[e]=t}setStatus(e){this.status=e}getStatus(){return this.status}}})];let ge=class{};ge=(0,o.__decorate)([(0,a.Y)({providers:[...he,(0,u.J)({provide:$,useValue:{}})]})],ge);var ve=r(63119),fe=r.n(ve);const me=(e,t)=>{e.on("change",t),t()};var ye=r(24069);const Ee=(e,t)=>"string"==typeof e?{payload:t,type:e,error:!1}:e;class be extends ye.Z{constructor(e,t,r,n){super(),this.applyDispatch=e=>{let t=this.dispatcher.handlers[e.type]||[];if(!t.length){if(!e.store)return e.payload;this.registerStore(e.store),t=this.dispatcher.handlers[e.type]||[]}return this.applyHandlers(e,t),e.payload},this.dispatcher=e,this.storeInstances={},this.storeUnsubscribeCallbacks={},this.context=t,this.dispatcherInterface={getContext:()=>this.context,getStore:this.getStore.bind(this)},this.rehydratedStoreState={},this.fullState={},r&&this.rehydrate(r),(null==n?void 0:n.length)&&(this.applyDispatch=this.applyMiddlewares(n)),Object.keys(this.dispatcher.stores).forEach((e=>{this.getStore(e)}))}applyMiddlewares(e){let t=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")};const r={getState:this.getState.bind(this),subscribe:this.subscribe.bind(this),dispatch:function(){return t(...arguments)}};return t=fe()(...e.map((e=>e(r))))(this.applyDispatch),t}storeSubscribe(e,t){if(this.storeUnsubscribeCallbacks[e])return;const r=()=>{const r=t.getState();r!==this.fullState[e]&&(this.fullState=Object.assign({},this.fullState,{[e]:r}),this.emit("change"))};me(t,r),this.storeUnsubscribeCallbacks[e]=()=>{t.off("change",r)}}getStore(e){let t,r=!1;"object"==typeof e?(t=e.store,r=e.optional):t=e;const n=this.dispatcher.getStoreName(t);if(!this.storeInstances[n]){let e=this.dispatcher.stores[n];if(!e){if("function"!=typeof t){if(r)return null;throw new Error("Store "+n+" was not registered.")}this.dispatcher.registerStore(t),e=t}const o=new e(this.dispatcherInterface);if(this.storeInstances[n]=o,this.rehydratedStoreState&&this.rehydratedStoreState[n]){const e=this.rehydratedStoreState[n];o.rehydrate&&o.rehydrate(e),this.rehydratedStoreState[n]=null}this.storeSubscribe(n,o),e.dependencies&&e.dependencies.forEach((e=>{const t=this.getStore(e);me(t,(()=>{o.emit("change")}))}))}return this.storeInstances[n]}dispatch(e,t){if(!e)throw new Error("eventOrType parameter "+e+" is invalid.");const r=Ee(e,t);return this.applyDispatch(r)}applyHandlers(e,t){const r={},n=e=>{if(r[e.name])return;const t=this.getStore(e.name);t&&("function"==typeof e.handler?r[e.name]=e.handler.bind(t):r[e.name]=t[e.handler].bind(t))},o=t.length;for(let e=0;e<o;e++)n(t[e]);return((e,t)=>{const r=Object.keys(t);for(let n=0;n<r.length;n++){const o=r[n],s=t[o];if(!s)throw new Error(o+" does not have a handler for action "+e.type);s(e.payload,e.type)}})(e,r)}dehydrate(){const e={},t=Object.keys(this.storeInstances);for(let r=0;r<t.length;r++){const n=t[r],o=this.storeInstances[n].dehydrate();void 0!==o&&(e[n]=o)}return{stores:e}}rehydrate(e){if(e.stores){const t=Object.keys(e.stores);for(let r=0;r<t.length;r++){const n=t[r];this.rehydratedStoreState[n]=e.stores[n]}}}subscribe(){if("storeName"in(arguments.length<=0?void 0:arguments[0])){const e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1],r=this.getStore(e),n=()=>{const r=this.getState(e);t(r)};return r.on("change",n),()=>{r.off("change",n)}}const e=arguments.length<=0?void 0:arguments[0],t=()=>{const t=this.getState();e(t)};return this.on("change",t),()=>{this.off("change",t)}}getState(e){return e?this.fullState[e.storeName]:this.fullState}setContext(e){this.context=e}hasStore(e){return e.storeName in this.storeInstances&&this.dispatcher.hasStore(e)}registerStore(e){this.dispatcher.registerStore(e),this.getStore(e)}unregisterStore(e){const{storeName:t}=e;this.dispatcher.unregisterStore(e),this.storeUnsubscribeCallbacks[t](),delete this.storeUnsubscribeCallbacks[t],delete this.rehydratedStoreState[t],delete this.storeInstances[t]}}var Re=r(71533);class we{constructor(e){var t=this;let{di:r,dispatcherContext:n,pubsub:o,store:s}=e;this.executeAction=(e,t)=>this.di.get(Re.R$).run(e,t),this.dispatch=(e,t)=>new Promise(((r,n)=>{try{r(this.store.dispatch(Ee(e,t)))}catch(e){n(e)}})),this.dispatchWith=(e,r)=>"function"==typeof e?function(){return t.dispatch(e(...arguments),r)}:t=>this.dispatch(e,t),this.getStore=e=>this.dispatcher.getStore(e),this.dehydrate=()=>({dispatcher:this.dispatcher.dehydrate()}),this.getState=function(){return t.store.getState(arguments.length<=0?void 0:arguments[0])},this.subscribe=function(){return t.store.subscribe(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1])},this.hasStore=e=>this.dispatcher.hasStore(e),this.registerStore=e=>this.dispatcher.registerStore(e),this.unregisterStore=e=>this.dispatcher.unregisterStore(e),this.store=s,this.dispatcher=n,this.dispatcher.setContext(this),this.di=r,this.pubsub=o}}var Se=r(80772),_e=r(78377),Ne=r(46478),Ce=r(40186);const ke={init:[Se.Bi.init,Se.Bi.listen],close:[Se.Bi.close],customer:[Se.Bi.customerStart,Se.Bi.resolveUserDeps,Se.Bi.resolvePageDeps,Se.Bi.generatePage,Se.Bi.clear],spa:[Se.Bi.resolveUserDeps,Se.Bi.resolvePageDeps,Se.Bi.spaTransition],afterSpa:[Se.Bi.afterSpaTransition]},Te={server:ke,client:ke};let Oe=class{};Oe=(0,o.__decorate)([(0,a.Y)({providers:[(0,u.J)({provide:Se.S9,scope:c.s.SINGLETON,useClass:class{constructor(e){let{lines:t,rootDi:r,logger:n,executionContextManager:o,executionEndHandlers:s}=e;this.executionContextByDi=new WeakMap,this.abortControllerByDi=new WeakMap,this.lines=t,this.rootDi=r,this.log=n("command:command-line-runner"),this.executionContextManager=o,this.executionEndHandlers=s}run(e,t,r,n,o){const s=null!=n?n:this.resolveDi(e,t,this.rootDi,r),i=s.get({token:F.mj,optional:!0});this.log.debug({event:"command-run",type:e,status:t});const a={};return s.register({provide:_e.x,useValue:a}),this.lines[e][t].reduce(((e,t)=>e.then((()=>{const e=t.toString();return a[e]={start:performance.now()},Promise.resolve().then((()=>this.executionContextManager.withContext(i,"command-line:"+e,(async(e,r)=>{this.executionContextByDi.set(s,e),this.abortControllerByDi.set(s,r),await this.createLineChain(s,t)})))).finally((()=>{a[e].end=performance.now()}))}))),Promise.resolve()).finally((()=>{if(this.executionContextByDi.delete(s),this.abortControllerByDi.delete(s),this.executionEndHandlers)for(const r of this.executionEndHandlers)r(s,e,t,a,o)})).then((()=>s))}resolveDi(e,t,r,n){let o=r;return"customer"===t&&"client"!==e&&(o=(0,Ce.H)(o)),n&&n.forEach((e=>o.register(e))),o}resolveExecutionContextFromDi(e){var t;return null!==(t=this.executionContextByDi.get(e))&&void 0!==t?t:null}createLineChain(e,t){let r;try{if(r=e.get({token:t,optional:!0}),null===r)return Promise.resolve()}catch(t){return this.log.error(t),this.throwError(t,e)}return Array.isArray(r)?Promise.all(r.map((r=>this.instanceExecute(r,t,e)))):this.instanceExecute(r,t,e)}instanceExecute(e,t,r){if(!(e instanceof Function)){const r=new TypeError('Expected function in line processing "commandLineListTokens.'+t.toString()+'", received "'+e+'".\n      Check that all commandLineListTokens subscribers return functions');return void this.log.error({event:"line-error",error:r,line:t.toString()})}const{name:n=""}=e;return this.log.debug({event:"line-run",line:t.toString(),command:n}),Promise.resolve().then((()=>e())).catch((e=>{var o;this.log[(0,Ne.LG)(e)?"debug":"error"]({event:"line-error",error:e,line:t.toString(),command:n}),null===(o=this.abortControllerByDi.get(r))||void 0===o||o.abort(e),this.throwError(e,r)}))}throwError(e,t){throw"object"==typeof e&&(e.di=t),e}},deps:{lines:Se.PR,rootDi:d.Z,logger:I.Fp,executionContextManager:F.vV,executionEndHandlers:{token:_e.p,optional:!0}}}),(0,u.J)({provide:F.p7,useFactory:e=>{let{di:t,commandLineRunner:r}=e;return()=>r.resolveExecutionContextFromDi(t)},deps:{di:d.Z,commandLineRunner:Se.S9}}),(0,u.J)({provide:Se.PR,scope:c.s.SINGLETON,useValue:Te})]})],Oe);var Ae=r(64805),Ie=r.n(Ae);const Me={logger:{debug:Ie(),info:Ie(),error:Ie()},resultTransform:e=>1===e.length?e[0]:e};class xe{constructor(e){this.subscribers=new Map;const t=Object.assign({},Me,e);this.logger=t.logger,this.resultTransform=t.resultTransform}subscribe(e,t){this.logger.debug("subscribe",e,t);let r=this.subscribers.get(e);return r?r.add(t):(r=new Set([t]),this.subscribers.set(e,r)),()=>r.delete(t)}publish(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.logger.debug("publish",e,r);const o=this.subscribers.get(e);if(o&&o.size){const e=[];return o.forEach((t=>e.push(Promise.resolve(t(...r))))),Promise.all(e).then(this.resultTransform)}return Promise.resolve()}}let Le=class{};Le=(0,o.__decorate)([(0,a.Y)({providers:[(0,u.J)({provide:D.eP,scope:c.s.SINGLETON,useFactory:e=>()=>new xe({logger:e.logger("pubsub")}),deps:{logger:I.Fp}}),(0,u.J)({provide:D.k3,scope:c.s.REQUEST,useFactory:e=>{let{createPubsub:t}=e;return t()},deps:{createPubsub:D.eP}}),(0,u.J)({provide:D.Tm,scope:c.s.SINGLETON,useFactory:e=>{let{createPubsub:t}=e;return t()},deps:{createPubsub:D.eP}})]})],Le);let Pe=class{};Pe=(0,o.__decorate)([(0,a.Y)({providers:[]})],Pe);const Ve=[(0,u.J)({provide:h.E6,scope:c.s.REQUEST,useFactory:()=>{var e;let t;try{if(t=null===(e=document.getElementById("__TRAMVAI_STATE__"))||void 0===e?void 0:e.textContent,!t)throw Error("__TRAMVAI_STATE__ element is empty or missing");return JSON.parse(t)}catch(e){throw e instanceof Error&&(e.event="initial-state-parse-error",e.initialState=t,e.readyState=document.readyState,e.bodyComplete=!!window.__TRAMVAI_HTML_READY__),e}}}),(0,u.J)({provide:Se.Bi.listen,useFactory:e=>{let{commandLineRunner:t}=e;return function(){return t.run("client","customer")}},deps:{commandLineRunner:Se.S9},multi:!0})];var De=r(56873);const Fe=(0,A.V3)("child-app isChildApp Di"),je=(c.s.SINGLETON,c.s.SINGLETON,c.s.SINGLETON,c.s.SINGLETON,c.s.SINGLETON,c.s.SINGLETON,(0,te.y)("action state execution in server")),Ue=(0,v.L)("actionTramvai",{serverState:{}}).on(je,((e,t)=>Object.assign({},e,{serverState:t})));var Be=r(92366),Je=r.n(Be),He=r(59576),qe=r(20745),Ge=r(57801),We=r.n(Ge);const Ye=["message","conditionName","targetName"];class Ke extends Error{constructor(e){let{message:t="Condition failed",conditionName:r,targetName:o}=e,s=(0,n.Z)(e,Ye);super(t),this.name=Ke.errorName,this.conditionName=r,this.targetName=o,this.isSilent=!0,Object.assign(this,s)}}Ke.errorName="ConditionFailError";const Qe="global",Ze={};class ze{constructor(e,t,r,n,o){var s;this.globalConditionals=e,this.payload=t,this.parameters=r,this.executionState=n,this.type=o,this.status=!0,this.forbiddenMarker=!1,this.key=null,o===Qe&&(this.status="success"!==n.status),this.conditions=null!==(s=r.conditions)&&void 0!==s?s:Ze}check(){return this.globalConditionals.forEach((e=>{this.key=e.key,e.fn(this)})),this.getStatus()}setState(e){this.executionState.state[this.key]=e}getState(){return this.executionState.state[this.key]}forbid(){this.executionState.status="forbidden",this.executionState.forbiddenBy=this.key,this.forbiddenMarker=!0}allow(){this.status=!0}getStatus(){return!this.forbiddenMarker&&this.status}}class $e{constructor(){this.isResolved=()=>void 0!==this.resolveData,this.isRejected=()=>void 0!==this.rejectReason,this.reset=()=>{this.resolveData=void 0,this.rejectReason=void 0,this.promise=this.initPromise()},this.initPromise=()=>new Promise(((e,t)=>{this.resolve=t=>{this.resolveData=t,e(t)},this.reject=e=>{this.rejectReason=e,t(e)}})),this.promise=this.initPromise()}}const Xe={};var et=r(7605),tt=r.n(et),rt=r(24034),nt=r.n(rt),ot=r(5103),st=r.n(ot);const it="@@global",at={},ut={key:"pageServer",fn:e=>{e.conditions.pageServer&&e.type===Qe&&e.forbid()}},ct=[(0,u.J)({provide:Re.m1,useFactory:()=>(window.__TRAMVAI_DEFERRED_ACTIONS||(window.__TRAMVAI_DEFERRED_ACTIONS={}),{get(e){return window.__TRAMVAI_DEFERRED_ACTIONS[e]},set(e,t){window.__TRAMVAI_DEFERRED_ACTIONS[e]=t},has(e){return e in window.__TRAMVAI_DEFERRED_ACTIONS},forEach(e){Object.keys(window.__TRAMVAI_DEFERRED_ACTIONS).forEach((t=>{e(window.__TRAMVAI_DEFERRED_ACTIONS[t],t)}))}})})];let lt=class{};lt=(0,o.__decorate)([(0,a.Y)({providers:[(0,u.J)({provide:h.Ym,multi:!0,useValue:Ue}),(0,u.J)({provide:Re.R9,scope:c.s.SINGLETON,useClass:class{constructor(e){let{actionsList:t}=e;this.actions=new Map([[it,Q()(t)]])}add(e,t){const r=st()(t);this.actions.set(e,tt()(this.actions.has(e)?[...this.actions.get(e),...r]:r))}get(e,t){return tt()([...this.actions.get(e)||[],...t||[]])}getGlobal(){return this.actions.get(it)}remove(e,t){if(!t)return void this.actions.delete(e);const r=st()(t);this.actions.has(e)&&this.actions.set(e,nt()(this.actions.get(e),r))}},deps:{actionsList:l.I7}}),(0,u.J)({provide:Re.R$,scope:c.s.REQUEST,useClass:class{constructor(e){let{store:t,context:r,deferredActionsMap:n,di:o,executionContextManager:s,actionConditionals:i,transformAction:a}=e;this.actionConditionals=Q()(null!=i?i:[]),this.context=r,this.store=t,this.deferredActionsMap=n,this.di=o,this.executionContextManager=s,this.execution=new Map,this.transformAction=a||U();const u=t.getState(Ue);u&&u.serverState&&We()(((e,t)=>{this.execution.set(t,e)}),u.serverState)}async runInContext(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];var s;const i=n[0],a=!0===(null==e?void 0:e.values.pageActions)?Qe:"local",u=this.getActionParameters(t);if(!u)throw new Error("Cannot resolve internal data for action. Make sure you are using the result of `declareAction` call as an action");const c=this.getExecutionState(u.name);if(!this.canExecuteAction(i,u,c,a))return"reject"===u.conditionsFailResult?Promise.reject(new Ke({conditionName:null!==(s=c.forbiddenBy)&&void 0!==s?s:"unknown",targetName:u.name})):Promise.resolve();const l=u.deferred;if(l&&!this.deferredActionsMap.get(t.name)){const e=new $e;e.promise.catch((()=>{})),this.deferredActionsMap.set(t.name,e)}return c.status="pending",this.executionContextManager.withContext(e,{name:u.name,values:!0===(null==e?void 0:e.values.pageActions)?{pageActions:!1}:void 0},((r,o)=>{const s=this.createActionContext(e,r,o,u);return Promise.resolve().then((()=>{if((0,qe.J)(t)){const e=t.fn.apply(s,n),r=this.deferredActionsMap.get(t.name);return l?(r.isResolved()||r.isRejected()||!Je()(e)||e.then(r.resolve).catch(r.reject),Promise.resolve()):e}return t(this.context,i,s.deps)})).then((e=>(c.status="success",e))).catch((e=>{throw c.status="failed",e}))}))}async run(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return this.runInContext(null,e,...r)}canExecute(e){const t=this.getActionParameters(e),r=this.getExecutionState(t.name);return this.canExecuteAction(void 0,t,r,Qe)}getActionParameters(e){let t;return(0,qe.J)(e)?t=e:(this.transformAction(e),t=(e=>e[He.d])(e)),t}getExecutionState(e){let t=this.execution.get(e);return t||(t={status:"pending",state:{}},this.execution.set(e,t)),t}canExecuteAction(e,t,r,n){return new ze(this.actionConditionals,e,t,r,n).check()}createActionContext(e,t,r,n){return{abortController:r,abortSignal:null==t?void 0:t.abortSignal,executeAction:this.runInContext.bind(this,t),deps:n.deps?this.di.getOfDeps(n.deps):Xe,actionType:(null==e?void 0:e.values.pageActions)?"page":"standalone",dispatch:this.store.dispatch,getState:this.store.getState}}},deps:{actionConditionals:{token:Re.xW,optional:!0},context:V.l,store:h.kR,di:d.Z,executionContextManager:F.vV,transformAction:{token:"actionTransformAction",optional:!0},deferredActionsMap:Re.m1}}),(0,u.J)({provide:Re.FM,scope:c.s.REQUEST,useClass:class{constructor(e){var t;this.deps=e,this.log=e.logger("action:action-page-runner"),this.isChildAppRunner=null!==(t=e.isChildAppRunner)&&void 0!==t&&t}runActions(e,t){return void 0===t&&(t=()=>!1),this.deps.executionContextManager.withContext(this.deps.commandLineExecutionContext(),{name:"pageActions",values:{pageActions:!0}},(async(r,n)=>{const o=this.deps.router.registerHook("beforeNavigate",(function(){return o(),n.abort("Page actions were aborted because of route changing"),Promise.resolve()}));await Promise.all(e.map((e=>Promise.resolve().then((()=>this.deps.actionExecution.runInContext(r,e,at))).catch((r=>{var n;if(!(0,Ne.LG)(r)){const t=(0,qe.J)(e)?e:e[He.d];this.log.error({error:r,event:"action-execution-error",message:'An error occurred during "'+(null!==(n=null==t?void 0:t.name)&&void 0!==n?n:"unknown")+'" action execution'})}if(t(r))throw r}))))).finally((()=>{o()}))}))}},deps:{actionExecution:Re.R$,executionContextManager:F.vV,commandLineExecutionContext:F.p7,store:h.kR,limitTime:Re.D7,logger:I.Fp,deferredMap:Re.m1,responseTaskManager:(0,A.jt)(ee),serverResponseStream:(0,A.jt)(X),router:De.l1,isChildAppRunner:(0,A.jt)(Fe)}}),(0,u.J)({provide:Re.D7,useValue:500}),(0,u.J)({provide:Re.xW,multi:!0,useValue:[{key:"alwaysCondition",fn:e=>{e.conditions.always&&e.allow()}},{key:"onlyServer",fn:e=>{e.conditions.onlyServer&&e.forbid()}},{key:"onlyBrowser",fn:e=>{e.conditions.onlyBrowser}},ut,{key:"pageBrowser",fn:e=>{e.conditions.pageBrowser&&e.type}},{key:"dynamicCondition",fn:e=>{e.conditions.dynamic&&(e.getState()&&"browser"!==e.getState().environment||e.allow(),e.setState({environment:"browser"}))}}]}),...ct]})],lt);class dt{constructor(e){(e=e||{}).stores=e.stores||[],this.stores={},this.handlers={},e.stores.forEach((e=>{this.registerStore(e)}))}createContext(e,t,r){return new be(this,e,t,r)}hasStore(e){return!!this.stores[e.storeName]}registerStore(e){const{storeName:t}=e;this.stores[t]&&this.stores[t]===e||(this.stores[t]=e,e.handlers&&Object.keys(e.handlers).forEach((r=>{const n=e.handlers[r];this.registerHandler(r,t,n)})))}unregisterStore(e){const{storeName:t}=e;this.stores[t]&&(delete this.stores[t],e.handlers&&Object.keys(e.handlers).forEach((r=>{const n=e.handlers[r];this.unregisterHandler(r,t,n)})))}getStoreName(e){return"string"==typeof e?e:e.storeName}registerHandler(e,t,r){this.handlers[e]=this.handlers[e]||[],this.handlers[e].push({name:t,handler:r})}unregisterHandler(e,t,r){Array.isArray(this.handlers[e])&&(this.handlers[e]=this.handlers[e].filter((e=>!(e.name===t&&e.handler===r))))}}let pt=class{};pt=(0,o.__decorate)([(0,a.Y)({providers:[(0,u.J)({provide:h.qb,scope:c.s.SINGLETON,useFactory:e=>{let{stores:t}=e;return r={stores:t&&Q()(t)},new dt(r);var r},deps:{stores:h.Ym}}),(0,u.J)({provide:h.jm,scope:c.s.REQUEST,useFactory:e=>{let{dispatcher:t,initialState:r,middlewares:n}=e;return t.createContext({},r,[()=>e=>t=>e(t),...Q()(n||[])])},deps:{dispatcher:h.qb,middlewares:{token:h.PU,optional:!0},initialState:{token:h.E6,optional:!0}}}),(0,u.J)({provide:h.kR,scope:c.s.REQUEST,useFactory:e=>{let{dispatcherContext:t}=e;return{getState:t.getState.bind(t),dispatch:t.dispatch.bind(t),subscribe:t.subscribe.bind(t)}},deps:{dispatcherContext:h.jm}})]})],pt);var ht=r(16011),gt=r(65538);var vt=r(56868),ft=r.n(vt);const mt=(0,A.V3)("_cachesList"),yt=(0,A.V3)("cache names list");let Et=class{};Et=(0,o.__decorate)([(0,a.Y)({providers:[{provide:mt,scope:c.s.SINGLETON,useValue:[]},(0,u.J)({provide:ht.xC,scope:c.s.SINGLETON,useFactory:function(e){let{caches:t,cacheNames:r,metrics:n}=e;return function(e,r){void 0===e&&(e="memory");const n=function(e,t){return Object.assign({type:e,max:100},t)}(e,r),o=function(e,t){return void 0===e&&(e="memory"),new(ft())(t)}(e,n);return t.push(o),o}},deps:{caches:mt,cacheNames:{token:yt,optional:!0},metrics:{token:gt.P,optional:!0}}}),(0,u.J)({provide:ht.oK,scope:c.s.SINGLETON,useFactory:e=>{let{caches:t,onCacheClear:r}=e;return e=>(t.forEach((e=>e.clear())),r?Promise.all(r.map((t=>t(e)))):Promise.resolve())},deps:{caches:mt,onCacheClear:{token:ht.TZ,optional:!0}}})]})],Et);const bt=["message","contextName"];class Rt extends Error{constructor(e){let t=void 0===e?{}:e,{message:r="Execution Abort",contextName:o}=t,s=(0,n.Z)(t,bt);super(r),this.name=Rt.errorName,this.contextName=o,Object.assign(this,s)}}Rt.errorName="ExecutionAbortError";const wt={};var St=r(66598),_t=r(62054);class Nt{constructor(e){this.plugins=new Set,this.wrappers=new Set,this.name=e}tap(e,t){const r={name:e,fn:t};return this.plugins.add(r),()=>{this.plugins.delete(r)}}call(e){const t=Array.from(this.wrappers).reverse(),r=Array.from(this.plugins.values()),n={};let o,s=-1;const i=e=>{if(s++,s<t.length)return(0,t[s])(n,e,i);if(s===t.length)for(const t of r)o=t.fn(n,e,o);return o};return i(e)}wrap(e){this.wrappers.add(e)}}class Ct{constructor(e){this.plugins=new Set,this.wrappers=new Set,this.name=e}tap(e,t){const r={name:e,fn:t};return this.plugins.add(r),()=>{this.plugins.delete(r)}}tapPromise(e,t){const r={name:e,options:{type:"promise"},fn:t};return this.plugins.add(r),()=>{this.plugins.delete(r)}}tapAsync(e,t){const r={name:e,options:{type:"async"},fn:t};return this.plugins.add(r),()=>{this.plugins.delete(r)}}callPromise(e){const t=Array.from(this.wrappers).reverse(),r=Array.from(this.plugins.values()),n={};let o,s=-1;const i=async e=>{if(s++,s<t.length)return(0,t[s])(n,e,i);if(s===t.length)for(const t of r)"options"in t?"promise"===t.options.type?o=await t.fn(n,e,o):"async"===t.options.type&&(o=await new Promise(((r,s)=>{t.fn(n,e,o,((e,t)=>{e?s(e):r(t)}))}))):o=t.fn(n,e,o);return o};return i(e)}wrap(e){this.wrappers.add(e)}}class kt{constructor(e){this.plugins=new Set,this.wrappers=new Set,this.name=e}tap(e,t){const r={name:e,fn:t};return this.plugins.add(r),()=>{this.plugins.delete(r)}}tapPromise(e,t){const r={name:e,options:{type:"promise"},fn:t};return this.plugins.add(r),()=>{this.plugins.delete(r)}}tapAsync(e,t){const r={name:e,options:{type:"async"},fn:t};return this.plugins.add(r),()=>{this.plugins.delete(r)}}callPromise(e){const t=Array.from(this.wrappers).reverse(),r=Array.from(this.plugins.values()),n={};let o=-1;const s=async e=>{if(o++,o<t.length)return(0,t[o])(n,e,s);o===t.length&&await Promise.all(r.map((t=>{if("options"in t){if("promise"===t.options.type)return t.fn(n,e);if("async"===t.options.type)return new Promise(((r,o)=>{t.fn(n,e,void 0,((e,t)=>{e?o(e):r(t)}))}))}return t.fn(n,e)})))};return s(e)}wrap(e){this.wrappers.add(e)}}var Tt=r(45838);const Ot=(0,St.J)({name:"TramvaiHookModule",providers:[(0,u.J)({provide:_t.j,scope:c.s.SINGLETON,useClass:class{createSync(e){return new Nt(e)}createAsync(e){return new Ct(e)}createAsyncParallel(e){return new kt(e)}}}),(0,u.J)({provide:Tt.v,scope:c.s.SINGLETON,useClass:class{constructor(){this.hooks=Object.create(null)}registerHooks(e,t){this.hooks[e]||(this.hooks[e]=[]),this.hooks[e]=tt()(this.hooks[e].concat(t))}runHooks(e,t,r,n){const o=this.hooks[e];if(!o)return r;let s=r;for(let e=0;e<o.length;e++)s=o[e](t,s,n);return s}runAsyncHooks(e,t,r,n){const o=this.hooks[e];if(!o)return r;for(let e=0;e<o.length;e++){const s=o[e];setTimeout((()=>{s(t,r,n)}))}return r}runPromiseHooks(e,t,r){const n=this.hooks[e];return e=>{if(!n)return Promise.resolve(e);let o=0;return Promise.resolve(e).then((function e(s){const i=n[o++];return i?Promise.resolve(i(t,s,r)).then(e):s}))}}}})]}),At=["additionalBundleList"];let It=class{};It=(0,o.__decorate)([(0,a.Y)({imports:[Ot,Oe,m,Le,x,T,lt,pt,ae,ge,Et,Pe],providers:[(0,u.J)({provide:L.K,scope:c.s.SINGLETON,useClass:class{constructor(e){let{componentList:t}=void 0===e?{}:e;this.components={[Z]:Object.assign({},...Q()(null!=t?t:[]))}}add(e,t,r){void 0===r&&(r=Z);const n=this.components[r]||{};n[e]=t,this.components[r]=n}get(e,t){return void 0===t&&(t=Z),(this.components[t]||{})[e]||this.components[Z][e]}getComponentParam(e,t,r,n){return Y()([e],t,this.get(r,n))}},deps:{componentList:{token:"componentDefaultList",optional:!0}}}),(0,u.J)({provide:P.g,scope:c.s.SINGLETON,useFactory:e=>{let{additionalBundleList:t}=e,r=(0,n.Z)(e,At);return null==t||t.forEach((e=>{i()(((e,t)=>{t in r.bundleList||(r.bundleList[t]=()=>Promise.resolve({default:e}))}),e)})),new G(r)},deps:{bundleList:l.om,additionalBundleList:{token:P.x,optional:!0},componentRegistry:L.K,logger:I.Fp}}),(0,u.J)({provide:V.l,scope:c.s.REQUEST,useFactory:function(e){let{di:t,dispatcherContext:r,pubsub:n,store:o}=e;return new we({di:t,dispatcherContext:r,pubsub:n,store:o})},deps:{di:d.Z,pubsub:D.k3,dispatcherContext:h.jm,store:h.kR}}),(0,u.J)({provide:F.vV,scope:c.s.SINGLETON,useClass:class{async withContext(e,t,r){const n=(e=>"string"==typeof e?{name:e}:e)(t),{name:o,values:s=wt}=n,i=e?e.name+"."+o:o;if(null==e?void 0:e.abortSignal.aborted)throw new Rt({message:'Execution aborted in context "'+i+'"',reason:e.abortSignal.reason,contextName:i});const a=new AbortController;let u,c=s;e&&(c=Object.assign({},e.values,s),u=e=>{a.abort(e.target.reason)},e.abortSignal.addEventListener("abort",u));const l={name:i,abortSignal:a.signal,values:c};try{return await r(l,a)}catch(e){throw null===e||"object"!=typeof e||e.executionContextName||(e.executionContextName=l.name),e}finally{void 0!==u&&e&&e.abortSignal.removeEventListener("abort",u)}}}}),...Ve]})],It)},56956:function(e,t,r){"use strict";r.d(t,{w:function(){return c}});var n=r(80476),o=r(80283),s=r(97570),i=r(82342),a=r(33268);const u=[(0,s.J)({provide:a.O7,useFactory:e=>{let{logger:t}=e;const r=t("error-interceptor:error-boundary");return function(e,t){r.error({event:"component-did-catch",error:e,info:t})}},deps:{logger:i.Fp},multi:!0})];let c=class{};c=(0,n.__decorate)([(0,o.Y)({providers:[...u]})],c)},60531:function(e,t,r){"use strict";r.d(t,{XH:function(){return d}});r(66598);var n=r(97570),o=r(37621),s=r(49103),i=r.n(s),a=r(42353),u=r(58426);const c=(0,a.y)("FEATURE_TOGGLE"),l=(0,u.L)("featureToggle",{__values:{}}).on(c,((e,t)=>{const r={},n={};return i()(((e,t)=>{let{status:o,value:s}=e;!1!==o&&(r[t]=o),null!==o&&o===s||(n[t]=s)}),t),Object.assign({},r,{__values:n})})),d=(e,t)=>t[e];(0,n.J)({provide:o.Ym,useValue:l,multi:!0})},21377:function(e,t,r){"use strict";r.d(t,{J:function(){return Q}});var n=r(59999),o=r(80283),s=r(97570),i=r(29772),a=r(67584),u=r(9056),c=r(82342),l=r(82571),d=r(82912),p=r(10112),h=r(16011),g=r(13641),v=r.n(g),f=r(63119),m=r.n(f);function y(e,t,r){if(null==r?void 0:r.replace)return Object.assign({},e,t);const n=Object.assign({},e,t,{query:Object.assign({},e.query,t.query),headers:Object.assign({},e.headers,t.headers),interceptors:[...e.interceptors||[],...t.interceptors||[]]}),o=r=>{e[r]&&t[r]&&(n[r]=m()(t[r],e[r]))};return o("modifyRequest"),o("modifyResponse"),o("modifyError"),n}var E=r(33926),b=r(17848),R=r.n(b),w=r(4618),S=r(8605),_=r(90104),N=r(77367),C=r.n(N)()({}),k=r(33997),T=r(60491),O=r(32797),A=r(77172),I=r(21029),M=r(22422),x=r.n(M);const L="retry",P=["logger","name","disableCache","enableCircuitBreaker","createCache","cacheTime","defaultTimeout","validator","errorValidator","errorModificator","circuitBreakerOptions","getCacheKey","lruOptions","allowStale","agent","querySerializer","retryOptions","etagCacheOptions","interceptors"];var V=r(23302);const D=["method","body","requestType"],F=["modifyRequest","modifyResponse","modifyError","interceptors"];class j extends V.I{constructor(e){let{options:t,makeRequest:r}=e;super(),this._processMakeRequest=async(e,t)=>{let{modifyRequest:r,modifyResponse:n,modifyError:o}=t;const s=r?r(e):e,{method:i,body:a,requestType:u}=s,c=(0,E.Z)(s,D);i&&(c.httpMethod=i),a&&(c.payload=a),u&&(c.type=u);const l=this.makeRequest(c);try{const e=await l,t={payload:e,status:(0,O.lR)(l),headers:(0,O.wU)(l)};return n?n(t):t}catch(e){const t=l.getExternalMeta(),r=(0,O.lR)(l),n=(0,O.wU)(l),s=Object.assign(e,{__meta:t,status:r,headers:n});throw o?o(s,c):s}},this.options=t,this.makeRequest=r}request(e){const t=y(this.options,e),{modifyRequest:r,modifyResponse:n,modifyError:o,interceptors:s}=t,i=(0,E.Z)(t,F);let a=e=>this._processMakeRequest(e,{modifyRequest:r,modifyResponse:n,modifyError:o});return s&&Array.from(s).reverse().forEach((e=>{const t=a;a=r=>e(r,t)})),a(i)}fork(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),new j({options:y(this.options,e,t),makeRequest:this.makeRequest})}}const U=e=>e=>e,B={defaultTimeout:3e4};var J=r(68162),H=r(28296),q=r.n(H),G=r(72784);class W extends G.s{constructor(e){let{httpClientFactory:t,baseUrl:r}=e;super(t({name:"papi",baseUrl:r,validator:e=>{let{response:t}=e;if(!t.resultCode||!t.payload)return t.error||new Error(JSON.stringify(t))},modifyResponse(e){return Object.assign({},e,{payload:q()("payload",e.payload)})}}))}}const Y=(0,o.Y)({providers:[(0,s.J)({provide:u.J2,scope:a.s.SINGLETON,useClass:W,deps:{httpClientFactory:u.FB,baseUrl:J.a9}})]})(class{}),K=(0,n.V3)("httpClient createCache"),Q=(0,o.Y)({imports:[Y],providers:[(0,s.J)({provide:u.FB,useFactory:e=>{let{logger:t,envManager:r,appInfo:n,requestManager:o,headersList:s,createCache:i,makeRequestRegistry:a,agent:u,querySerializer:c,disableCircuitBreaker:l=!1,defaultOptions:d,defaultInterceptors:p,commandLineExecutionContext:h}=e;return e=>{var n;if(!e.name)throw Error('You need to pass a unique field "name" for the HTTP client instance');const o=r.get("HTTP_CLIENT_CACHE_DISABLED"),s=r.get("HTTP_CLIENT_CIRCUIT_BREAKER_DISABLED"),g={interceptors:p||[]},f=y(y(Object.assign({logger:t,agent:u,querySerializer:c,method:"GET",createCache:i?i.bind(null,"memory"):void 0,modifyRequest:m()(U(),(e=>e)),circuitBreakerOptions:{failureThreshold:75,minimumFailureCount:10},signal:null===(n=null==h?void 0:h())||void 0===n?void 0:n.abortSignal},B),d?y(d,g):g),e);if(v()(o)||(f.disableCache=!!o),l&&(f.enableCircuitBreaker=!1),v()(s)||(f.enableCircuitBreaker=!s),!a.has(f.name)){const e=Object.assign({},f);delete e.signal,a.set(f.name,function(e){const{logger:t,name:r,disableCache:n,enableCircuitBreaker:o,createCache:s,cacheTime:i=3e4,defaultTimeout:a,validator:u,errorValidator:c,errorModificator:l,circuitBreakerOptions:d={},getCacheKey:p,lruOptions:h={max:1e3,maxAge:i},allowStale:g=!0,agent:v,querySerializer:f,retryOptions:m,etagCacheOptions:y}=e,b=(0,E.Z)(e,P),N=(t&&t(r+":initialization"),e=>"function"==typeof s?t=>s(Object.assign({name:"http-client"+(e?"-"+e:"")+"-"+r},t)):void 0),M=[];return M.push({init:(e,t)=>{t({request:Object.assign({timeout:a},e.getRequest())})}}),M.push((0,A.Z)({baseUrl:b.baseUrl,transform:e=>{let{baseUrl:t,path:r,url:n}=e;if(n)return n;if(t&&r){const e=!("/"===t.slice(-1));return"/"===r.slice(0,1)&&(r=r.substring(1)),t+(e?"/":"")+r}return t||r||""}})),M.push((0,S.Z)({logger:t,name:r,showQueryFields:!0,showPayloadFields:!0})),M.push((0,k.Z)({shouldExecute:!n,lruOptions:h,allowStale:g,getCacheKey:p,memoryConstructor:N()})),M.push((0,_.Z)({shouldExecute:!n,getCacheKey:p})),o&&M.push((0,I.Z)(Object.assign({isSystemError:R()(O.o7,O.rA)},d))),M.push({error:(e,t)=>{const r=e.getState(),n=null==l?void 0:l(r);return n?t({error:n}):t()}}),m&&M.push(function(e){let{retry:t=0,retryDelay:r=100,maxTimeout:n=6e4}=void 0===e?{}:e;return{init:(e,t)=>{e.updateInternalMeta(L,{startTime:Date.now()}),t()},error:(e,o,s)=>{var i,a;const u=e.getRequest(),c=u.timeout||n,l=null!==(i=u.retry)&&void 0!==i?i:t,d=null!==(a=u.retryDelay)&&void 0!==a?a:r,{startTime:p}=e.getInternalMeta(L);let h=0;const g=()=>{h<l?setTimeout((()=>{const t=Date.now()-p;if(t>=c)return e.updateExternalMeta(L,{attempts:h,timeout:!0}),o();s(Object.assign({},u,{retry:0,timeout:c-t,silent:!0,retryDelay:void 0,cache:!1})).then((t=>(e.updateExternalMeta(L,{attempts:h+1}),o({status:w.qb.COMPLETE,response:t}))),(()=>{h++,g()}))}),x()([h],d)):(l>0&&e.updateExternalMeta(L,{attempts:h,timeout:!1}),o())};g()}}}(m)),(u||c)&&M.push((0,T.Z)({validator:u,errorValidator:c,allowFallback:!0})),(null==y?void 0:y.enabled)&&M.push(C({shouldExecute:!n,getCacheKey:p,memoryConstructor:N("etag"),lruOptions:(null==y?void 0:y.lruOptions)||{max:1e3,ttl:6e5}})),M.push((0,O.ZP)({agent:v||void 0,querySerializer:f||void 0})),(0,w.ZP)(M)}(e))}const b=a.get(f.name);return new j({options:f,makeRequest:b})}},deps:{logger:c.Fp,envManager:l.vC,appInfo:i.Qo,createCache:K,makeRequestRegistry:"makeRequestRegistry",requestManager:{token:d.G,optional:!0},headersList:{token:u.s,optional:!0},agent:{token:u.zn,optional:!0},disableCircuitBreaker:{token:u.pW,optional:!0},defaultOptions:{token:u.FF,optional:!0},defaultInterceptors:{token:u.Z0,optional:!0},commandLineExecutionContext:{token:p.p7,optional:!0}}}),(0,s.J)({provide:u.bV,useFactory:e=>{let{factory:t}=e;return t({name:"http-client",enableCircuitBreaker:!1})},deps:{factory:u.FB}}),(0,s.J)({provide:l.sQ,useValue:[{key:"HTTP_CLIENT_CACHE_DISABLED",optional:!0,dehydrate:!1},{key:"HTTP_CLIENT_CIRCUIT_BREAKER_DISABLED",optional:!0,dehydrate:!1}]}),(0,s.J)({provide:"makeRequestRegistry",scope:a.s.SINGLETON,useFactory:()=>new Map}),(0,s.J)({provide:K,scope:a.s.SINGLETON,useFactory:e=>{let{createCache:t}=e;return t},deps:{createCache:h.xC}}),(0,s.J)({provide:u.s,useValue:["x-request-id"]})]})(class{})},95943:function(e,t,r){"use strict";r.d(t,{X:function(){return s}});var n=r(80476),o=r(80283);let s=class{};s=(0,n.__decorate)([(0,o.Y)({imports:[],providers:[]})],s)},17167:function(e,t,r){"use strict";r.d(t,{p:function(){return s}});var n=r(80476),o=r(80283);let s=class{};s=(0,n.__decorate)([(0,o.Y)({providers:[]})],s)},27655:function(e,t,r){"use strict";r.d(t,{$:function(){return n}});const n=(0,r(59999).V3)("get cdn icon path token")},95283:function(e,t,r){"use strict";r.d(t,{Xn:function(){return X}});var n=r(80476),o=r(80283),s=r(69736),i=r(56873),a=r(80772),u=r(45838),c=r(49076),l=r(82912),d=r(17173),p=r(37621),h=r(92946),g=r(3566),v=r(33926),f=r(60028),m=r.n(f),y=r(78047),E=r(2198),b=r.n(E),R=r(79436),w=r.n(R),S=r(24970),_=r.n(S),N=r(58111),C=r.n(N),k=r(37093),T=r.n(k),O=r(60694),A=r.n(O),I=r(55500),M=r.n(I),x=r(11712),L=r.n(x);const P=e=>b().hash(e.toString()),V=_()(L(),w(),(e=>[e])),D=C()(((e,t)=>A()(((r,n)=>(r[e+n]=t[n],r)),{},M()(t))))("fingerprint_");const F=()=>{const e=function(){const e=function(){if(!window.WebGLRenderingContext)return!1;const e=document.createElement("canvas"),t=["webgl","experimental-webgl","moz-webgl"];let r=null;for(let n=0,o=t.length;n<o;++n)try{if(r=e.getContext(t[n]),r&&"function"==typeof r.getParameter)return r}catch(e){}return!1}();if(!e)return{};const t=e.getSupportedExtensions()||[],r=e.getParameter(e.SHADING_LANGUAGE_VERSION),n=e.getParameter(e.VENDOR),o=P(t.join("::")),s=t.length,i=e.getExtension("WEBGL_lose_context");return i&&i.loseContext&&i.loseContext(),{gpu_shading_language_version:r,gpu_vendor:n,gpu_extensions_hash:o,gpu_extensions_count:s}}();let t;try{t=function(){const e=document.createElement("canvas");e.width=2e3,e.height=200,e.style.display="inline";const t=e.getContext("2d");return t.rect(0,0,10,10),t.rect(2,2,6,6),t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.font="11pt no-real-font-123",t.fillText("Cwm fjordbank glyphs vext quiz, 😃",2,15),t.fillStyle="rgba(102, 204, 0, 0.2)",t.font="18pt Arial",t.fillText("Cwm fjordbank glyphs vext quiz, 😃",4,45),t.globalCompositeOperation="multiply",t.fillStyle="rgb(255,0,255)",t.beginPath(),t.arc(50,50,50,0,2*Math.PI,!0),t.closePath(),t.fill(),t.fillStyle="rgb(0,255,255)",t.beginPath(),t.arc(100,50,50,0,2*Math.PI,!0),t.closePath(),t.fill(),t.fillStyle="rgb(255,255,0)",t.beginPath(),t.arc(75,100,50,0,2*Math.PI,!0),t.closePath(),t.fill(),t.fillStyle="rgb(255,0,255)",t.arc(75,75,75,0,2*Math.PI,!0),t.arc(75,75,25,0,2*Math.PI,!0),t.fill("evenodd"),P(e.toDataURL())}()}catch(e){t=null}const r=window.navigator.platform,n=(new Date).getTimezoneOffset(),o=window.navigator.language,s=(window.navigator.languages||[]).join(",");return D(Object.assign({},e,{device_platform:r,client_timezone:n,client_language:o,canvas:t,accept_language:s}))};var j=r(44907);const U=["lt"],B=m()(["query","ticket"]);var J=r(58626),H=r(54211);const q=m()(["config","keepLinkAuth"]);var G=r(59999);const W=(0,G.V3)("linkAuthService"),Y=(0,G.V3)("linkAuthFailedService"),K=[{provide:W,useClass:class{constructor(e){let{sessionManager:t,hooks:r,apiClient:n,wuid:o,context:s,requestManager:i,pubsub:a}=e;this.sessionManager=t,this.hooks=r,this.apiClient=n,this.wuid=o,this.context=s,this.requestManager=i,this.pubsub=a}async authenticate(e){try{const{lt:t}=e,r=(0,v.Z)(e,U),n=await this.getClientInfo(),o=await this.transformAuthPayload(Object.assign({},n,e.payload),e);this.sessionManager.getSessionId()||await this.sessionManager.authenticate();const s=await this.signUp(Object.assign({},r,{query:Object.assign({},e.query,{lt:t}),body:o}));return await this.saveSession(s),await this.afterAuth(s),s}catch(e){throw await this.afterAuthFail(e),e}}async getLinkParameters(e){return this.apiClient.request(Object.assign({},e,{path:"link_parameters"})).then((e=>{let{payload:t}=e;return t}))}getLinkTokenFromUrl(){const e=this.getCurrentUrl();return this.hooks.runHooks(j.Wx,this.context,B(e),e)}getCurrentUrl(){let e;return e=window.location.href,(0,y.Qc)(e)}async getClientInfo(){const e=await(async()=>{const e=F(),t=(()=>{const e=[];try{for(let t=0;t<navigator.plugins.length;t++){const r=navigator.plugins[t];e.push([r.name.replace(/;|::/g,""),r.description.replace(/;|::/g,""),T()((e=>[e.type,e.suffixes].join("~").replace(/;|::/g,"")),V(r)).join(",")].join("::"))}}catch(e){}return e})().join(";"),r=navigator.userAgent.replace(/;|::/g,""),n=[window.screen.width,window.screen.height,window.screen.colorDepth].join("x"),o=(new Date).getTimezoneOffset(),s=(()=>{try{return!!window.sessionStorage}catch(e){}return!1})(),i=[r,n,o,!!document.cookie,s,t].join("###");return Promise.resolve({params:e,result:i})})();return Object.assign({wuid:this.wuid,fingerprint:e.result},e.params)}async saveSession(e){return this.sessionManager.updateSessionStatus(e.sessionId)}async signUp(e){return this.apiClient.request(Object.assign({timeout:6e4,confirmViewType:"linkAuth",confirmHide:!1},e,{method:"post",path:"sign_up",cache:!1,silent:!0})).then((e=>e.payload))}async transformAuthPayload(e,t){return this.hooks.runPromiseHooks(j.Oi,this.context,t)(e)}async afterAuth(e){return this.pubsub.publish(j.i,e)}async afterAuthFail(e){var t,r;const n=null!==(t=null==e?void 0:e.message)&&void 0!==t?t:"unknown error",o=null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:"no error stack available";return this.pubsub.publish(j.a,{message:n,stack:o})}},deps:{sessionManager:s.db,hooks:u.v,apiClient:h.JB,wuid:g.$,context:c.l,requestManager:l.G,pubsub:d.k3}},{provide:a.Bi.resolvePageDeps,useFactory:e=>{let{pageService:t,store:r,linkAuthService:n,sessionManager:o}=e;return async function(){const e=n.getLinkTokenFromUrl(),s=t.getCurrentRoute(),i=q(s),a=r.getState(H.p);if(!e&&!i&&(0,J.HS)(a))return o.replaceWithNewSession()}},deps:{pageService:i.Y9,store:p.kR,linkAuthService:W,sessionManager:s.db},multi:!0}];var Q=r(52141),Z=r.n(Q),z=r(13641),$=r.n(z);let X=class{};X=(0,n.__decorate)([(0,o.Y)({providers:[...K,{provide:s.sI,useClass:class{constructor(e){let{linkAuthService:t,sessionManager:r,linkAuthFailedService:n,pageService:o}=e;this.linkAuthFailedService=n,this.linkAuthService=t,this.sessionManager=r,this.pageService=o}authenticate(e){let{success:t,pass:r}=e;const n=this.linkAuthService.getLinkTokenFromUrl();if(!n)return r();this.linkAuthService.authenticate({lt:n,confirmHide:!0}).then(t).catch((()=>this.sessionManager.logout().then(this.removeTicketFromUrl.bind(this)).then((()=>{if(!$()(this.linkAuthFailedService))return this.linkAuthFailedService.execute()})).then(r)))}removeTicketFromUrl(){const e=this.linkAuthService.getCurrentUrl(),t=Z()(["ticket"],e.query),r=(0,y.WU)(Object.assign({},Z()(["search"],e),{query:t}));return this.pageService.navigate({url:r})}get name(){return"LinkStrategy"}},deps:{pageService:i.Y9,linkAuthService:W,sessionManager:s.db,linkAuthFailedService:{token:Y,optional:!0}},multi:!0}]})],X)},44907:function(e,t,r){"use strict";r.d(t,{Oi:function(){return n},Wx:function(){return o},a:function(){return i},i:function(){return s}});const n="module:link-auth:payload:transform",o="module:link-auth:token:get",s="module:link-auth:auth",i="module:link-auth:auth-fail"},92122:function(e,t,r){"use strict";r.d(t,{Ai:function(){return h}});var n=r(97570),o=r(66598),s=r(67570),i=r(33268),a=r(8479),u=r(67584),c=r(29376),l=r(49076),d=r(53402);const p=[{provide:"boundaryCollect",useFactory:e=>{let t=!1;return r=>{var n;if(!t)if(t=!0,void 0!==r)e.eventea.send({project:"application-health",event:"app-start-fail",payload:{errorMessage:r.message,errorStack:r.stack}});else{let t;try{window.performance.mark("application-health-app-start-success"),t=null===(n=window.performance.measure("application-health-app-start-success-duration","navigationStart","application-health-app-start-success"))||void 0===n?void 0:n.duration}catch(e){}e.eventea.send({project:"application-health",event:"app-start-success",payload:{userRole:e.getUserRole(),installType:e.installType,durationFromNavigationStart:t}})}}},deps:{eventea:s.Bv,getUserRole:"getUserRole",installType:d.h}},{provide:a.RENDERER_CALLBACK,useFactory:e=>{let{boundaryCollect:t}=e;return t},deps:{boundaryCollect:"boundaryCollect"},multi:!0},{provide:i.O7,useFactory:e=>{let{boundaryCollect:t}=e;return t},deps:{boundaryCollect:"boundaryCollect"},multi:!0},{provide:d.h,useValue:"unknown"},{provide:"getUserRole",scope:u.s.SINGLETON,useFactory(e){let{context:t}=e;return()=>{const{roles:e}=t.getState();return e?c.TF(e)?"anonymous":c.C5(e)?"client":c.QO(e)?"lightClient":"unknown":"inaccessible"}},deps:{context:l.l}},(0,n.J)({provide:s.eW,multi:!0,useValue:{project:"application-health"}})],h=(0,o.J)({name:"MonitoringApplicationHealthModule",providers:p})},53402:function(e,t,r){"use strict";r.d(t,{h:function(){return n}});const n=(0,r(59999).V3)("INSTALL_TYPE")},26442:function(e,t,r){"use strict";r.d(t,{AO:function(){return i}});var n,o=r(80476),s=r(80283);let i=n=class{static forRoot(e){let{config:t}=e;return{mainModule:n,providers:[]}}};i=n=(0,o.__decorate)([(0,s.Y)({providers:[]})],i)},4948:function(e,t,r){"use strict";r.d(t,{II:function(){return w}});var n=r(66598),o=r(97570),s=r(80772),i=r(82571),a=r(56003),u=r(8479),c=r(56873),l=r(17624);const d="__default",p="__csr_fallback__",h="TRAMVAI_FORCE_CLIENT_SIDE_RENDERING",g={name:p,path:"/__csr_fallback__/",config:{bundle:d,pageComponent:p}},v=(0,n.J)({name:"ForceCSRModule",providers:[(0,o.J)({provide:i.sQ,useValue:[{key:h,optional:!0}]}),(0,o.J)({provide:u.TRAMVAI_RENDER_MODE,useFactory:e=>{let{envManager:t}=e;return"true"===t.get(h)?"client":"ssr"},deps:{envManager:i.vC}}),(0,o.J)({provide:s.Bi.listen,useFactory:e=>{let{componentRegistry:t,fallback:r,envManager:n}=e;return function(){"true"===n.get(h)&&t.add(p,r,d)}},deps:{componentRegistry:a.K,fallback:{token:l.VT,optional:!0},envManager:i.vC}}),(0,o.J)({provide:s.Bi.customerStart,useFactory:e=>{let{router:t,envManager:r}=e;return function(){"true"===r.get(h)&&t.addRoute(g)}},deps:{router:c.l1,envManager:i.vC}})]});var f=r(90130),m=r(44121),y=r(44488);const E=e=>{let{children:t}=e;const[r,n]=(0,m.useState)(!1),o=(0,y.x)(c.Y9),s=(0,y.x)(l.EO),i=(0,y.x)(l.wP),a=(0,y.x)({token:l.VT,optional:!0}),u=o.resolveComponentFromConfig(s)||a,d=(e=>{let{pageService:t,defaultRenderMode:r}=e;var n;const{pageComponent:o,pageRenderMode:s}=t.getConfig(),{renderMode:i}=null!==(n=t.getComponent(o))&&void 0!==n?n:{},a=s||i||r;return"function"==typeof a?a():a})({pageService:o,defaultRenderMode:i});return(0,m.useEffect)((()=>{"client"===d&&n(!0)}),[]),"client"!==d||r?(0,f.jsx)(f.Fragment,{children:t}):u?(0,f.jsx)(u,{}):null},b=e=>t=>(0,f.jsx)(E,{children:(0,f.jsx)(e,Object.assign({},t))}),R=[(0,o.J)({provide:u.LAYOUT_OPTIONS,multi:!0,useFactory:e=>{let{wrapperType:t}=e;return{wrappers:{[t]:b}}},deps:{wrapperType:l.g2}}),(0,o.J)({provide:l.EO,useValue:"pageRenderFallback"}),(0,o.J)({provide:l.wP,useFactory:e=>{let{tramvaiRenderMode:t}=e;return t},deps:{tramvaiRenderMode:u.TRAMVAI_RENDER_MODE}}),(0,o.J)({provide:l.g2,useValue:"page"})],w=(0,n.J)({name:"PageRenderModeModule",imports:[v],providers:[...R]})},17624:function(e,t,r){"use strict";r.d(t,{EO:function(){return s},VT:function(){return u},g2:function(){return a},wP:function(){return i}});var n=r(59999),o=r(67584);const s=(0,n.V3)("pageRenderFallbackComponentName"),i=(0,n.V3)("pageRenderDefaultMode"),a=(0,n.V3)("pageRenderWrapperType"),u=(0,n.V3)("pageRenderDefaultFallbackComponent",{scope:o.s.SINGLETON})},34469:function(e,t,r){"use strict";r.d(t,{N:function(){return n}});const n=(0,r(66598).J)({name:"PreconnectResourcesModule",providers:[],extend:{forRoot:()=>[]}})},91287:function(e,t,r){"use strict";r.d(t,{tH:function(){return E}});var n=r(66598),o=r(97570),s=r(59999),i=r(8479),a=r(82571),u=r(10650),c=r(67584);const l=[(0,o.J)({provide:u.bK,scope:c.s.SINGLETON,useFactory:()=>"/"})],d=[(0,o.J)({provide:u.bK,useValue:"/"}),(0,o.J)({provide:u.jz,useValue:"/sw.js",deps:{swScope:u.bK}})];var p=r(80772),h=r(82342);const g=(0,o.J)({provide:p.Bi.init,useFactory:e=>{let{workbox:t,logger:r}=e;const n=r("pwa:workbox");return function(){(async()=>{try{const e=await t();if(!e)return void n.info("Service Worker registration stopped");await e.register()}catch(e){n.error({event:"register-failed",message:"Service Worker registration failed",error:e})}})()}},deps:{workbox:u.qE,logger:h.Fp}}),v=(0,o.J)({provide:u.qE,scope:c.s.SINGLETON,useFactory:e=>{let{swUrl:t,swScope:n,logger:o}=e;const s=o("pwa:workbox");let i=null;return async()=>{if(!("serviceWorker"in navigator))return s.info("Service Worker is not supported"),i;if(i)return i;const{Workbox:e}=await r.e("tramvai-workbox-window").then(r.bind(r,20323));return i=new e(t,{scope:n}),i.addEventListener("installed",(e=>{e.isUpdate})),i}},deps:{swUrl:u.jz,swScope:u.bK,logger:h.Fp}}),f=(0,n.J)({name:"TramvaiPwaWorkboxModule",providers:[...l,(0,o.J)({provide:u.jz,useFactory:e=>{let{swScope:t,modern:r,envManager:n,swParams:o}=e;const s=((e,t)=>{const r=e.startsWith("/")?e:"/"+e;return""+t.replace(/\/$/,"")+r})("sw.js",t);n.get("TRAMVAI_FORCE_CLIENT_SIDE_RENDERING");let i=s;if(o&&o.length){const e=o.filter(Boolean).reduce(((e,t)=>e.concat(Object.keys(t).map((e=>encodeURIComponent(e)+"="+encodeURIComponent(t[e]))))),[]).join("&");e&&(i+="?"+e)}return i},deps:{swScope:u.bK,modern:i.MODERN_SATISFIES_TOKEN,envManager:a.vC,swParams:(0,s.jt)(u.sn)}}),v,g]}),m=((0,n.J)({name:"TramvaiPwaLightWorkboxModule",providers:[...d,v,g]}),(0,n.J)({name:"TramvaiPwaManifestModule",providers:[]})),y=((0,n.J)({name:"TramvaiPwaLightManifestModule",providers:[]}),(0,n.J)({name:"TramvaiPwaMetaModule",providers:[]})),E=(0,n.J)({name:"TramvaiPwaModule",imports:[f,m,y],providers:[]})},10650:function(e,t,r){"use strict";r.d(t,{bK:function(){return i},jz:function(){return s},qE:function(){return o},sn:function(){return a}});var n=r(59999);const o=(0,n.V3)("pwa workbox"),s=(0,n.V3)("pwa sw url"),i=(0,n.V3)("pwa sw scope"),a=(0,n.V3)("pwa sw params",{multi:!0})},35384:function(e,t,r){"use strict";r.d(t,{K0:function(){return o},pc:function(){return i},wl:function(){return s}});var n=r(59999);const o=(0,n.V3)("service worker params",{multi:!0}),s=(0,n.V3)("service worker init command line"),i=(0,n.V3)("pwa disable meta theme_color")},88693:function(e,t,r){"use strict";r.d(t,{sm:function(){return ae}});var n=r(80476),o=r(80283),s=r(97570),i=r(80772),a=r(16842),u=r(59999),c=r(37621),l=r(82342),d=r(49076),p=r(8479),h=r(16254),g=r(57038),v=r(10776),f=r(44121),m=r(27714),y=r.n(m),E=r(96980);const b=/Minified React error #(\d+);/;let R,w;try{R=r(64054).a,w=r(44121).startTransition}catch(e){}const S=e=>{let{children:t,callback:r}=e;return(0,E.L)(r,[]),t};var _=r(90130),N=r(33268),C=r(38003),k=r(15434),T=r.n(k),O=r(90794);const A=e=>{let{context:t,children:r,serverState:n}=e;return(0,_.jsx)(O.h.Provider,{value:t,children:(0,_.jsx)(O.N.Provider,{value:n,children:r})})};var I=r(43158),M=r(54143),x=r(44488),L=r(56873);const P=()=>((0,M.y)(),(0,x.x)(L.Y9));var V=r(81935),D=r(73752),F=r(36840);const j=e=>{const{children:t}=e,r=(0,x.x)(L.Y9),n=(0,V.w)(),o=(0,F.o)(g.oB),s=(0,f.useMemo)((()=>o&&(0,D.F)(o)),[o]),i=(0,x.x)({token:N.O7,optional:!0}),a=(0,x.x)({token:N.Ek,optional:!0}),u=r.resolveComponentFromConfig("errorBoundary");return(0,_.jsx)(C.E,{url:n,error:s,errorHandlers:i,fallback:u,fallbackFromDi:a,children:t})},U=e=>{let{children:t}=e;const r=P(),n=r.resolveComponentFromConfig("layout"),o=r.resolveComponentFromConfig("header"),s=r.resolveComponentFromConfig("footer");return(0,f.useMemo)((()=>(0,_.jsx)(n,{Header:o,Footer:s,children:t})),[n,o,s,t])},B=e=>{let{children:t}=e;const r=P().resolveComponentFromConfig("nestedLayout");return(0,f.useMemo)((()=>(0,_.jsx)(r,{children:t})),[r,t])},J=()=>{const e=P(),{pageComponent:t}=e.getConfig();let r=e.getComponent(t);return r||(r=()=>{throw new Error("Page component '"+t+"' not found")}),(0,f.useMemo)((()=>(0,_.jsx)(j,{children:(0,_.jsx)(r,{})})),[r])},H=()=>{const e=(0,f.useMemo)((()=>(0,_.jsx)(J,{})),[]),t=(0,f.useMemo)((()=>(0,_.jsx)(B,{children:e})),[e]);return(0,_.jsx)(U,{children:t})},q=e=>{let{extendRender:t,di:r,consumerContext:n}=e,o=function(e,t){let{di:r}=e;const n=r.get({token:c.E6,optional:!0});return(0,_.jsx)(A,{context:t,serverState:null==n?void 0:n.stores,children:(0,_.jsx)(I.n.Provider,{value:r,children:(0,_.jsx)(H,{})})})}({di:r},n);return t&&T()((e=>{o=e(o)}),t),o},G=e=>{let{extendRender:t,useStrictMode:r,di:n,consumerContext:o}=e,s=q({di:n,consumerContext:o,extendRender:t});return r&&(s=(0,f.createElement)(f.StrictMode,null,s)),s},W=e=>{let{defaultErrorBoundary:t,di:r,consumerContext:n,extendRender:o,customRender:s,useStrictMode:i}=e;const a={di:r,consumerContext:n,extendRender:o,customRender:s,useStrictMode:i},u=r.get({token:N.O7,optional:!0}),c=r.get({token:N.Ek,optional:!0});return(0,_.jsx)(C.E,{fallback:t,errorHandlers:u,fallbackFromDi:c,children:(0,_.jsx)(G,Object.assign({},a))})};var Y=r(67584),K=r(30353),Q=r.n(K);const Z=e=>Array.isArray(e)?e:[e],z=(e,t)=>Z(null!=t?t:[]).reduce(((e,t)=>t(e)),e);var $=r(33926);const X=["children"],ee=["header","footer","layout","content","page"],te=e=>{let{children:t}=e;return t},re=e=>{let{children:t}=e;return t((0,$.Z)(e,X))},ne=e=>{let{children:t}=e;return t};let oe=class{};oe=(0,n.__decorate)([(0,o.Y)({providers:[{provide:p.DEFAULT_LAYOUT_COMPONENT,scope:Y.s.SINGLETON,useFactory:e=>{let{layoutOptions:t}=e;var r;return function(e){let{components:t={},wrappers:r={}}=void 0===e?{}:e;const{header:n=re,footer:o=re,layout:s=te,content:i=te,page:a=te}=t,u=(0,$.Z)(t,ee),c=z(s,r.layout),l=z(i,r.content),d=z(a,r.page),p=z(n,r.header),h=z(o,r.footer),g=Object.keys(u).map((e=>({name:e,Component:z(u[e],r[e])}))),v=e=>{let{children:t,Header:r,Footer:n}=e;return(0,_.jsxs)(c,{children:[g.map((e=>{let{Component:t,name:r}=e;return(0,_.jsx)(t,{},r)})),(0,_.jsxs)(l,{children:[r?(0,_.jsx)(p,{children:e=>(0,_.jsx)(r,Object.assign({},e))}):null,(0,_.jsx)(d,{children:t}),n?(0,_.jsx)(h,{children:e=>(0,_.jsx)(n,Object.assign({},e))}):null]})]})};return v.displayName="Layout",v}((r=t,Q()(null!=r?r:[]).reduce(((e,t)=>{const{components:r,wrappers:n}=e;return t.components&&Object.assign(r,t.components),t.wrappers&&Object.keys(t.wrappers).forEach((e=>{n[e]||(n[e]=[]),n[e].push(...Z(t.wrappers[e]))})),e}),{components:{},wrappers:{}})))},deps:{layoutOptions:{token:p.LAYOUT_OPTIONS,optional:!0}}},{provide:"componentDefaultList",scope:Y.s.SINGLETON,multi:!0,useFactory:e=>Object.assign({},e,{nestedLayoutDefault:ne}),deps:{layoutDefault:p.DEFAULT_LAYOUT_COMPONENT,footerDefault:{token:p.DEFAULT_FOOTER_COMPONENT,optional:!0},headerDefault:{token:p.DEFAULT_HEADER_COMPONENT,optional:!0},errorBoundaryDefault:{token:p.DEFAULT_ERROR_BOUNDARY_COMPONENT,optional:!0}}}]})],oe);const se=[(0,s.J)({provide:c.Ym,multi:!0,useValue:g.oB}),(0,s.J)({provide:p.TRAMVAI_RENDER_MODE,useValue:"ssr"})];var ie;let ae=ie=class{static forRoot(e){let{mode:t,useStrictMode:r}=e;const n=[];return"string"!=typeof t&&"boolean"!=typeof r||n.push({provide:p.USE_REACT_STRICT_MODE,useValue:null!=r?r:"strict"===t}),{mainModule:ie,providers:n}}};ae=ie=(0,n.__decorate)([(0,o.Y)({imports:[oe],providers:[...se,(0,s.J)({provide:h.Yv,multi:!0,useFactory:e=>{let{store:t}=e;return async()=>{t.getState(g.oB)&&t.dispatch((0,g.IL)(null))}},deps:{store:c.kR}}),(0,s.J)({provide:p.RESOURCES_REGISTRY,useFactory:e=>{let{logger:t}=e;return{getPageResources:()=>[],register:()=>{}}},deps:{logger:l.Fp}}),(0,s.J)({provide:i.Bi.generatePage,useFactory:e=>function(){return window.contextExternal=e.consumerContext,function(e){let{logger:t,consumerContext:n,customRender:o,extendRender:s,di:i,useStrictMode:a,rendererCallback:u,renderMode:c,defaultErrorBoundary:l}=e;const d=t("module-render");return new Promise(((e,t)=>{if(o)return o(q({extendRender:s,di:i,consumerContext:n}));const p=e=>null==u?void 0:u.forEach((t=>{try{t(e)}catch(e){console.error(e)}})),h={element:(0,f.createElement)(W,{defaultErrorBoundary:l,extendRender:s,customRender:o,useStrictMode:a,consumerContext:n,di:i}),container:()=>document.querySelector(".application"),callback:()=>{d.debug("App rendering"),document.querySelector("html").classList.remove("no-js"),p(),e()},log:d,renderMode:c};try{(e=>{let{element:t,container:n,callback:o,log:s,renderMode:i}=e;if("function"==typeof R){const e=(0,f.createElement)(S,{callback:o},t);let r=new Map;const a=y()(50,(()=>{if(0===r.size)return;const[{error:e,errorInfo:t},...n]=Array.from(r.values());r=new Map,s.error({event:"hydrate:recover-after-error",error:e,errorInfo:t,otherErrors:n})})),u=()=>w((()=>{R(n(),e,{onRecoverableError:(e,t)=>{var n,o;const s=(null!==(n=null==e?void 0:e.message)&&void 0!==n?n:"").match(b),i=null!==(o=null==s?void 0:s[1])&&void 0!==o?o:null==e?void 0:e.message;r.has(i)||("string"==typeof(null==t?void 0:t.componentStack)&&(t.componentStack=t.componentStack.split("\n").slice(0,15).join("\n")),r.set(i,{error:e,errorInfo:t})),a()}})}));return void("streaming"===i?window.__TRAMVAI_DEFERRED_HYDRATION?u():window.__TRAMVAI_DEFERRED_HYDRATION=u:u())}const{hydrate:a}=r(90776);a(t,n(),o)})(h)}catch(e){p(e),t(e)}}))}(e)},deps:{logger:l.Fp,customRender:{token:p.CUSTOM_RENDER,optional:!0},extendRender:{token:p.EXTEND_RENDER,optional:!0},rendererCallback:{token:p.RENDERER_CALLBACK,optional:!0},consumerContext:d.l,di:a.Z,useStrictMode:p.USE_REACT_STRICT_MODE,renderMode:(0,u.jt)(p.REACT_SERVER_RENDER_MODE),defaultErrorBoundary:(0,u.jt)(p.DEFAULT_ERROR_BOUNDARY_COMPONENT)},multi:!0}),(0,s.J)({provide:p.RENDERER_CALLBACK,useFactory:e=>{let{consumerContext:t}=e;return()=>{t.di.register({provide:"__TRAMVAI_HYDRATED",useValue:!0})}},deps:{consumerContext:d.l}}),(0,s.J)({provide:p.USE_REACT_STRICT_MODE,useFactory:e=>{let{deprecatedMode:t}=e;return"strict"===t},deps:{deprecatedMode:p.RENDER_MODE}}),(0,s.J)({provide:p.RENDER_MODE,useValue:"legacy"}),(0,s.J)({provide:p.MODERN_SATISFIES_TOKEN,useFactory:e=>{let{cookieManager:t}=e;const r=t.get("_t_modern");return("true"===r||"false"===r)&&JSON.parse(r)},deps:{cookieManager:v.T}}),(0,s.J)({provide:p.REACT_SERVER_RENDER_MODE,useValue:"sync"})]})],ae)},90188:function(e,t,r){"use strict";r.d(t,{uQ:function(){return s}});var n=r(80476),o=r(80283);let s=class{};s=(0,n.__decorate)([(0,o.Y)({providers:[]})],s)},16254:function(e,t,r){"use strict";r.d(t,{Ct:function(){return p},FZ:function(){return s},P$:function(){return d},U5:function(){return o},Yv:function(){return a},jB:function(){return c},p$:function(){return i},rZ:function(){return u},vR:function(){return l}});var n=r(59999);const o=(0,n.V3)("router routerClassToken"),s=(0,n.V3)("router additionalParameters"),i=(0,n.V3)("router onChangeHooks",{multi:!0}),a=(0,n.V3)("router beforeResolveHooks",{multi:!0}),u=(0,n.V3)("router beforeNavigateHooks",{multi:!0}),c=(0,n.V3)("router afterNavigateHooks",{multi:!0}),l=(0,n.V3)("router beforeUpdateCurrentHooks",{multi:!0}),d=(0,n.V3)("router afterUpdateCurrentHooks",{multi:!0}),p=(0,n.V3)("router finalRouteTransform")},57038:function(e,t,r){"use strict";r.d(t,{IL:function(){return i},oB:function(){return a}});var n=r(42353),o=r(58426),s=r(73752);const i=(0,n.y)("setPageError"),a=(0,o.L)("pageError",null).on(i,((e,t)=>t&&(0,s.X)(t)))},14908:function(e,t,r){"use strict";r.d(t,{L$:function(){return s},Qk:function(){return i},sH:function(){return a}});var n=r(42353),o=r(58426);const s=(0,n.y)("SET_CURRENT_ROUTE"),i=(0,n.y)("SET_URL_ON_REHYDRATE"),a=(0,o.L)("router",{currentRoute:null,previousRoute:null,currentUrl:null,previousUrl:null}).on(s,((e,t)=>{let{to:r,from:n,url:o,fromUrl:s,replace:i}=t;return{currentRoute:r,previousRoute:i?e.previousRoute:n,currentUrl:o,previousUrl:i?e.previousUrl:s}})).on(i,((e,t)=>Object.assign({},e,{currentUrl:t})))},56535:function(e,t,r){"use strict";r.d(t,{z:function(){return s}});var n=r(80476),o=(r(48945),r(80283));let s=class{};s=(0,n.__decorate)([(0,o.Y)({providers:[]})],s)},3827:function(e,t,r){"use strict";r.d(t,{m9:function(){return se}});var n=r(80476),o=r(42282),s=r.n(o),i=r(80283),a=r(97570),u=r(67584),c=r(78377),l=r(37621),d=r(30353),p=r.n(d),h=r(28288),g=r.n(h),v=r(56873),f=r(49076),m=r(49103),y=r.n(m);class E{constructor(){this.state=new Map}eachMeta(e){this.state.forEach(((t,r)=>e(t,r)))}updateStateByPriority(e,t){const r=this.state.get(e);(!r||t.priority>=r.priority)&&this.state.set(e,t)}updateMeta(e,t){return y()(((t,r)=>{(t||null===t)&&this.updateStateByPriority(r,{value:t,priority:e})}),t),this}get(e){return this.state.get(e)}reset(){this.state.clear()}getSerializableState(){return Array.from(this.state.entries())}mergeValuesFromSerializableState(e){e.forEach((e=>{let[t,r]=e;this.updateStateByPriority(t,r)}))}}var b=r(19525),R=r(79351),w=r(42353),S=r(58426);const _=(0,w.y)("set application metaWalk state"),N=(0,S.L)("appMeta",{serverMetaWalkState:[]}).on(_,((e,t)=>Object.assign({},e,{serverMetaWalkState:t})));var C=r(16842),k=r(79436),T=r.n(k),O=r(77125),A=r.n(O);const I=e=>A()("tag",e)?e:null;class M{constructor(e){let{list:t,transformValue:r=T(),converters:n={},metaWalk:o}=e;this.listSources=t,this.transformValue=r,this.converters=n,this.metaWalk=null!=o?o:new E}dataCollection(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.listSources.map((e=>e(this.metaWalk,...t)));let n=[];return this.metaWalk.eachMeta(((e,t)=>{if(null!==e.value){const r=this.transformValue(e),o=(this.converters[t]||I)(r.value);o&&(n=n.concat(s()(o)?o.filter(T()):o))}})),n}}const x="data-meta-dynamic",L=e=>{let{tag:t,attributes:r,innerHtml:n}=e;const o=document.createElement(t);return n&&(o.innerHTML=n),r&&y()(((e,t)=>{o.setAttribute(t,e||"")}),r),o.setAttribute(x,"true"),o};class P{constructor(e){this.meta=e}patchMeta(e){let{head:t,addTags:r,removeTagsArray:n}=e,o=!1;r.forEach((e=>{let r;if("title"===e.tagName.toLowerCase())r=n.find((e=>"title"===e.tagName.toLowerCase()));else if("meta"===e.tagName.toLowerCase()&&"robots"===e.getAttribute("name"))o=!0;else if("meta"===e.tagName.toLowerCase()){const t=e.getAttribute("name"),o=e.getAttribute("property");r=n.find((e=>"meta"===e.tagName.toLowerCase()&&(t&&e.getAttribute("name")===t||o&&e.getAttribute("property")===o)&&"robots"!==e.getAttribute("name")))}else"link"===e.tagName.toLowerCase()&&(r=n.find((t=>"link"===t.tagName.toLowerCase()&&"canonical"===t.getAttribute("rel")&&t.getAttribute("href")===e.getAttribute("href"))));r&&t.removeChild(r)})),o&&n.filter((e=>"robots"===e.getAttribute("name"))).forEach((e=>{t.removeChild(e)}))}update(e){void 0===e&&(e=!1);const t=document.head||document.querySelector("head"),r=this.meta.dataCollection().map(L),n=t.querySelectorAll("["+x+"]"),o=document.createDocumentFragment(),s=Array.from(n);e?this.patchMeta({head:t,addTags:r,removeTagsArray:s}):s.forEach((e=>t.removeChild(e))),r.forEach((e=>o.appendChild(e))),t.insertBefore(o,t.firstChild)}}var V=r(24970),D=r.n(V),F=r(4216),j=r.n(F),U=r(18826),B=r.n(U);const J=D()(j(),B(),T()),H=e=>e.priority>10?{priority:e.priority,value:J(e.value)}:e;var q=r(95775),G=r.n(q);const W=G()(2,((e,t)=>t&&{tag:e,innerHtml:t})),Y=G()(2,((e,t)=>t&&{tag:"meta",attributes:{name:e,content:t}})),K=G()(2,((e,t)=>t&&{tag:"meta",attributes:{property:e,content:t}})),Q=G()(2,((e,t)=>t&&{tag:"link",attributes:{rel:e,href:t}})),Z=[Y("robots","noindex, follow"),Y("robots","noarchive")],z=[Y("robots","index, nofollow"),Y("robots","noarchive")],$=[Y("robots","none"),Y("robots","noindex, nofollow"),Y("robots","noarchive")],X={all:[Y("robots","all"),Y("robots","index, follow"),Y("robots","noarchive")],noindex:Z,"noindex, follow":Z,nofollow:z,"index, nofollow":z,none:$,"noindex, nofollow":$},ee={title:W("title"),description:Y("description"),keywords:Y("keywords"),canonical:Q("canonical"),viewport:Y("viewport"),ogTitle:K("og:title"),ogDescription:K("og:description"),ogSiteName:K("og:site_name"),ogUrl:K("og:url"),ogType:K("og:type"),ogImage:K("og:image"),ogImageSecure:K("og:image:secure_url"),ogImageType:K("og:image:type"),ogImageAlt:K("og:image:alt"),ogImageWidth:K("og:image:width"),ogImageHeight:K("og:image:height"),ogLocale:K("og:locale"),twitterTitle:Y("twitter:title"),twitterDescription:Y("twitter:description"),twitterCard:Y("twitter:card"),twitterSite:Y("twitter:site"),twitterCreator:Y("twitter:creator"),twitterImage:Y("twitter:image"),twitterImageAlt:Y("twitter:image:alt"),robots:e=>X[e]},te=(0,a.J)({provide:R.av,useFactory:e=>{let{di:t}=e;return function(e){let{metaObj:r}=void 0===e?{}:e;const n=t.get(R.h7);r&&n.updateMeta(b.CC,r);const o=new M({list:p()(t.get({token:R.ON,optional:!0,multi:!0})||[]),metaWalk:n,transformValue:H,converters:ee});new P(o).update()}},deps:{di:C.Z}}),re=function(e,t){void 0===t&&(t={});const r={};return Object.keys(t).forEach((n=>{var o;r[e+(o=n,""+o.charAt(0).toUpperCase()+o.slice(1))]=t[n]})),r},ne=[te,{provide:R.h7,useClass:E},{provide:R.wu,useValue:{title:"Tramvai"}},{provide:R.ON,multi:!0,useFactory:e=>{let{defaultMeta:t}=e;return r=t,e=>{e.updateMeta(b.FI,r)};var r},deps:{defaultMeta:R.wu}},(0,a.J)({provide:R.ON,useFactory:e=>{let{pageService:t}=e;return e=>{const r=t.getMeta().seo||{},{pageComponent:n}=t.getConfig()||{},o=t.getComponent(n),s=o&&o.seo||{},i=g()({},r,s),a=i.shareSchema||{},u=Object.assign({},i.metaTags,re("twitter",a.twitterCard),re("og",a.openGraph));e.updateMeta(b.RR,u)}},multi:!0,deps:{pageService:v.Y9}}),{provide:R.ON,multi:!0,useFactory:e=>{let{context:t,metaList:r}=e;const n=p()(r||[]);return e=>{n.forEach((r=>r(t,e)))}},deps:{context:f.l,metaList:{token:"metaList",optional:!0}}},(0,a.J)({provide:l.Ym,multi:!0,useValue:N})];var oe;let se=oe=class{static forRoot(e){if(s()(e))return{mainModule:oe,providers:[{provide:"metaList",useValue:e,multi:!0}]};const{metaUpdaters:t,metaDefault:r}=e,n=[];return r&&n.push({provide:R.wu,useValue:r}),t&&n.push({provide:R.ON,useValue:t,multi:!0}),{providers:n,mainModule:oe}}};se=oe=(0,n.__decorate)([(0,i.Y)({providers:[...ne,(0,a.J)({provide:"router beforeNavigateHooks",multi:!0,useFactory:e=>{let{metaWalk:t}=e;return()=>{t.reset()}},deps:{metaWalk:R.h7}}),(0,a.J)({provide:c.p,scope:u.s.SINGLETON,multi:!0,useFactory:e=>{let{applyMeta:t}=e;return function(e,r,n){if("client"===r&&("afterSpa"===n||"customer"===n)){const r=e.get(R.h7);if("customer"===n){const t=e.get({token:l.E6,optional:!0});r.mergeValuesFromSerializableState(t.stores.appMeta.serverMetaWalkState)}t()}}},deps:{applyMeta:R.av}})]})],se)},19525:function(e,t,r){"use strict";r.d(t,{CC:function(){return s},FI:function(){return n},RR:function(){return o}});const n=0,o=10,s=20},79351:function(e,t,r){"use strict";r.d(t,{ON:function(){return i},av:function(){return a},h7:function(){return s},wu:function(){return o}});var n=r(59999);const o=(0,n.V3)("metaDefaultPack"),s=(0,n.V3)("metaWalk"),i=(0,n.V3)("metaUpdater",{multi:!0}),a=(0,n.V3)("applyMeta")},70030:function(e,t,r){"use strict";r.d(t,{dI:function(){return D}});var n=r(80476),o=r(80283),s=r(67584),i=r(80772),a=r(82342),u=r(5874);const c=e=>Math.round(e)/1e3,l=e=>t=>e.test(t),d=l(/\.js$/),p=l(/\.css$/),h=l(/\.(?:svg|png|jpeg|webp|jpg)$/),g=l(/\.(?:woff|eot|woff2|ttf)/);var v;!function(e){e.html="html",e.js="js",e.css="css",e.img="img",e.font="font",e.other="other"}(v||(v={}));const f=(e,t)=>{if(e.getEntriesByType)return e.getEntriesByType(t)},m=e=>{const t=f(e,"paint");return t&&t[0]?t[0].startTime:0},y=(e,t)=>e&&e[t]||0,E=(e,t)=>({duration:y(e,"duration")+c(t.duration),transferSize:y(e,"transferSize")+t.transferSize,encodedBodySize:y(e,"encodedBodySize")+t.encodedBodySize});var b=r(53930),R=r(56873),w=r(49076),S=r(9056),_=r(48945),N=r(37621),C=r(42353),k=r(58426);const T=(0,C.y)("set instant metrics map"),O=(0,k.L)("instantMetrics",{instantMetricsMap:{}}).on(T,((e,t)=>t)),A=[{provide:N.Ym,multi:!0,useValue:[O]}];let I=class{};I=(0,n.__decorate)([(0,o.Y)({providers:[...A,{provide:i.Bi.init,scope:s.s.SINGLETON,multi:!0,useFactory(e){let{logger:t,papiService:r,context:n}=e;if(!r)return()=>{};const o=n.getStore("instantMetrics").getState().instantMetricsMap,s=new _.RemoteReporter({requestCount:1,emitLevels:{trace:!0,debug:!0,info:!0,warn:!0,error:!0,fatal:!0},makeRequest(e){return o[e.event]?r.request({path:"metrics/"+e.event,method:"post",payload:e.value?{value:e.value}:{}}).then((e=>{let{payload:t}=e;return t})):Promise.resolve()}});return()=>{t.addReporter(s)}},deps:{papiService:{token:S.J2,optional:!0},context:w.l,logger:a.Fp}}]})],I);let M=class{};M=(0,n.__decorate)([(0,o.Y)({imports:[I],providers:[{provide:u.k3,useFactory:()=>({counter:e=>new b.AT(Object.assign({},e)),gauge:e=>new b.aC(Object.assign({},e)),histogram:e=>new b.b5(Object.assign({},e)),summary:e=>new b.ER(Object.assign({},e))}),scope:s.s.SINGLETON},{provide:i.Bi.init,useFactory:e=>{let{logger:t,pageService:r}=e;return()=>{window.addEventListener("load",(()=>{setTimeout((()=>{var e,n;const o=function(){let e;try{if(e=window.performance,!e.timing||!e.timing.loadEventEnd)throw 0===e.timing.loadEventEnd&&console.error("Library used at browser initialization page. Reed docs"),new Error("Not implemented timing api")}catch(e){return{}}const{requestStart:t,responseStart:r,responseEnd:n,domComplete:o,loadEventEnd:s,domInteractive:i,navigationStart:a}=e.timing,u=[{key:"connection",start:a,end:t},{key:"backend",start:t,end:r},{key:"pageDownload",start:r,end:n},{key:"first-paint",start:0,end:m(e)},{key:"domInteractive",start:a,end:i},{key:"domComplete",start:a,end:o},{key:"pageLoadTime",start:a,end:s}],l={};return u.forEach((e=>{const t=c(e.end-e.start);l[e.key]=t>0||t<2e3?t:void 0})),l.download=(e=>{const t={},r=f(e,"resource");if(r&&r.length>0){const e={};r.forEach((r=>{const n=(e=>{switch(!0){case p(e):return v.css;case d(e):return v.js;case h(e):return v.img;case g(e):return v.font;default:return v.other}})(r.name.split("?",1)[0]);v[n]&&(e[n]||(e[n]=0),e[n]++,t[n]=E(t[n],r),t[n].count=e[n])}))}const n=f(e,"navigation");return n&&n.length>0&&(t[v.html]=E({},n[0])),t})(e),l}();t({name:"metrics:perf",defaults:{remote:{emitLevels:{info:!0}}}}).info(Object.assign({},o,{event:"perf-timings",deviceType:-1!==(null===(e=navigator.userAgent)||void 0===e?void 0:e.indexOf("Mobi"))?"mobile":"desktop",urlMask:null===(n=r.getCurrentRoute())||void 0===n?void 0:n.path}))}),0)}))}},multi:!0,deps:{logger:a.Fp,pageService:R.Y9}}]})],M);var x=r(68162),L=r(29772);const P=[{provide:x.a9,useFactory:e=>{let{appInfo:t}=e;return"/"+t.appName+"/papi"},deps:{appInfo:L.Qo}},{provide:x.QR,useFactory:e=>{let{appInfo:t}=e;return"/"+t.appName+"/private/papi"},deps:{appInfo:L.Qo}}];let V=class{};V=(0,n.__decorate)([(0,o.Y)({providers:[...P]})],V);let D=class{};D=(0,n.__decorate)([(0,o.Y)({imports:[M,V,...[!1].filter(Boolean)],providers:[]})],D)},26874:function(e,t){"use strict";t.It="pcId"},65554:function(e,t,r){"use strict";r.d(t,{Gi:function(){return p}});var n=r(80283),o=r(97570),s=r(10776),i=r(82912),a=r(3566);const u=/^[0-9a-f]{16}$/,c=/^[0-9a-f]{32}$/,l=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/,d=(e,t)=>{const r="cookies"===t.from?(n=e.cookie,t.isWebview?null===(o=n.get("deviceId"))||void 0===o?void 0:o.toLowerCase():n.get("__P__wuid")):(e=>{const{wuid:t}=e.getParsedUrl().query;if("string"==typeof t)return t})(e.requestManager);var n,o;if(r&&(e=>u.test(e)||c.test(e)||l.test(e))(r))return r},p=(0,n.Y)({imports:[],providers:[(0,o.J)({provide:a.$,useFactory:e=>{const t="true"===e.requestManager.getParsedUrl().query.iswebview,r=d(e,{from:"query"}),n=d(e,{from:"cookies",isWebview:t}),o=d(e,{from:"cookies"});return t&&n?n:null!=r?r:o},deps:{cookie:s.T,requestManager:i.G}})]})(class{})},3566:function(e,t,r){"use strict";r.d(t,{$:function(){return n}});const n=(0,r(59999).V3)("webUserId")},34754:function(e,t,r){"use strict";r.d(t,{z2:function(){return n}});const n=e=>Object.assign(e.handler,{__papi_parameters__:Object.assign({},e,{options:Object.assign({timeout:1e4},e.options),method:e.method||"all"})})},43158:function(e,t,r){"use strict";r.d(t,{n:function(){return n}});const n=(0,r(44121).createContext)(null)},44488:function(e,t,r){"use strict";r.d(t,{T:function(){return a},x:function(){return c}});var n=r(44121),o=r(57801),s=r.n(o),i=r(43158);const a=()=>{const e=(0,n.useContext)(i.n);if(!e)throw new Error("DI container not found");return e},u=e=>"token"in e&&(1===Object.keys(e).length||"boolean"==typeof e.optional||"boolean"==typeof e.multi);function c(e){const t=a();return(0,n.useMemo)((()=>"[object Object]"!==e.toString()||u(e)?t.get(e):s()((e=>t.get(e)),e)),[e,t])}},38003:function(e,t,r){"use strict";r.d(t,{E:function(){return i}});var n=r(90130),o=r(44121),s=r(77094);class i extends o.Component{constructor(e){super(e),this.state={error:e.error||null,url:e.url}}static getDerivedStateFromProps(e,t){return void 0===e.url?{error:e.error||t.error}:e.url!==t.url?{error:e.error||null,url:e.url}:{error:e.error||t.error,url:t.url}}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){const{errorHandlers:r}=this.props;r&&r.forEach((r=>{r(e,t)}))}render(){const{children:e,fallback:t,fallbackFromDi:r}=this.props,{url:o,error:i}=this.state;return i?t?(0,n.jsx)(t,{url:o,error:i}):r||(0,n.jsx)(s.R,{}):e}}i.displayName="UniversalErrorBoundary"},77094:function(e,t,r){"use strict";r.d(t,{R:function(){return o}});var n=r(90130);const o=()=>(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{textAlign:"center",marginBottom:11,paddingTop:26,fontSize:30,lineHeight:"36px",fontWeight:200},children:"An error occurred :("}),(0,n.jsxs)("div",{style:{textAlign:"center",marginBottom:17,color:"#9299a2",fontSize:20,lineHeight:"24px"},children:["Try"," ",(0,n.jsx)("a",{href:"",onClick:()=>window.location.reload(),children:"reloading the page"})]})]});o.displayName="FallbackError"},33268:function(e,t,r){"use strict";r.d(t,{Ek:function(){return i},O7:function(){return o},Rd:function(){return s}});var n=r(59999);const o=(0,n.V3)("reactErrorBoundaryHandlers",{multi:!0}),s=(0,n.V3)("rootErrorBoundaryComponent"),i=(0,n.V3)("errorBoundaryFallbackComponent")},42549:function(e,t,r){"use strict";r.d(t,{BU:function(){return i},Vo:function(){return u},gm:function(){return a}});var n=r(87346),o=r.n(n),s=r(85128);const i=async e=>{if(e){if("load"in e&&"function"==typeof e.load){const t=await e.load();let r;return r=t.__esModule?t.default:t.default||t,o()(e,r),r}return e}},a=(e,t)=>{if("CSS_CHUNK_LOAD_FAILED"===(null==e?void 0:e.code)){const r=e.request;if(document.querySelector('link[href="'+r+'"]')||document.querySelector('link[data-href="'+r+'"]'))return t()}throw e},u=function(e,t){void 0===t&&(t={});const r=e.importAsync;return e.importAsync=()=>r().catch((e=>a(e,r))),t.suspense?(0,s.Vo)(e):(0,s.ZP)(e,{fallback:t.loading})}},71358:function(e,t,r){"use strict";r.r(t),r.d(t,{DIContext:function(){return n.n},ERROR_BOUNDARY_FALLBACK_COMPONENT_TOKEN:function(){return h.Ek},ERROR_BOUNDARY_TOKEN:function(){return h.O7},ErrorBoundary:function(){return g},FallbackError:function(){return p.R},ROOT_ERROR_BOUNDARY_COMPONENT_TOKEN:function(){return h.Rd},UniversalErrorBoundary:function(){return c.E},__lazyErrorHandler:function(){return f.gm},lazy:function(){return f.Vo},resolveLazyComponent:function(){return f.BU},useDi:function(){return a.x},useDiContainer:function(){return a.T},withDi:function(){return u},withError:function(){return v}});var n=r(43158),o=r(90130),s=r(87346),i=r.n(s),a=r(44488);const u=e=>t=>i()((function(r){const n=(0,a.x)(e);return(0,o.jsx)(t,Object.assign({},r,n))}),t);var c=r(38003),l=r(80476),d=r(44121),p=r(77094),h=r(33268);let g=class extends d.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){const{errorHandlers:r}=this.props;r&&r.forEach((r=>{r(e,t)}))}render(){const{children:e,fallbackComponent:t,fallbackComponentFromDi:r}=this.props,{hasError:n}=this.state;return n?t||r||(0,o.jsx)(p.R,{}):e}};g.displayName="ErrorBoundary",g=(0,l.__decorate)([u({errorHandlers:{token:h.O7,optional:!0},fallbackComponentFromDi:{token:h.Ek,optional:!0}})],g);const v=function(e){let{fallbackComponent:t}=void 0===e?{}:e;return e=>i()((function(r){return(0,o.jsx)(g,{fallbackComponent:t,children:(0,o.jsx)(e,Object.assign({},r))})}),e)};var f=r(42549)},73752:function(e,t,r){"use strict";function n(e){return Object.assign({},e,{message:e.message,stack:e.stack})}function o(e){const t=new Error(e.message);return Object.assign(t,e),t}r.d(t,{F:function(){return o},X:function(){return n}})},42866:function(e,t,r){"use strict";r.d(t,{N:function(){return n}});const n=function(e,t){if(void 0===t&&(t=null),void 0===e)return t;try{return JSON.parse(e)}catch(e){return t}}},7349:function(e,t,r){"use strict";r.d(t,{K:function(){return n}});const n=(e,t,r)=>{try{return JSON.stringify(e,t,r)}catch(n){return((e,t,r)=>{const n=new Set,o=t||(e=>e);return JSON.stringify(e,((e,t)=>t&&"object"==typeof t?n.has(t)?"[~Circular~]":(n.add(t),o(t)):o(t)),r)})(e,t,r)}}},90794:function(e,t,r){"use strict";r.d(t,{N:function(){return s},h:function(){return o}});var n=r(44121);const o=(0,n.createContext)(null),s=(0,n.createContext)(null)},16615:function(e,t,r){"use strict";r.d(t,{x:function(){return s}});var n=r(44121),o=r(90794);const s=()=>{const e=(0,n.useContext)(o.h);if(!e)throw new Error('CONSUMER_CONTEXT not found, have you added "@tramvai/module-common"?\nAlso, you can check "@tramva/state" library duplicates in project lock file.');return e}},97548:function(e,t,r){"use strict";r.d(t,{v:function(){return y}});var n=r(5881),o=r.n(n),s=r(44121),i=r(13311);const a=s.useLayoutEffect;var u=r(25692),c=r.n(u),l=r(5103),d=r.n(l),p=r(66426),h=r(16615);class g{constructor(e){this.handleStateChange=()=>{this.onStateChange&&this.onStateChange()},this.stores=e,this.unsubscribe=void 0}isSubscribed(){return Boolean(this.unsubscribe)}setOnStateChange(e){this.onStateChange=e}trySubscribe(){this.unsubscribe||(this.unsubscribe=this.stores.filter(Boolean).map((e=>(e.on("change",this.handleStateChange),()=>{e.removeListener("change",this.handleStateChange)}))))}tryUnsubscribe(){this.unsubscribe&&(this.unsubscribe.forEach((e=>e())),this.unsubscribe=void 0),this.onStateChange=void 0}}var v=r(75633),f=r(90794);const m=(0,v.R)();function y(e,t,r){void 0===r&&(r=o()),c()(t,"You must pass a selector to useSelectors");const n=(0,h.x)(),u=(0,s.useContext)(f.N),l=(0,s.useRef)(!1),v=(0,i.s)(e),y=(0,s.useMemo)((()=>new g(d()(v).map(n.getStore))),[v,n]),E=(0,s.useRef)(),b=(0,s.useCallback)((e=>(y.setOnStateChange((()=>{l.current||(l.current=!0,m((()=>{e(),l.current=!1})))})),y.trySubscribe(),()=>y.tryUnsubscribe())),[y]);let R;try{R=(0,p.useSyncExternalStoreWithSelector)(b,n.getState,u?()=>u:n.getState,t,r)}catch(e){let t="An error occurred while selecting the store state: "+e.message+".";throw E.current&&(t+="\nThe error may be correlated with this previous error:\n"+E.current.stack+"\n\nOriginal stack trace:"),new Error(t)}return a((()=>{E.current=void 0})),R}},36840:function(e,t,r){"use strict";r.d(t,{o:function(){return a}});var n=r(44121),o=r(86949),s=r(90794),i=r(16615);function a(e){const t=(0,i.x)(),r=(0,n.useContext)(s.N),a=(0,n.useRef)(e),u=(0,n.useRef)(null);t.hasStore(e)||(t.registerStore(e),u.current=e.storeName);const c=(0,n.useCallback)((r=>{const n=t.subscribe(e,r);return a.current=e,()=>{n(),u.current&&(t.unregisterStore(a.current),u.current=null)}}),[e,t]);return(0,o.useSyncExternalStore)(c,(()=>t.getState(e)),r?()=>r[e.storeName]:()=>t.getState(e))}},30362:function(e,t,r){"use strict";r.d(t,{U:function(){return s}});var n=r(44121),o=r(97548);const s=(e,t)=>{const r=(0,n.useCallback)((r=>t(r[e.storeName])),[e,t]);return(0,o.v)(e,r)}},75633:function(e,t,r){"use strict";r.d(t,{R:function(){return o}});const n=window;function o(){return"requestAnimationFrame"in n?requestAnimationFrame:"setImmediate"in n?n.setImmediate:setTimeout}},42353:function(e,t,r){"use strict";r.d(t,{b:function(){return i},y:function(){return s}});var n=r(79436),o=r.n(n);function s(e,t){void 0===t&&(t=o());const r=e,n=function(){return{type:r,payload:t(...arguments),store:n.store}};return n.getType=()=>r,n.toString=()=>r,n}const i=e=>"function"==typeof e&&"getType"in e},58426:function(e,t,r){"use strict";r.d(t,{L:function(){return s}});var n=r(42353),o=r(24069);function s(e,t){const{name:r,initialState:s}="object"==typeof e?e:{name:e,initialState:t},i={};class a extends o.Z{constructor(){super(),this.state=s}static createEvents(e){const t=Object.keys(e),r={};return t.forEach((t=>{const o=e[t],s=(0,n.y)(this.storeName+"_"+t);r[t]=s,a.on(s,o)})),r}static on(e,t){if(Array.isArray(e))return e.forEach((e=>a.on(e,t))),a;(0,n.b)(e)&&!e.store&&(e.store=a);const r=e.toString();return a.handlers[r]="handle",i[r]=t,a}getState(){return this.state}setState(e){this.state=e,this.emit("change")}dehydrate(){return this.state}rehydrate(e){this.state=e}handle(e,t){const r=i[t];r&&(this.state=r(this.state,e),this.emit("change"))}}return a.storeName=r,a.events=void 0,a.handlers={},"object"==typeof e&&e.events&&(a.events=a.createEvents(e.events)),a}},24069:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});class n{constructor(){this.listeners=new Set}emit(e){this.listeners.forEach((e=>{e()}))}addListener(e,t){this.listeners.add(t)}on(e,t){this.addListener(e,t)}removeListener(e,t){this.listeners.delete(t)}off(e,t){this.removeListener(e,t)}}},13311:function(e,t,r){"use strict";r.d(t,{s:function(){return i}});var n=r(44121),o=r(5881),s=r.n(o);const i=e=>{const t=(0,n.useRef)(e);return s()(t.current,e)||(t.current=e),t.current}},92946:function(e,t,r){"use strict";r.d(t,{DL:function(){return c},JB:function(){return l},JS:function(){return h},O7:function(){return u},Tx:function(){return g},Z1:function(){return p},fg:function(){return o},iu:function(){return d},l4:function(){return s},w1:function(){return a},xs:function(){return i}});var n=r(59999);const o=(0,n.V3)("ADMIN_SERVICE"),s=(0,n.V3)("ADMIN_RESOURCES_SERVICE"),i=(0,n.V3)("ADMIN_PAGE_ENRICHMENT_SERVICE"),a=(0,n.V3)("INTEGRATION_ADMIN_SERVICE"),u=(0,n.V3)("ADMIN_API_HTTP_CLIENT_FACTORY"),c=(0,n.V3)("ADMIN_API_DEFAULT_OPTIONS_FACTORY"),l=(0,n.V3)("TINKOFF_API_SERVICE"),d=(0,n.V3)("COMMON_API_HTTP_CLIENT_FACTORY"),p=(0,n.V3)("COMMON_API_DEFAULT_OPTIONS_FACTORY"),h=(0,n.V3)("apiOriginService"),g=(0,n.V3)("apiOriginServiceDecorator",{multi:!0})},69736:function(e,t,r){"use strict";r.d(t,{C7:function(){return m},JG:function(){return p},QZ:function(){return v},Ri:function(){return h},SG:function(){return c},TN:function(){return d},WO:function(){return g},Zh:function(){return a},db:function(){return s},hM:function(){return l},i6:function(){return o},qt:function(){return f},sI:function(){return u},sV:function(){return i},uJ:function(){return y}});var n=r(59999);const o=(0,n.V3)("authenticator"),s=(0,n.V3)("sessionManager"),i=(0,n.V3)("sessionCookieName"),a=(0,n.V3)("sessionLifetimeController"),u=(0,n.V3)("authStrategies",{multi:!0}),c=(0,n.V3)("authenticatorTimingCallbacks"),l=(0,n.V3)("logoutRedirectUrl"),d=(0,n.V3)("onResolveAuthenticate"),p=(0,n.V3)("onAccessDeniedRedirectToken"),h=(0,n.V3)("accessDeniedRedirectUrl"),g=(0,n.V3)("onHasAccessToken"),v=(0,n.V3)("onLogoutRedirectToken"),f=(0,n.V3)("onRouteGuardRedirectToken"),m=(0,n.V3)("isClientAuthenticationToken"),y=(0,n.V3)("API_AUTH_METHOD_TOKEN")},71533:function(e,t,r){"use strict";r.d(t,{D7:function(){return u},FM:function(){return i},R$:function(){return s},R9:function(){return o},m1:function(){return c},xW:function(){return a}});var n=r(59999);const o=(0,n.V3)("actionRegistry"),s=(0,n.V3)("actionExecution"),i=(0,n.V3)("actionPageRunner"),a=(0,n.V3)("actionConditionals",{multi:!0}),u=(0,n.V3)("limitActionGlobalTimeRun"),c=(0,n.V3)("tramvai deferred actions map")},83005:function(e,t,r){"use strict";r.d(t,{g:function(){return o},x:function(){return s}});var n=r(59999);const o=(0,n.V3)("bundleManager"),s=(0,n.V3)("additional bundle",{multi:!0})},16011:function(e,t,r){"use strict";r.d(t,{SQ:function(){return u},TZ:function(){return s},YQ:function(){return a},oK:function(){return i},xC:function(){return o}});var n=r(59999);const o=(0,n.V3)("createCache"),s=(0,n.V3)("registerClearCache",{multi:!0}),i=(0,n.V3)("clearCache"),a="memory",u="memory-lfu"},65538:function(e,t,r){"use strict";r.d(t,{P:function(){return n}});const n=(0,r(59999).V3)("cacheMetricsServer")},56003:function(e,t,r){"use strict";r.d(t,{K:function(){return n}});const n=(0,r(59999).V3)("componentRegistry")},49076:function(e,t,r){"use strict";r.d(t,{l:function(){return n}});const n=(0,r(59999).V3)("context")},82571:function(e,t,r){"use strict";r.d(t,{L3:function(){return i},hq:function(){return u},sQ:function(){return a},vC:function(){return s}});var n=r(59999),o=r(67584);const s=(0,n.V3)("environmentManager",{scope:o.s.SINGLETON}),i=(0,n.V3)("clientEnvironmentManager",{scope:o.s.REQUEST}),a=(0,n.V3)("envUsed",{multi:!0}),u=(0,n.V3)("env template token",{multi:!0,scope:o.s.SINGLETON})},10112:function(e,t,r){"use strict";r.d(t,{mj:function(){return s},p7:function(){return i},vV:function(){return o}});var n=r(59999);const o=(0,n.V3)("common ExecutionContextManager"),s=(0,n.V3)("common rootExecutionContext"),i=(0,n.V3)("common commandLineExecutionContext")},45838:function(e,t,r){"use strict";r.d(t,{v:function(){return n}});const n=(0,r(59999).V3)("hooks")},12052:function(e,t,r){"use strict";r.r(t),r.d(t,{ACTION_CONDITIONALS:function(){return s.xW},ACTION_EXECUTION_TOKEN:function(){return s.R$},ACTION_PAGE_RUNNER_TOKEN:function(){return s.FM},ACTION_REGISTRY_TOKEN:function(){return s.R9},ADDITIONAL_BUNDLE_TOKEN:function(){return n.x},ASYNC_LOCAL_STORAGE_TOKEN:function(){return m},BUNDLE_MANAGER_TOKEN:function(){return n.g},CACHE_METRICS_SERVER_TOKEN:function(){return u.P},CLEAR_CACHE_TOKEN:function(){return c.oK},CLIENT_ENV_REPOSITORY_TOKEN:function(){return v.L3},COMBINE_REDUCERS:function(){return d.Ym},COMMAND_LINE_EXECUTION_CONTEXT_TOKEN:function(){return f.p7},COMPONENT_REGISTRY_TOKEN:function(){return l.K},CONTEXT_TOKEN:function(){return o.l},CREATE_CACHE_TOKEN:function(){return c.xC},DEFERRED_ACTIONS_MAP_TOKEN:function(){return s.m1},DISPATCHER_CONTEXT_TOKEN:function(){return d.jm},DISPATCHER_TOKEN:function(){return d.qb},ENV_MANAGER_TOKEN:function(){return v.vC},ENV_TEMPLATE_TOKEN:function(){return v.hq},ENV_USED_TOKEN:function(){return v.sQ},EXECUTION_CONTEXT_MANAGER_TOKEN:function(){return f.vV},HOOK_TOKEN:function(){return i.v},INITIAL_APP_STATE_TOKEN:function(){return d.E6},LIMIT_ACTION_GLOBAL_TIME_RUN:function(){return s.D7},LOGGER_INIT_HOOK:function(){return p.J0},LOGGER_REMOTE_REPORTER:function(){return p.DV},LOGGER_SHARED_CONTEXT:function(){return p.yV},LOGGER_TOKEN:function(){return p.Fp},MEMORY_LFU:function(){return c.SQ},MEMORY_LRU:function(){return c.YQ},PUBSUB_FACTORY_TOKEN:function(){return a.eP},PUBSUB_TOKEN:function(){return a.k3},REGISTER_CLEAR_CACHE_TOKEN:function(){return c.TZ},REQUEST_MANAGER_TOKEN:function(){return h.G},RESPONSE_MANAGER_TOKEN:function(){return g.r},ROOT_EXECUTION_CONTEXT_TOKEN:function(){return f.mj},ROOT_PUBSUB_TOKEN:function(){return a.Tm},STORE_MIDDLEWARE:function(){return d.PU},STORE_TOKEN:function(){return d.kR}});var n=r(83005),o=r(49076),s=r(71533),i=r(45838),a=r(17173),u=r(65538),c=r(16011),l=r(56003),d=r(37621),p=r(82342),h=r(82912),g=r(80858),v=r(82571),f=r(10112);const m=(0,r(59999).V3)("ASYNC_LOCAL_STORAGE_TOKEN")},82342:function(e,t,r){"use strict";r.d(t,{DV:function(){return i},Fp:function(){return o},J0:function(){return s},yV:function(){return a}});var n=r(59999);const o=(0,n.V3)("logger"),s=(0,n.V3)("loggerHook",{multi:!0}),i=(0,n.V3)("remoteReporter"),a=(0,n.V3)("tramvai logger shared context")},17173:function(e,t,r){"use strict";r.d(t,{Tm:function(){return i},eP:function(){return o},k3:function(){return s}});var n=r(59999);const o=(0,n.V3)("pubsubFactory"),s=(0,n.V3)("pubsub"),i=(0,n.V3)("rootPubsub")},82912:function(e,t,r){"use strict";r.d(t,{G:function(){return n}});const n=(0,r(59999).V3)("requestManager")},80858:function(e,t,r){"use strict";r.d(t,{r:function(){return n}});const n=(0,r(59999).V3)("responseManager")},37621:function(e,t,r){"use strict";r.d(t,{E6:function(){return l},PU:function(){return c},Ym:function(){return a},jm:function(){return i},kR:function(){return u},qb:function(){return s}});var n=r(59999),o=r(67584);const s=(0,n.V3)("dispatcher"),i=(0,n.V3)("dispatcherContext"),a=(0,n.V3)("combineReducers",{multi:!0,scope:o.s.SINGLETON}),u=(0,n.V3)("store"),c=(0,n.V3)("storeMiddleware",{multi:!0}),l=(0,n.V3)("initialAppState")},10776:function(e,t,r){"use strict";r.d(t,{T:function(){return n}});const n=(0,r(59999).V3)("cookieManager")},78377:function(e,t,r){"use strict";r.d(t,{p:function(){return s},x:function(){return o}});var n=r(59999);const o=(0,n.V3)("commandLineRunner timingInfo"),s=(0,n.V3)("commandLineRunner executionEnd",{multi:!0})},80772:function(e,t,r){"use strict";r.d(t,{Bi:function(){return u},PR:function(){return a},S9:function(){return i}});var n=r(59999),o=r(67584);const s={multi:!0},i=(0,n.V3)("commandLineRunner"),a=(0,n.V3)("commandLines"),u={init:(0,n.V3)("init",{multi:!0,scope:o.s.SINGLETON}),listen:(0,n.V3)("listen",{multi:!0,scope:o.s.SINGLETON}),customerStart:(0,n.V3)("customer_start",s),resolveUserDeps:(0,n.V3)("resolve_user_deps",s),resolvePageDeps:(0,n.V3)("resolve_page_deps",s),generatePage:(0,n.V3)("generate_page",s),clear:(0,n.V3)("clear",s),spaTransition:(0,n.V3)("spa_transition",s),afterSpaTransition:(0,n.V3)("after_spa_transition",s),close:(0,n.V3)("close",{multi:!0,scope:o.s.SINGLETON})}},62054:function(e,t,r){"use strict";r.d(t,{j:function(){return n}});const n=(0,r(59999).V3)("tramvai tapable hook factory")},29772:function(e,t,r){"use strict";r.d(t,{Bi:function(){return s.Bi},I7:function(){return u},PR:function(){return s.PR},Qo:function(){return l},S9:function(){return s.S9},dV:function(){return o.d},jk:function(){return i.j},mJ:function(){return c},om:function(){return a}});var n=r(59999),o=r(59576),s=r(80772),i=r(62054);const a=(0,n.V3)("bundleList"),u=(0,n.V3)("actionsList"),c=(0,n.V3)("modulesList"),l=(0,n.V3)("appInfo")},9056:function(e,t,r){"use strict";r.d(t,{FB:function(){return o},FF:function(){return s},J2:function(){return l},Z0:function(){return i},bV:function(){return a},pW:function(){return d},s:function(){return c},zn:function(){return u}});var n=r(59999);const o=(0,n.V3)("HTTP_CLIENT_FACTORY"),s=(0,n.V3)("DEFAULT_HTTP_CLIENT_FACTORY_OPTIONS"),i=(0,n.V3)("DEFAULT_HTTP_CLIENT_INTERCEPTORS",{multi:!0}),a=(0,n.V3)("HTTP_CLIENT"),u=(0,n.V3)("HTTP_CLIENT_AGENT"),c=(0,n.V3)("apiClientPassHeaders",{multi:!0}),l=(0,n.V3)("papi service"),d=(0,n.V3)("disable circuit breaker")},5874:function(e,t,r){"use strict";r.d(t,{Yy:function(){return s},k3:function(){return o}});var n=r(59999);const o=(0,n.V3)("metricsModule"),s=(0,n.V3)("metricsServicesRegistry")},12327:function(e,t,r){"use strict";r.d(t,{sH:function(){return n}});const n=(0,r(59999).V3)("reactQuery queryClient")},8479:function(e,t,r){"use strict";r.r(t),r.d(t,{ASSETS_PREFIX_TOKEN:function(){return O},BACK_FORWARD_CACHE_ENABLED:function(){return N},CUSTOM_RENDER:function(){return l},DEFAULT_ASSETS_PREFIX_TOKEN:function(){return A},DEFAULT_ERROR_BOUNDARY_COMPONENT:function(){return E},DEFAULT_FOOTER_COMPONENT:function(){return y},DEFAULT_HEADER_COMPONENT:function(){return m},DEFAULT_LAYOUT_COMPONENT:function(){return f},EXTEND_RENDER:function(){return v},FETCH_WEBPACK_STATS_TOKEN:function(){return T},HTML_ATTRS:function(){return u},LAYOUT_OPTIONS:function(){return b},MODERN_SATISFIES_TOKEN:function(){return _},POLYFILL_CONDITION:function(){return p},REACT_SERVER_RENDER_MODE:function(){return C},REACT_STREAMING_RENDER_TIMEOUT:function(){return k},RENDERER_CALLBACK:function(){return c},RENDER_FLOW_AFTER_TOKEN:function(){return S},RENDER_MODE:function(){return h},RENDER_SLOTS:function(){return a},RESOURCES_REGISTRY:function(){return d},RESOURCE_INLINE_OPTIONS:function(){return R},ResourceSlot:function(){return i},ResourceType:function(){return s.LO},TRAMVAI_RENDER_MODE:function(){return w},USE_REACT_STRICT_MODE:function(){return g}});var n=r(59999),o=r(67584),s=r(73212),i=r(23436);const a=(0,n.V3)("RENDER_SLOTS",{multi:!0}),u=(0,n.V3)("HTML_ATTRS",{multi:!0}),c=(0,n.V3)("RENDERER_CALLBACK",{multi:!0}),l=(0,n.V3)("CUSTOM_RENDER"),d=(0,n.V3)("resourcesRegistry"),p=(0,n.V3)("POLYFILL_CONDITION"),h=(0,n.V3)("RENDER_MODE"),g=(0,n.V3)("useReactStrictMode"),v=(0,n.V3)("EXTEND_RENDER",{multi:!0}),f=(0,n.V3)("defaultLayoutComponent",{scope:o.s.SINGLETON}),m=(0,n.V3)("defaultHeaderComponent",{scope:o.s.SINGLETON}),y=(0,n.V3)("defaultFooterComponent",{scope:o.s.SINGLETON}),E=(0,n.V3)("defaultErrorBoundaryComponent"),b=(0,n.V3)("layoutOptions",{multi:!0,scope:o.s.SINGLETON}),R=(0,n.V3)("resourceInlineThreshold",{scope:o.s.SINGLETON}),w=(0,n.V3)("tramvaiRenderMode"),S=(0,n.V3)("render flow after",{multi:!0}),_=(0,n.V3)("modernSatisfies"),N=(0,n.V3)("back forward cache"),C=(0,n.V3)("reactServerRenderMode"),k=(0,n.V3)("react streaming render timeout"),T=(0,n.V3)("fetchWebpackStatsFn",{scope:o.s.SINGLETON}),O=(0,n.V3)("tramvai assets prefix",{scope:o.s.SINGLETON}),A=(0,n.V3)("tramvai default assets prefix",{scope:o.s.SINGLETON})},23436:function(e,t,r){"use strict";r.r(t),r.d(t,{BODY_END:function(){return h},BODY_START:function(){return d},BODY_TAIL:function(){return v},BODY_TAIL_ANALYTICS:function(){return g},HEAD_ANALYTICS:function(){return c},HEAD_CORE_SCRIPTS:function(){return a},HEAD_CORE_STYLES:function(){return s},HEAD_DYNAMIC_SCRIPTS:function(){return u},HEAD_ICONS:function(){return l},HEAD_META:function(){return n},HEAD_PERFORMANCE:function(){return o},HEAD_POLYFILLS:function(){return i},REACT_RENDER:function(){return p}});const n="head:meta",o="head:performance",s="head:core-styles",i="head:polyfills",a="head:core-scripts",u="head:dynamic-scripts",c="head:analytics",l="head:icons",d="body:start",p="react:render",h="body:end",g="body:tail:analytics",v="body:tail"},56873:function(e,t,r){"use strict";r.d(t,{$d:function(){return d},Dk:function(){return s},Dv:function(){return h},S3:function(){return l},TL:function(){return c},Y9:function(){return a},_Q:function(){return u},aP:function(){return g},fw:function(){return p},l1:function(){return o},sU:function(){return i}});var n=r(59999);const o=(0,n.V3)("router router"),s=(0,n.V3)("router routes",{multi:!0}),i=(0,n.V3)("router guard",{multi:!0}),a=(0,n.V3)("router pageService"),u=(0,n.V3)("router pageRegistry"),c=(0,n.V3)("router routeResolve"),l=(0,n.V3)("router routeTransform",{multi:!0}),d=(0,n.V3)("router spaRunMode"),p=(0,n.V3)("link prefetch manager"),h=(0,n.V3)("link prefetch handler",{multi:!0}),g=(0,n.V3)("router mode")},68162:function(e,t,r){"use strict";r.d(t,{$8:function(){return a},QR:function(){return i},a9:function(){return s}});var n=r(59999),o=r(67584);const s=(0,n.V3)("serverModulePapiPublicUrl",{scope:o.s.SINGLETON}),i=(0,n.V3)("serverModulePapiPrivateUrl",{scope:o.s.SINGLETON}),a=(0,n.V3)("serverModulePapiPrivateRoute",{multi:!0,scope:o.s.SINGLETON});o.s.SINGLETON,o.s.SINGLETON,o.s.SINGLETON,o.s.SINGLETON,o.s.SINGLETON,o.s.SINGLETON,o.s.SINGLETON,o.s.SINGLETON},59576:function(e,t,r){"use strict";r.d(t,{d:function(){return n}});const n="__action_parameters__"}}]);